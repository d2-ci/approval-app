{"version":3,"sources":["D2App/auth/auth-wall.module.css","D2App/app/layout.module.css","D2App/action-bar/action-bar.js","D2App/current-user/current-user-context.js","D2App/current-user/current-user-provider.js","D2App/auth/use-is-authorized.js","D2App/current-user/use-current-user.js","D2App/auth/auth-wall.js","D2App/context-selector/context-selector.js","D2App/data-workspace/data-workspace.js","D2App/app/layout.js","D2App/app/index.js","D2App/app/app.js"],"names":["module","exports","ActionBar","React","createElement","CurrentUserContext","createContext","query","me","resource","params","fields","CurrentUserProvider","children","data","loading","error","useDataQuery","Layer","CenteredContent","CircularLoader","Provider","value","useIsAuthorized","authorities","useContext","some","authority","AuthWall","className","classes","wrapper","NoticeBox","title","i18n","t","ContextSelector","DataWorkspace","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","LayoutSection","Layout","props","container","top","content","bottom","App","QueryParamProvider","CssVariables","spacers","colors","theme"],"mappings":"iHACAA,EAAOC,QAAU,CAAC,QAAU,6B,oBCA5BD,EAAOC,QAAU,CAAC,UAAY,0BAA0B,IAAM,oBAAoB,QAAU,wBAAwB,OAAS,yB,4ECC7H,MAAMC,EAAY,IAAmBC,IAAMC,cAAc,MAAO,KAAM,yB,6BCDtE,MAAMC,EAAkCC,wBAAc,I,WCItD,MAAMC,EAAQ,CACZC,GAAI,CACFC,SAAU,KACVC,OAAQ,CACNC,OAAQ,CACR,cAAe,WAAY,WAAY,aAAc,oBAAqB,gCAK1EC,EAAsB,EAC1BC,eAEA,MAAM,KACJC,EADI,QAEJC,EAFI,MAGJC,GACEC,YAAaV,GAEjB,GAAIQ,EACF,OAAoBZ,IAAMC,cAAcc,IAAO,KAAmBf,IAAMC,cAAce,IAAiB,KAAmBhB,IAAMC,cAAcgB,IAAgB,QAGhK,GAAIJ,EAMF,MAAMA,EAGR,OAAoBb,IAAMC,cAAcC,EAAmBgB,SAAU,CACnEC,MAAOR,EAAKN,IACXK,ICtCQU,EAAkB,KAC7B,MAAM,YACJC,GCDgCC,qBAAWpB,GDG7C,OAAOmB,EAAYE,MAAKC,GAA2B,QAAdA,GAAqC,wBAAdA,KEExDC,EAAW,EACff,cAEqBU,IAWdV,EAReV,IAAMC,cAAc,MAAO,CAC7CyB,UAAWC,IAAQC,SACL5B,IAAMC,cAAc4B,IAAW,CAC7ChB,OAAO,EACPiB,MAAOC,IAAKC,EAAE,mBACbD,IAAKC,EAAE,uGChBRC,EAAkB,IAAmBjC,IAAMC,cAAc,MAAO,KAAM,+BCAtEiC,EAAgB,IAAmBlC,IAAMC,cAAc,MAAO,KAAM,6B,sBCF1E,SAASkC,IAA2Q,OAA9PA,EAAWC,OAAOC,QAAU,SAAUC,GAAU,IAAK,IAAIC,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CAAE,IAAIG,EAASF,UAAUD,GAAI,IAAK,IAAII,KAAOD,EAAcN,OAAOQ,UAAUC,eAAeC,KAAKJ,EAAQC,KAAQL,EAAOK,GAAOD,EAAOC,IAAY,OAAOL,IAA2BS,MAAMC,KAAMR,WAMhT,MAAMS,EAAgB,EACpBvC,WACAgB,eACiB1B,IAAMC,cAAc,MAAO,CAC5CyB,UAAWA,GACVhB,GAuBUwC,EAhBKC,GAAsBnD,IAAMC,cAAcgD,EAAed,EAAS,GAAIgB,EAAO,CAC7FzB,UAAWC,IAAQyB,aAeRF,EAZDC,GAAsBnD,IAAMC,cAAcgD,EAAed,EAAS,GAAIgB,EAAO,CACvFzB,UAAWC,IAAQ0B,OAWRH,EARGC,GAAsBnD,IAAMC,cAAcgD,EAAed,EAAS,GAAIgB,EAAO,CAC3FzB,UAAWC,IAAQ2B,WAORJ,EAJEC,GAAsBnD,IAAMC,cAAcgD,EAAed,EAAS,GAAIgB,EAAO,CAC1FzB,UAAWC,IAAQ4B,UC9BNC,UCSH,IAAmBxD,IAAMC,cAAcwD,IAAoB,KAAmBzD,IAAMC,cAAcyD,IAAc,CAC1HC,SAAS,EACTC,QAAQ,EACRC,OAAO,IACQ7D,IAAMC,cAAcQ,EAAqB,KAAmBT,IAAMC,cAAcwB,EAAU,KAAmBzB,IAAMC,cAAciD,EAAkB,KAAmBlD,IAAMC,cAAciD,EAAY,KAAmBlD,IAAMC,cAAcgC,EAAiB,OAAqBjC,IAAMC,cAAciD,EAAgB,KAAmBlD,IAAMC,cAAciC,EAAe,OAAqBlC,IAAMC,cAAciD,EAAe,KAAmBlD,IAAMC,cAAcF,EAAW","file":"static/js/app.fa53cef9.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"auth-wall_wrapper__2MmQe\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"layout_container__Cp-96\",\"top\":\"layout_top__2gcI9\",\"content\":\"layout_content__10QOH\",\"bottom\":\"layout_bottom__2toTd\"};","import React from 'react';\n\nconst ActionBar = () => /*#__PURE__*/React.createElement(\"pre\", null, \"ActionBar placeholder\");\n\nexport { ActionBar };","import { createContext } from 'react';\nconst CurrentUserContext = /*#__PURE__*/createContext({});\nexport { CurrentUserContext };","import { useDataQuery } from '@dhis2/app-runtime';\nimport { PropTypes } from '@dhis2/prop-types';\nimport { CircularLoader, Layer, CenteredContent } from '@dhis2/ui';\nimport React from 'react';\nimport { CurrentUserContext } from './current-user-context';\nconst query = {\n  me: {\n    resource: 'me',\n    params: {\n      fields: [// TODO: adjust fields according to actual requirements\n      'authorities', 'programs', 'dataSets', 'userGroups', 'organisationUnits', 'dataViewOrganisationUnits']\n    }\n  }\n};\n\nconst CurrentUserProvider = ({\n  children\n}) => {\n  const {\n    data,\n    loading,\n    error\n  } = useDataQuery(query);\n\n  if (loading) {\n    return /*#__PURE__*/React.createElement(Layer, null, /*#__PURE__*/React.createElement(CenteredContent, null, /*#__PURE__*/React.createElement(CircularLoader, null)));\n  }\n\n  if (error) {\n    /**\n     * The app can't continue if this fails, because it doesn't\n     * have any data, so throw the error and let it be caught by\n     * the error boundary in the app-shell\n     */\n    throw error;\n  }\n\n  return /*#__PURE__*/React.createElement(CurrentUserContext.Provider, {\n    value: data.me\n  }, children);\n};\n\nCurrentUserProvider.propTypes = {\n  children: PropTypes.node.isRequired\n};\nexport { CurrentUserProvider };","import { useCurrentUser } from '../current-user';\nexport const useIsAuthorized = () => {\n  const {\n    authorities\n  } = useCurrentUser();\n  return authorities.some(authority => authority === 'ALL' || authority === 'M_dhis-web-approval');\n};","import { useContext } from 'react';\nimport { CurrentUserContext } from './current-user-context';\nexport const useCurrentUser = () => useContext(CurrentUserContext);","import i18n from '@dhis2/d2-i18n';\nimport { NoticeBox } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport classes from './auth-wall.module.css';\nimport { useIsAuthorized } from './use-is-authorized.js';\n\nconst AuthWall = ({\n  children\n}) => {\n  const isAuthorized = useIsAuthorized();\n\n  if (!isAuthorized) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.wrapper\n    }, /*#__PURE__*/React.createElement(NoticeBox, {\n      error: true,\n      title: i18n.t('Not authorized')\n    }, i18n.t(\"You don't have access to the Data Approval App. Contact a system administrator to request access.\")));\n  }\n\n  return children;\n};\n\nAuthWall.propTypes = {\n  children: PropTypes.node.isRequired\n};\nexport { AuthWall };","import React from 'react';\n\nconst ContextSelector = () => /*#__PURE__*/React.createElement(\"pre\", null, \"ContextSelector placeholder\");\n\nexport { ContextSelector };","import React from 'react';\n\nconst DataWorkspace = () => /*#__PURE__*/React.createElement(\"pre\", null, \"DataWorkspace placeholder\");\n\nexport { DataWorkspace };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport classes from './layout.module.css';\n\nconst LayoutSection = ({\n  children,\n  className\n}) => /*#__PURE__*/React.createElement(\"div\", {\n  className: className\n}, children);\n\nLayoutSection.propTypes = {\n  children: PropTypes.node,\n  className: PropTypes.string\n};\n\nconst Container = props => /*#__PURE__*/React.createElement(LayoutSection, _extends({}, props, {\n  className: classes.container\n}));\n\nconst Top = props => /*#__PURE__*/React.createElement(LayoutSection, _extends({}, props, {\n  className: classes.top\n}));\n\nconst Content = props => /*#__PURE__*/React.createElement(LayoutSection, _extends({}, props, {\n  className: classes.content\n}));\n\nconst Bottom = props => /*#__PURE__*/React.createElement(LayoutSection, _extends({}, props, {\n  className: classes.bottom\n}));\n\nexport const Layout = {\n  Container,\n  Top,\n  Content,\n  Bottom\n};","import { App } from './app.js';\nexport default App;","import { CssVariables } from '@dhis2/ui';\nimport React from 'react';\nimport { QueryParamProvider } from 'use-query-params';\nimport { ActionBar } from '../action-bar';\nimport { AuthWall } from '../auth';\nimport { ContextSelector } from '../context-selector';\nimport { CurrentUserProvider } from '../current-user';\nimport { DataWorkspace } from '../data-workspace';\nimport { Layout } from './layout.js';\n\nconst App = () => /*#__PURE__*/React.createElement(QueryParamProvider, null, /*#__PURE__*/React.createElement(CssVariables, {\n  spacers: true,\n  colors: true,\n  theme: true\n}), /*#__PURE__*/React.createElement(CurrentUserProvider, null, /*#__PURE__*/React.createElement(AuthWall, null, /*#__PURE__*/React.createElement(Layout.Container, null, /*#__PURE__*/React.createElement(Layout.Top, null, /*#__PURE__*/React.createElement(ContextSelector, null)), /*#__PURE__*/React.createElement(Layout.Content, null, /*#__PURE__*/React.createElement(DataWorkspace, null)), /*#__PURE__*/React.createElement(Layout.Bottom, null, /*#__PURE__*/React.createElement(ActionBar, null))))));\n\nexport { App };"],"sourceRoot":""}