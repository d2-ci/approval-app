{"version":3,"sources":["D2App/shared/error-message/error-message.module.css","D2App/bottom-bar/approve-button/approve-modal/approve-modal.module.css","D2App/bottom-bar/bottom-bar-item.module.css","D2App/bottom-bar/bottom-bar.module.css","D2App/data-workspace/display/display.module.css","D2App/data-workspace/title-bar/title-bar.module.css","D2App/top-bar/clear-all-button/clear-all-button.module.css","D2App/top-bar/context-select/context-select.module.css","D2App/top-bar/org-unit-select/approval-status-label.module.css","D2App/top-bar/org-unit-select/org-unit-select.module.css","D2App/top-bar/period-select/period-menu.module.css","D2App/top-bar/period-select/year-navigator.module.css","D2App/top-bar/workflow-select/workflow-select-option.module.css","D2App/top-bar/workflow-select/workflow-select.module.css","D2App/app/layout.module.css","D2App/app-context/app-context.js","D2App/shared/error-message/error-message.js","D2App/shared/fixed-periods/fixed-periods.js","D2App/shared/loader/loader.js","D2App/shared/approval-state/icons.js","D2App/shared/approval-state/get-approval-state.js","D2App/shared/approval-state/status-tag.js","D2App/app-context/app-provider.js","D2App/app-context/use-app-context.js","D2App/auth/auth-wall.js","D2App/auth/use-is-authorized.js","D2App/workflow-context/workflow-context.js","D2App/selection-context/selection-context.js","D2App/navigation/create-href.js","D2App/navigation/history.js","D2App/selection-context/initial-values.js","D2App/navigation/read-query-params.js","D2App/selection-context/selection-provider.js","D2App/navigation/push-state-to-history.js","D2App/selection-context/use-selection-context.js","D2App/workflow-context/workflow-provider.js","D2App/workflow-context/use-workflow-context.js","D2App/bottom-bar/accept-button/use-accept-data.js","D2App/bottom-bar/accept-button/accept-button.js","D2App/bottom-bar/approve-button/approve-modal/approve-modal.js","D2App/bottom-bar/approve-button/use-approve-data.js","D2App/bottom-bar/approve-button/approve-button.js","D2App/bottom-bar/bottom-bar-item.js","D2App/bottom-bar/unaccept-button/use-unaccept-data.js","D2App/bottom-bar/unaccept-button/unaccept-button.js","D2App/bottom-bar/unapprove-button/use-unapprove-data.js","D2App/bottom-bar/unapprove-button/unapprove-button.js","D2App/bottom-bar/bottom-bar.js","D2App/data-workspace/data-set-navigation/data-set-navigation.js","D2App/data-workspace/display/table.js","D2App/data-workspace/display/display.js","D2App/data-workspace/title-bar/title-bar.js","D2App/data-workspace/data-workspace.js","D2App/top-bar/clear-all-button/clear-all-button.js","D2App/top-bar/org-unit-select/approval-statuses.js","D2App/top-bar/context-select/context-select.js","D2App/top-bar/org-unit-select/approval-status-label.js","D2App/top-bar/org-unit-select/org-unit-select.js","D2App/top-bar/period-select/period-menu.js","D2App/top-bar/period-select/year-navigator.js","D2App/top-bar/period-select/period-select.js","D2App/top-bar/workflow-select/workflow-select-option.js","D2App/top-bar/workflow-select/workflow-select.js","D2App/top-bar/top-bar.js","D2App/app/layout.js","D2App/locales/index.js","D2App/app/index.js","D2App/app/app.js"],"names":["module","exports","AppContext","createContext","authorities","organisationUnits","dataApprovalWorkflows","ErrorMessage","children","title","React","createElement","className","classes","wrapper","NoticeBox","error","DAILY","WEEKLY","WEEKLY_WEDNESDAY","WEEKLY_THURSDAY","WEEKLY_SATURDAY","WEEKLY_SUNDAY","BI_WEEKLY","MONTHLY","BI_MONTHLY","QUARTERLY","SIX_MONTHLY","SIX_MONTHLY_APRIL","YEARLY","FINANCIAL_APRIL","FINANCIAL_JULY","FINANCIAL_OCT","FINANCIAL_NOV","getMonthName","key","i18n","t","getWeeklyPeriodType","formatYyyyMmDd","weekObj","fnFilter","config","periods","offset","parseInt","isFilter","filterFuturePeriods","isReverse","reversePeriods","year","Date","now","getFullYear","date","startDayOfWeek","jan4","jan4DayOfWeek","getDay","startDate","dayDiff","setDate","getDate","getEpiWeekStartDay","startDay","week","period","iso","shortName","id","endDate","weekNumber","displayName","push","reverse","getBiWeeklyPeriodType","day","biWeek","biWeekNumber","getMonthlyPeriodType","formatIso","y","m","String","getMonth","length","monthName","getBiMonthlyPeriodType","index","monthStart","monthEnd","fullYear","getQuarterlyPeriodType","quarter","getSixMonthlyPeriodType","getSixMonthlyAprilPeriodType","getYearlyPeriodType","setMonth","dateString","toString","getFinancialOctoberPeriodType","i","setYear","yearStart","yearEnd","getFinancialNovemberPeriodType","getFinancialJulyPeriodType","getFinancialAprilPeriodType","d","array","getFixedPeriodTypes","type","regex","getPeriods","replace","getYearOffsetFromNow","getFixedPeriodsByTypeAndYear","periodType","find","option","getFixedPeriodType","Number","isInteger","Loader","CenteredContent","CircularLoader","Approved","height","viewBox","width","xmlns","fillRule","Ready","Waiting","getApprovalStateDisplayData","approvalState","Error","getApprovalStateText","icon","IconBlock16","IconError16","getApprovalStateIcon","StatusTag","Icon","props","Tag","query","me","resource","params","fields","paging","AppProvider","data","loading","useDataQuery","Layer","providerValue","Provider","value","useAppContext","useContext","AuthWall","some","authority","useIsAuthorized","WorkflowContext","allowedActions","refresh","defaultFn","SelectionContext","workflow","orgUnit","selectWorkflow","selectPeriod","selectOrgUnit","clearAll","setOpenedSelect","createHref","state","stringify","history","createHashHistory","initialValues","workflows","wf","pe","ou","ouDisplayName","parse","location","search","readQueryParams","initialWorkflowValue","initialPeriodValue","initialOrgUnitValue","workflowId","periodId","initialWorkflow","allowedTypes","periodTypes","filter","allowedType","match","parsePeriodId","path","lastPathSegment","ACTIONS","reducer","payload","_state$workflow","_payload$workflow","_payload$period","openedSelect","SelectionProvider","dispatch","useReducer","fieldName","useEffect","_state$period","_state$orgUnit","_state$orgUnit2","paramString","pathname","pushStateToHistory","setStateFromQueryParams","window","addEventListener","removeEventListener","useSelectionContext","approvalStatus","WorkflowProvider","called","refetch","lazy","message","useWorkflowContext","ACCEPT_DATA_MUTATION","AcceptButton","acceptData","useDataMutation","show","useAlert","nsSeparator","Button","small","disabled","onClick","async","ApproveModal","onApprove","onCancel","dataSets","count","Modal","ModalTitle","ModalContent","styles","summary","summaryTitle","summaryList","map","summaryListItem","confirmationStatement","ModalActions","ButtonStrip","primary","APPROVE_DATA_MUTATION","ApproveButton","unexpectedError","setUnexpectedError","useState","showApproveModal","setShowApproveModal","hideApprovalDialog","showApprovalSuccess","approveData","approveError","onComplete","onError","useApproveData","e","Fragment","BottomBarItem","bottomBarItem","UNACCEPT_DATA_MUTATION","UnacceptButton","unacceptData","UNAPPROVE_DATA_MUTATION","UnapproveButton","unapproveData","BottomBar","mayAccept","mayApprove","mayUnaccept","mayUnapprove","disableApproveBtn","bottomBar","DataSetNavigation","selected","onChange","TabBar","scrollable","dataSet","Tab","Table","columns","rows","DataTableToolbar","DataTable","TableHead","DataTableRow","column","DataTableColumnHeader","TableBody","row","DataTableCell","dataSetReport","dataSetId","periodIds","ds","Display","selection","selectedDataSet","startDateReached","convertedPeriods","forEach","periodEnd","endsAfterPeriodStart","getFixedPeriodsForTypeAndDateRange","tables","fetchDataSet","join","display","loadingWrapper","retryButton","table","headers","h","name","noData","chooseDataSet","workflowName","TitleBar","dataSetsCount","titleBar","workflowDataSetsCount","IconDimensionDataSet16","DataWorkspace","setSelectedDataSet","ClearAllButton","button","secondary","ApprovalStatusesContext","ApprovalStatusesMap","constructor","this","_map","Map","_serialiseKey","orgUnitId","set","status","get","clone","ApprovalStatusesProvider","approvalStatuses","setApprovalStatuses","fetchApprovalStatus","updateApprovalStatuses","engine","useDataEngine","requestQueue","useRef","fetchApprovalStatuses","useDebouncedCallback","batchedQueries","current","existingBatchedQuery","orgUnitIds","approvalStatusUpdates","reduce","statuses","updateObject","useFetchApprovalStatus","newApprovalStatuses","Object","entries","useApprovalStatus","getApprovalStatus","ContextSelect","prefix","placeholder","onClose","onOpen","open","requiredValuesMessage","buttonRef","IconChevronUp24","IconChevronDown24","ref","color","colors","grey600","undefined","Tooltip","content","placement","onMouseOver","onMouseOut","tooltipwrap","Popover","reference","arrow","onClickOutside","ApprovalStatusLabel","label","container","iconContainer","ORG_UNIT","OrgUnitSelect","roots","selectedOrgUnitPath","scrollbox","OrganisationUnitTree","initiallyExpanded","singleSelection","renderNodeLabel","node","PeriodMenu","selectedPeriod","Menu","dense","menu","MenuItem","active","href","currentYear","YearNavigator","onYearChange","IconArrowLeft24","IconArrowRight24","PERIOD","PeriodSelect","WorkflowSelectOption","subtitle","bordered","WORKFLOW","WorkflowSelect","selectedWorkflow","TopBar","_extends","assign","target","arguments","source","prototype","hasOwnProperty","call","apply","LayoutSection","Layout","top","bottom","addResources","enTranslations","App","CssVariables","spacers","theme"],"mappings":"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","file":"static/js/app.a96f0632.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"error-message_wrapper__17C15\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"summary\":\"approve-modal_summary__1abcn\",\"summaryTitle\":\"approve-modal_summaryTitle__2sA2i\",\"summaryList\":\"approve-modal_summaryList__1lufS\",\"confirmationStatement\":\"approve-modal_confirmationStatement__1LDKw\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bottomBarItem\":\"bottom-bar-item_bottomBarItem__2GbAg\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bottomBar\":\"bottom-bar_bottomBar__2CojG\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"display\":\"display_display__pmr3Z\",\"chooseDataSet\":\"display_chooseDataSet__2HsJD display_display__pmr3Z\",\"loadingWrapper\":\"display_loadingWrapper__iFDcl\",\"noData\":\"display_noData__2YWIA display_display__pmr3Z\",\"retryButton\":\"display_retryButton__3sQOQ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"titleBar\":\"title-bar_titleBar__3Zvkn\",\"workflowName\":\"title-bar_workflowName__1S55b\",\"workflowDataSetsCount\":\"title-bar_workflowDataSetsCount__t1ej1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"clear-all-button_button__mDEHm\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"context-select_button__1y8va\",\"prefix\":\"context-select_prefix__3xDFu\",\"value\":\"context-select_value__oltZj\",\"tooltipwrap\":\"context-select_tooltipwrap__3Fqbe\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"approval-status-label_container__1xOLq\",\"iconContainer\":\"approval-status-label_iconContainer__3bZcv\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"scrollbox\":\"org-unit-select_scrollbox__23k48\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"menu\":\"period-menu_menu__2CHPS\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"year-navigator_container__3XXd2\",\"year\":\"year-navigator_year__14nbM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bordered\":\"workflow-select-option_bordered__JBAIX\",\"option\":\"workflow-select-option_option__1cqTS\",\"title\":\"workflow-select-option_title__3zrtv\",\"subtitle\":\"workflow-select-option_subtitle__3yrup\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"message\":\"workflow-select_message__1jq5N\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"layout_container__Cp-96\",\"top\":\"layout_top__2gcI9\",\"content\":\"layout_content__10QOH\",\"bottom\":\"layout_bottom__2toTd\"};","import { createContext } from 'react';\nconst AppContext = /*#__PURE__*/createContext({\n  authorities: [],\n  organisationUnits: [],\n  dataApprovalWorkflows: []\n});\nexport { AppContext };","import { NoticeBox } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport classes from './error-message.module.css';\n\nconst ErrorMessage = ({\n  children,\n  title\n}) => /*#__PURE__*/React.createElement(\"div\", {\n  className: classes.wrapper\n}, /*#__PURE__*/React.createElement(NoticeBox, {\n  error: true,\n  title: title\n}, children));\n\nErrorMessage.propTypes = {\n  children: PropTypes.node.isRequired,\n  title: PropTypes.string.isRequired\n};\nexport { ErrorMessage };","import i18n from '@dhis2/d2-i18n';\n/*\n * This code is copied from the analytics repo as a temporary solution.\n * https://github.com/dhis2/analytics/tree/master/src/components/PeriodDimension/utils\n * In the long term, this period related logic should be moved into its own repo, see:\n * https://jira.dhis2.org/browse/LIBS-193\n * The following changes to the code in the anaytics repo have been implemented:\n *   A. Renamed period-CODE to period-ID\n *   B. Adjusted period type names (values) to match the names in the response from `api/periodTypes`\n *   C. Adjusted period type variable names to equivalent of B, but in UPPER_SNAKE_CASE\n * IMO these changes should be implemented in the period package too\n */\n// Period types\n\nexport const DAILY = 'Daily';\nexport const WEEKLY = 'Weekly';\nexport const WEEKLY_WEDNESDAY = 'WeeklyWednesday';\nexport const WEEKLY_THURSDAY = 'WeeklyThursday';\nexport const WEEKLY_SATURDAY = 'WeeklySaturday';\nexport const WEEKLY_SUNDAY = 'WeeklySunday';\nexport const BI_WEEKLY = 'BiWeekly';\nexport const MONTHLY = 'Monthly';\nexport const BI_MONTHLY = 'BiMonthly';\nexport const QUARTERLY = 'Quarterly';\nexport const SIX_MONTHLY = 'SixMonthly';\nexport const SIX_MONTHLY_APRIL = 'SixMonthlyApril'; // export const SIX_MONTHLY_NOV = 'SixMonthlyNov'\n\nexport const YEARLY = 'Yearly';\nexport const FINANCIAL_APRIL = 'FinancialApril';\nexport const FINANCIAL_JULY = 'FinancialJuly';\nexport const FINANCIAL_OCT = 'FinancialOct';\nexport const FINANCIAL_NOV = 'FinancialNov';\n\nconst getMonthName = key => {\n  const monthNames = [i18n.t('January'), i18n.t('February'), i18n.t('March'), i18n.t('April'), i18n.t('May'), i18n.t('June'), i18n.t('July'), i18n.t('August'), i18n.t('September'), i18n.t('October'), i18n.t('November'), i18n.t('December')];\n  return monthNames[key];\n};\n\nconst getDailyPeriodType = (formatYyyyMmDd, fnFilter) => {\n  return config => {\n    let periods = [];\n    const offset = parseInt(config.offset, 10);\n    const isFilter = config.filterFuturePeriods;\n    const isReverse = config.reversePeriods;\n    const year = new Date(Date.now()).getFullYear() + offset;\n    const date = new Date(`01 Jan ${year}`);\n\n    while (date.getFullYear() === year) {\n      const period = {};\n      period.startDate = formatYyyyMmDd(date);\n      period.endDate = period.startDate;\n      period.displayName = period.startDate;\n      period.iso = period.startDate.replace(/-/g, '');\n      period.id = period.iso;\n      periods.push(period);\n      date.setDate(date.getDate() + 1);\n    }\n\n    periods = isFilter ? fnFilter(periods) : periods;\n    periods = isReverse ? periods.reverse() : periods;\n    return periods;\n  };\n};\n\nconst getWeeklyPeriodType = (formatYyyyMmDd, weekObj, fnFilter) => {\n  // Calculate the first date of an EPI year base on ISO standard  ( first week always contains 4th Jan )\n  const getEpiWeekStartDay = (year, startDayOfWeek) => {\n    const jan4 = new Date(year, 0, 4);\n    const jan4DayOfWeek = jan4.getDay();\n    const startDate = jan4;\n    const dayDiff = jan4DayOfWeek - startDayOfWeek;\n\n    if (dayDiff > 0) {\n      startDate.setDate(jan4.getDate() - dayDiff);\n    } else if (dayDiff < 0) {\n      startDate.setDate(jan4.getDate() - dayDiff);\n      startDate.setDate(startDate.getDate() - 7);\n    }\n\n    return startDate;\n  };\n\n  return config => {\n    let periods = [];\n    const offset = parseInt(config.offset, 10);\n    const isFilter = config.filterFuturePeriods;\n    const isReverse = config.reversePeriods;\n    const year = new Date(Date.now()).getFullYear() + offset;\n    const date = getEpiWeekStartDay(year, weekObj.startDay);\n    let week = 1;\n\n    while (date.getFullYear() <= year) {\n      const period = {};\n      period.startDate = formatYyyyMmDd(date);\n      period.iso = `${year}${weekObj.shortName}W${week}`;\n      period.id = period.iso;\n      date.setDate(date.getDate() + 6);\n      period.endDate = formatYyyyMmDd(date);\n      const weekNumber = week;\n      period.displayName = `${i18n.t('Week {{weekNumber}}', {\n        weekNumber\n      })} - ${period.startDate} - ${period.endDate}`; // if end date is Jan 4th or later, week belongs to next year\n\n      if (date.getFullYear() > year && date.getDate() >= 4) {\n        break;\n      }\n\n      periods.push(period);\n      date.setDate(date.getDate() + 1);\n      week += 1;\n    }\n\n    periods = isFilter ? fnFilter(periods) : periods;\n    periods = isReverse ? periods.reverse() : periods;\n    return periods;\n  };\n};\n\nconst getBiWeeklyPeriodType = (formatYyyyMmDd, fnFilter) => {\n  return config => {\n    let periods = [];\n    const offset = parseInt(config.offset, 10);\n    const isFilter = config.filterFuturePeriods;\n    const isReverse = config.reversePeriods;\n    const year = new Date(Date.now()).getFullYear() + offset;\n    const date = new Date(`01 Jan ${year}`);\n    const day = date.getDay();\n    let biWeek = 1;\n\n    if (day <= 4) {\n      date.setDate(date.getDate() - (day - 1));\n    } else {\n      date.setDate(date.getDate() + (8 - day));\n    }\n\n    while (date.getFullYear() <= year) {\n      const period = {};\n      period.iso = `${year}BiW${biWeek}`;\n      period.id = period.iso;\n      period.startDate = formatYyyyMmDd(date);\n      date.setDate(date.getDate() + 13);\n      period.endDate = formatYyyyMmDd(date);\n      const biWeekNumber = biWeek;\n      period.displayName = `${i18n.t('Bi-Week {{biWeekNumber}}', {\n        biWeekNumber\n      })} - ${period.startDate} - ${period.endDate}`; // if end date is Jan 4th or later, biweek belongs to next year\n\n      if (date.getFullYear() > year && date.getDate() >= 4) {\n        break;\n      }\n\n      periods.push(period);\n      date.setDate(date.getDate() + 1);\n      biWeek += 1;\n    }\n\n    periods = isFilter ? fnFilter(periods) : periods;\n    periods = isReverse ? periods.reverse() : periods;\n    return periods;\n  };\n};\n\nconst getMonthlyPeriodType = (formatYyyyMmDd, fnFilter) => {\n  const formatIso = date => {\n    const y = date.getFullYear();\n    let m = String(date.getMonth() + 1);\n    m = m.length < 2 ? `0${m}` : m;\n    return y + m;\n  };\n\n  return config => {\n    let periods = [];\n    const offset = parseInt(config.offset, 10);\n    const isFilter = config.filterFuturePeriods;\n    const isReverse = config.reversePeriods;\n    const year = new Date(Date.now()).getFullYear() + offset;\n    const date = new Date(`31 Dec ${year}`);\n\n    while (date.getFullYear() === year) {\n      const period = {};\n      period.endDate = formatYyyyMmDd(date);\n      date.setDate(1);\n      period.startDate = formatYyyyMmDd(date);\n      const monthName = getMonthName(date.getMonth());\n      period.displayName = `${monthName} ${year}`;\n      period.iso = formatIso(date);\n      period.id = period.iso;\n      periods.push(period);\n      date.setDate(0);\n    }\n\n    periods = isFilter ? fnFilter(periods) : periods;\n    periods = isReverse ? periods : periods.reverse(); // Months are collected backwards. If isReverse is true, then do nothing. Else reverse to correct order and return.\n\n    return periods;\n  };\n};\n\nconst getBiMonthlyPeriodType = (formatYyyyMmDd, fnFilter) => {\n  return config => {\n    let periods = [];\n    const offset = parseInt(config.offset, 10);\n    const isFilter = config.filterFuturePeriods;\n    const isReverse = config.reversePeriods;\n    const year = new Date(Date.now()).getFullYear() + offset;\n    const date = new Date(`31 Dec ${year}`);\n    let index = 6;\n\n    while (date.getFullYear() === year) {\n      const period = {};\n      period.endDate = formatYyyyMmDd(date);\n      date.setDate(0);\n      date.setDate(1);\n      period.startDate = formatYyyyMmDd(date);\n      const monthStart = getMonthName(date.getMonth());\n      const monthEnd = getMonthName(date.getMonth() + 1);\n      const fullYear = date.getFullYear();\n      period.displayName = `${monthStart} - ${monthEnd} ${fullYear}`;\n      period.iso = `${year}0${index}B`;\n      period.id = period.iso;\n      periods.push(period);\n      date.setDate(0);\n      index--;\n    }\n\n    periods = isFilter ? fnFilter(periods) : periods;\n    periods = isReverse ? periods : periods.reverse(); // Bi-months are collected backwards. If isReverse is true, then do nothing. Else reverse to correct order and return.\n\n    return periods;\n  };\n};\n\nconst getQuarterlyPeriodType = (formatYyyyMmDd, fnFilter) => {\n  return config => {\n    let periods = [];\n    const offset = parseInt(config.offset, 10);\n    const isFilter = config.filterFuturePeriods;\n    const isReverse = config.reversePeriods;\n    const year = new Date(Date.now()).getFullYear() + offset;\n    const date = new Date(`31 Dec ${year}`);\n    let quarter = 4;\n\n    while (date.getFullYear() === year) {\n      const period = {};\n      period.endDate = formatYyyyMmDd(date);\n      date.setDate(0);\n      date.setDate(0);\n      date.setDate(1);\n      period.startDate = formatYyyyMmDd(date);\n      const monthStart = getMonthName(date.getMonth());\n      const monthEnd = getMonthName(date.getMonth() + 2);\n      const fullYear = date.getFullYear();\n      period.displayName = `${monthStart} - ${monthEnd} ${fullYear}`;\n      period.iso = `${year}Q${quarter}`;\n      period.id = period.iso;\n      periods.push(period);\n      date.setDate(0);\n      quarter -= 1;\n    }\n\n    periods = isFilter ? fnFilter(periods) : periods;\n    periods = isReverse ? periods : periods.reverse(); // Quarters are collected backwards. If isReverse is true, then do nothing. Else reverse to correct order and return.\n\n    return periods;\n  };\n};\n\nconst getSixMonthlyPeriodType = fnFilter => {\n  return config => {\n    let periods = [];\n    const offset = parseInt(config.offset, 10);\n    const isFilter = config.filterFuturePeriods;\n    const isReverse = config.reversePeriods;\n    const year = new Date(Date.now()).getFullYear() + offset;\n    let period = {};\n    period.startDate = `${year}-01-01`;\n    period.endDate = `${year}-06-30`;\n    period.displayName = `${getMonthName(0)} - ${getMonthName(5)} ${year}`;\n    period.iso = `${year}S1`;\n    period.id = period.iso;\n    periods.push(period);\n    period = {};\n    period.startDate = `${year}-07-01`;\n    period.endDate = `${year}-12-31`;\n    period.displayName = `${getMonthName(6)} - ${getMonthName(11)} ${year}`;\n    period.iso = `${year}S2`;\n    period.id = period.iso;\n    periods.push(period);\n    periods = isFilter ? fnFilter(periods) : periods;\n    periods = isReverse ? periods.reverse() : periods;\n    return periods;\n  };\n};\n\nconst getSixMonthlyAprilPeriodType = fnFilter => {\n  return config => {\n    let periods = [];\n    const offset = parseInt(config.offset, 10);\n    const isFilter = config.filterFuturePeriods;\n    const isReverse = config.reversePeriods;\n    const year = new Date(Date.now()).getFullYear() + offset;\n    let period = {};\n    period.startDate = `${year}-04-01`;\n    period.endDate = `${year}-09-30`;\n    period.displayName = `${getMonthName(3)} - ${getMonthName(8)} ${year}`;\n    period.iso = `${year}AprilS1`;\n    period.id = period.iso;\n    periods.push(period);\n    period = {};\n    period.startDate = `${year}-10-01`;\n    period.endDate = `${year + 1}-03-31`;\n    period.displayName = `${getMonthName(9)} ${year} - ${getMonthName(2)} ${year + 1}`;\n    period.iso = `${year}AprilS2`;\n    period.id = period.iso;\n    periods.push(period);\n    periods = isFilter ? fnFilter(periods) : periods;\n    periods = isReverse ? periods.reverse() : periods;\n    return periods;\n  };\n};\n\nconst getYearlyPeriodType = (formatYyyyMmDd, fnFilter) => {\n  return config => {\n    let periods = [];\n    const offset = parseInt(config.offset, 10);\n    const isFilter = config.filterFuturePeriods;\n    const isReverse = config.reversePeriods;\n    const year = new Date(Date.now()).getFullYear() + offset;\n    const date = new Date(`31 Dec ${year}`);\n\n    while (year - date.getFullYear() < 10) {\n      const period = {};\n      period.endDate = formatYyyyMmDd(date);\n      date.setMonth(0, 1);\n      period.startDate = formatYyyyMmDd(date);\n      const dateString = date.getFullYear().toString();\n      period.displayName = dateString;\n      period.iso = date.getFullYear().toString();\n      period.id = period.iso.toString();\n      periods.push(period);\n      date.setDate(0);\n    }\n\n    periods = isFilter ? fnFilter(periods) : periods;\n    periods = isReverse ? periods : periods.reverse(); // Years are collected backwards. If isReverse is true, then do nothing. Else reverse to correct order and return.\n\n    return periods;\n  };\n};\n\nconst getFinancialOctoberPeriodType = (formatYyyyMmDd, fnFilter) => {\n  return config => {\n    let periods = [];\n    const offset = parseInt(config.offset, 10);\n    const isFilter = config.filterFuturePeriods;\n    const isReverse = config.reversePeriods;\n    const year = new Date(Date.now()).getFullYear() + offset;\n    const date = new Date(`30 Sep ${year + 1}`);\n\n    for (let i = 0; i < 10; i++) {\n      const period = {};\n      period.endDate = formatYyyyMmDd(date);\n      date.setYear(date.getFullYear() - 1);\n      date.setDate(date.getDate() + 1);\n      period.startDate = formatYyyyMmDd(date);\n      const yearStart = date.getFullYear();\n      const yearEnd = date.getFullYear() + 1;\n      period.displayName = `${getMonthName(9)} ${yearStart} - ${getMonthName(8)} ${yearEnd}`;\n      period.id = `${date.getFullYear()}Oct`;\n      periods.push(period);\n      date.setDate(date.getDate() - 1);\n    }\n\n    periods = isFilter ? fnFilter(periods) : periods;\n    periods = isReverse ? periods : periods.reverse(); // FinancialOctober periods are collected backwards. If isReverse is true, then do nothing. Else reverse to correct order and return.\n\n    return periods;\n  };\n};\n\nconst getFinancialNovemberPeriodType = (formatYyyyMmDd, fnFilter) => {\n  return config => {\n    let periods = [];\n    const offset = parseInt(config.offset, 10);\n    const isFilter = config.filterFuturePeriods;\n    const isReverse = config.reversePeriods;\n    const year = new Date(Date.now()).getFullYear() + offset;\n    const date = new Date(`31 Oct ${year + 1}`);\n\n    for (let i = 0; i < 10; i++) {\n      const period = {};\n      period.endDate = formatYyyyMmDd(date);\n      date.setYear(date.getFullYear() - 1);\n      date.setDate(date.getDate() + 1);\n      period.startDate = formatYyyyMmDd(date);\n      const yearStart = date.getFullYear();\n      const yearEnd = date.getFullYear() + 1;\n      period.displayName = `${getMonthName(10)} ${yearStart} - ${getMonthName(9)} ${yearEnd}`;\n      period.id = `${date.getFullYear()}Nov`;\n      periods.push(period);\n      date.setDate(date.getDate() - 1);\n    }\n\n    periods = isFilter ? fnFilter(periods) : periods;\n    periods = isReverse ? periods : periods.reverse(); // FinancialNovember periods are collected backwards. If isReverse is true, then do nothing. Else reverse to correct order and return.\n\n    return periods;\n  };\n};\n\nconst getFinancialJulyPeriodType = (formatYyyyMmDd, fnFilter) => {\n  return config => {\n    let periods = [];\n    const offset = parseInt(config.offset, 10);\n    const isFilter = config.filterFuturePeriods;\n    const isReverse = config.reversePeriods;\n    const year = new Date(Date.now()).getFullYear() + offset;\n    const date = new Date(`30 Jun ${year + 1}`);\n\n    for (let i = 0; i < 10; i++) {\n      const period = {};\n      period.endDate = formatYyyyMmDd(date);\n      date.setYear(date.getFullYear() - 1);\n      date.setDate(date.getDate() + 1);\n      period.startDate = formatYyyyMmDd(date);\n      const yearStart = date.getFullYear();\n      const yearEnd = date.getFullYear() + 1;\n      period.displayName = `${getMonthName(6)} ${yearStart} - ${getMonthName(5)} ${yearEnd}`;\n      period.id = `${date.getFullYear()}July`;\n      periods.push(period);\n      date.setDate(date.getDate() - 1);\n    }\n\n    periods = isFilter ? fnFilter(periods) : periods;\n    periods = isReverse ? periods : periods.reverse(); // FinancialJuly periods are collected backwards. If isReverse is true, then do nothing. Else reverse to correct order and return.\n\n    return periods;\n  };\n};\n\nconst getFinancialAprilPeriodType = (formatYyyyMmDd, fnFilter) => {\n  return config => {\n    let periods = [];\n    const offset = parseInt(config.offset, 10);\n    const isFilter = config.filterFuturePeriods;\n    const isReverse = config.reversePeriods;\n    const year = new Date(Date.now()).getFullYear() + offset;\n    const date = new Date(`31 Mar ${year + 1}`);\n\n    for (let i = 0; i < 10; i++) {\n      const period = {};\n      period.endDate = formatYyyyMmDd(date);\n      date.setYear(date.getFullYear() - 1);\n      date.setDate(date.getDate() + 1);\n      period.startDate = formatYyyyMmDd(date);\n      const yearStart = date.getFullYear();\n      const yearEnd = date.getFullYear() + 1;\n      period.displayName = `${getMonthName(3)} ${yearStart} - ${getMonthName(2)} ${yearEnd}`;\n      period.id = `${date.getFullYear()}April`;\n      periods.push(period);\n      date.setDate(date.getDate() - 1);\n    }\n\n    periods = isFilter ? fnFilter(periods) : periods;\n    periods = isReverse ? periods : periods.reverse(); // FinancialApril periods are collected backwards. If isReverse is true, then do nothing. Else reverse to correct order and return.\n\n    return periods;\n  };\n};\n\nconst formatYyyyMmDd = date => {\n  const y = date.getFullYear();\n  let m = String(date.getMonth() + 1);\n  let d = String(date.getDate());\n  m = m.length < 2 ? `0${m}` : m;\n  d = d.length < 2 ? `0${d}` : d;\n  return `${y}-${m}-${d}`;\n};\n\nconst filterFuturePeriods = periods => {\n  const array = [];\n  const now = new Date(Date.now());\n\n  for (let i = 0; i < periods.length; i++) {\n    if (new Date(periods[i].startDate) <= now) {\n      array.push(periods[i]);\n    }\n  }\n\n  return array;\n};\n\nexport const getFixedPeriodTypes = () => [{\n  type: DAILY,\n  regex: /^([0-9]{4})([0-9]{2})([0-9]{2})$/,\n  // YYYYMMDD\n  getPeriods: getDailyPeriodType(formatYyyyMmDd, filterFuturePeriods),\n  displayName: i18n.t('Daily')\n}, {\n  type: WEEKLY,\n  regex: /^([0-9]{4})()W([0-9]{1,2})$/,\n  // YYYY\"W\"[1-53]\n  getPeriods: getWeeklyPeriodType(formatYyyyMmDd, {\n    shortName: '',\n    startDay: 1\n  }, filterFuturePeriods),\n  displayName: i18n.t('Weekly')\n}, {\n  type: WEEKLY_WEDNESDAY,\n  regex: /^([0-9]{4})(Wed)W([0-9]{1,2})$/,\n  // YYYY\"WedW\"[1-53]\n  getPeriods: getWeeklyPeriodType(formatYyyyMmDd, {\n    shortName: 'Wed',\n    startDay: 3\n  }, filterFuturePeriods),\n  displayName: i18n.t('Weekly (Start Wednesday)')\n}, {\n  type: WEEKLY_THURSDAY,\n  regex: /^([0-9]{4})(Thu)W([0-9]{1,2})$/,\n  // YYYY\"ThuW\"[1-53]\n  getPeriods: getWeeklyPeriodType(formatYyyyMmDd, {\n    shortName: 'Thu',\n    startDay: 4\n  }, filterFuturePeriods),\n  displayName: i18n.t('Weekly (Start Thursday)')\n}, {\n  type: WEEKLY_SATURDAY,\n  regex: /^([0-9]{4})(Sat)W([0-9]{1,2})$/,\n  // YYYY\"SatW\"[1-53]\n  getPeriods: getWeeklyPeriodType(formatYyyyMmDd, {\n    shortName: 'Sat',\n    startDay: 6\n  }, filterFuturePeriods),\n  displayName: i18n.t('Weekly (Start Saturday)')\n}, {\n  type: WEEKLY_SUNDAY,\n  regex: /^([0-9]{4})(Sun)W([0-9]{1,2})$/,\n  // YYYY\"SunW\"[1-53]\n  getPeriods: getWeeklyPeriodType(formatYyyyMmDd, {\n    shortName: 'Sun',\n    startDay: 7\n  }, filterFuturePeriods),\n  displayName: i18n.t('Weekly (Start Sunday)')\n}, {\n  type: BI_WEEKLY,\n  regex: /^([0-9]{4})BiW([0-9]{1,2})$/,\n  // YYYY\"BiW\"[1-27]\n  getPeriods: getBiWeeklyPeriodType(formatYyyyMmDd, filterFuturePeriods),\n  displayName: i18n.t('Bi-weekly')\n}, {\n  type: MONTHLY,\n  regex: /^([0-9]{4})([0-9]{2})$/,\n  // YYYYMM\n  getPeriods: getMonthlyPeriodType(formatYyyyMmDd, filterFuturePeriods),\n  displayName: i18n.t('Monthly')\n}, {\n  type: BI_MONTHLY,\n  regex: /^([0-9]{4})([0-9]{2})B$/,\n  // YYYY0[1-6]\"B\"\n  getPeriods: getBiMonthlyPeriodType(formatYyyyMmDd, filterFuturePeriods),\n  displayName: i18n.t('Bi-monthly')\n}, {\n  type: QUARTERLY,\n  regex: /^([0-9]{4})Q([1234])$/,\n  // YYYY\"Q\"[1-4]\n  getPeriods: getQuarterlyPeriodType(formatYyyyMmDd, filterFuturePeriods),\n  displayName: i18n.t('Quarterly')\n}, {\n  type: SIX_MONTHLY,\n  regex: /^([0-9]{4})S([12])$/,\n  // YYYY\"S\"[1/2]\n  getPeriods: getSixMonthlyPeriodType(filterFuturePeriods),\n  displayName: i18n.t('Six-monthly')\n}, {\n  type: SIX_MONTHLY_APRIL,\n  regex: /^([0-9]{4})AprilS([12])$/,\n  // YYYY\"AprilS\"[1/2]\n  getPeriods: getSixMonthlyAprilPeriodType(filterFuturePeriods),\n  displayName: i18n.t('Six-monthly April')\n}, {\n  type: YEARLY,\n  regex: /^([0-9]{4})$/,\n  // YYYY\n  getPeriods: getYearlyPeriodType(formatYyyyMmDd, filterFuturePeriods),\n  displayName: i18n.t('Yearly')\n}, {\n  type: FINANCIAL_NOV,\n  regex: /^([0-9]{4})Nov$/,\n  // YYYY\"Nov\"\n  getPeriods: getFinancialNovemberPeriodType(formatYyyyMmDd, filterFuturePeriods),\n  displayName: i18n.t('Financial year (Start November)')\n}, {\n  type: FINANCIAL_OCT,\n  regex: /^([0-9]{4})Oct$/,\n  // YYYY\"Oct\"\n  getPeriods: getFinancialOctoberPeriodType(formatYyyyMmDd, filterFuturePeriods),\n  displayName: i18n.t('Financial year (Start October)')\n}, {\n  type: FINANCIAL_JULY,\n  regex: /^([0-9]{4})July$/,\n  // YYYY\"July\"\n  getPeriods: getFinancialJulyPeriodType(formatYyyyMmDd, filterFuturePeriods),\n  displayName: i18n.t('Financial year (Start July)')\n}, {\n  type: FINANCIAL_APRIL,\n  regex: /^([0-9]{4})April$/,\n  // YYYY\"April\"\n  getPeriods: getFinancialAprilPeriodType(formatYyyyMmDd, filterFuturePeriods),\n  displayName: i18n.t('Financial year (Start April)')\n}];\nexport const getFixedPeriodType = type => getFixedPeriodTypes().find(option => option.type === type);\nexport const getYearOffsetFromNow = year => year - new Date(Date.now()).getFullYear();\nexport const getFixedPeriodsByTypeAndYear = (type, year) => {\n  const periodType = getFixedPeriodType(type);\n  const offset = getYearOffsetFromNow(year);\n  return periodType && Number.isInteger(offset) ? periodType.getPeriods({\n    offset\n  }) : [];\n};\nexport const parsePeriodId = (id, allowedTypes) => {\n  const periodTypes = allowedTypes ? getFixedPeriodTypes().filter(({\n    type\n  }) => allowedTypes.some(allowedType => allowedType === type)) : getFixedPeriodTypes();\n  let i = 0;\n  let periodType = undefined;\n  let match = undefined;\n\n  while (i < periodTypes.length && !match) {\n    periodType = periodTypes[i];\n    match = id.match(periodType.regex);\n    i++;\n  }\n\n  if (!match) {\n    return null;\n  }\n\n  const year = parseInt(match[1]);\n  const offset = getYearOffsetFromNow(year);\n  const periods = periodType.getPeriods({\n    offset\n  });\n  const period = periods.find(period => period.id === id);\n  return { ...period,\n\n    /*\n     * Add year and periodType so a parsed period code\n     * can be use for a multitude of purposes\n     */\n    year,\n    periodType\n  };\n};\nexport const getFixedPeriodsForTypeAndDateRange = (type, startDate, endDate) => {\n  // Allow dates and date-strings\n  startDate = startDate instanceof Date ? startDate : new Date(startDate);\n  endDate = endDate instanceof Date ? endDate : new Date(endDate);\n  let year = endDate.getFullYear();\n  let startDateReached = false;\n  const convertedPeriods = [];\n\n  while (!startDateReached) {\n    getFixedPeriodsByTypeAndYear(type, year).reverse().forEach(period => {\n      const periodEnd = new Date(period.endDate); // exclude periods that end before start date\n\n      const endsAfterPeriodStart = periodEnd >= startDate; // exclude periods that end after end date\n\n      const endsBeforePeriodEnd = periodEnd <= endDate;\n\n      if (!endsAfterPeriodStart) {\n        startDateReached = true;\n      }\n\n      if (endsAfterPeriodStart && endsBeforePeriodEnd) {\n        convertedPeriods.push(period);\n      }\n    });\n    --year;\n  }\n\n  return convertedPeriods.reverse();\n};\nconst FIXED_PERIODS_BY_LENGTH = [[DAILY], [WEEKLY, WEEKLY_WEDNESDAY, WEEKLY_THURSDAY, WEEKLY_SATURDAY, WEEKLY_SUNDAY], [BI_WEEKLY], [MONTHLY], [BI_MONTHLY], [QUARTERLY], [SIX_MONTHLY, SIX_MONTHLY_APRIL], [YEARLY, FINANCIAL_APRIL, FINANCIAL_JULY, FINANCIAL_OCT, FINANCIAL_NOV]];\nexport const PERIOD_GREATER = 1;\nexport const PERIOD_EQUAL = 0;\nexport const PERIOD_SHORTER = -1;\n/*\n * IF left < right THEN return  1\n * IF left > right THEN return -1\n * IF left = right THEN return  0\n *\n * Why right > left = 1 and not the other way?\n * When partially applying this function, it makes sense this way:\n *\n * const compareWithWeekly = partial(compareFixedPeriodLength, 'WEEKLY')\n * const isGreater = compareWithWeekly('YEARLY') === PERIOD_GREATER\n * -> isGreater is true\n *\n * @param {string} right\n * @param {string} left\n * @returns {Int}\n */\n\nexport const compareFixedPeriodLength = (left, right) => {\n  const leftIndex = FIXED_PERIODS_BY_LENGTH.findIndex(types => types.includes(left));\n  const rightIndex = FIXED_PERIODS_BY_LENGTH.findIndex(types => types.includes(right));\n  if (leftIndex === rightIndex) return PERIOD_EQUAL;\n  return leftIndex > rightIndex ? PERIOD_SHORTER : PERIOD_GREATER;\n};\nexport const getCurrentPeriodForType = type => {\n  const currentDate = new Date();\n  let year = currentDate.getFullYear(); // cover this and the next years as that\n  // should cover all existing period types\n\n  for (let i = 0; i < 2; ++i) {\n    const periods = getFixedPeriodsByTypeAndYear(type, year).reverse();\n\n    for (const period of periods) {\n      const periodStart = new Date(period.startDate);\n      const periodEnd = new Date(period.endDate);\n      const endsBeforePeriodEnd = currentDate <= periodEnd;\n      const startsAfterPeriodStart = currentDate >= periodStart;\n\n      if (endsBeforePeriodEnd && startsAfterPeriodStart) {\n        return period;\n      }\n    }\n\n    ++year;\n  }\n\n  return null;\n};\nexport const isGreaterPeriodTypeEndDateWithinShorterPeriod = (greaterPeriodType, shorterPeriod) => {\n  const greaterPeriod = getCurrentPeriodForType(greaterPeriodType);\n  const greaterPeriodEndDate = new Date(greaterPeriod.endDate);\n  const shorterPeriodEndDate = new Date(shorterPeriod.endDate);\n  const shorterPeriodStartDate = new Date(shorterPeriod.startDate);\n  const greaterEndsAfterShorterStarts = greaterPeriodEndDate >= shorterPeriodStartDate;\n  const greaterEndsBeforeShorterEnds = greaterPeriodEndDate <= shorterPeriodEndDate;\n  return greaterEndsAfterShorterStarts && greaterEndsBeforeShorterEnds;\n};","import { CenteredContent, CircularLoader } from '@dhis2/ui';\nimport React from 'react';\n\nconst Loader = () => /*#__PURE__*/React.createElement(CenteredContent, null, /*#__PURE__*/React.createElement(CircularLoader, null));\n\nexport { Loader };","import React from 'react';\n\nconst Approved = () => /*#__PURE__*/React.createElement(\"svg\", {\n  height: \"16\",\n  viewBox: \"0 0 16 16\",\n  width: \"16\",\n  xmlns: \"http://www.w3.org/2000/svg\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"m7 10.707-2.5-2.5005.7065-.7065 1.7935 1.793 3.7925-3.793.7075.7075zm1-9.707c-3.86599325 0-7 3.13400675-7 7 0 3.8659932 3.13400675 7 7 7 3.8659932 0 7-3.1340068 7-7 0-1.85651543-.7374979-3.63699282-2.0502525-4.94974747-1.3127547-1.31275465-3.09323207-2.05025253-4.9497475-2.05025253zm0 13c-3.3137085 0-6-2.6862915-6-6s2.6862915-6 6-6 6 2.6862915 6 6c0 1.59129894-.632141 3.1174224-1.7573593 4.2426407s-2.65134176 1.7573593-4.2426407 1.7573593z\",\n  fillRule: \"evenodd\"\n}));\n\nconst Ready = () => /*#__PURE__*/React.createElement(\"svg\", {\n  height: \"16\",\n  viewBox: \"0 0 16 16\",\n  width: \"16\",\n  xmlns: \"http://www.w3.org/2000/svg\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"m8 1c3.8659932 0 7 3.13400675 7 7 0 3.8659932-3.1340068 7-7 7-3.86599325 0-7-3.1340068-7-7 0-3.86599325 3.13400675-7 7-7zm0 1c-3.3137085 0-6 2.6862915-6 6s2.6862915 6 6 6 6-2.6862915 6-6-2.6862915-6-6-6zm0 3c1.65685425 0 3 1.34314575 3 3s-1.34314575 3-3 3-3-1.34314575-3-3 1.34314575-3 3-3z\"\n}));\n\nconst Waiting = () => /*#__PURE__*/React.createElement(\"svg\", {\n  height: \"16\",\n  viewBox: \"0 0 16 16\",\n  width: \"16\",\n  xmlns: \"http://www.w3.org/2000/svg\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"m10.9909978 13.1912785.4995502.8652231c-.6149252.36386-1.28431.6250019-1.98177134.7738229l-.30055406.0568756-.17347694-.9839041c.69055396-.1141334 1.35389354-.3555692 1.95625214-.7120175zm-5.99434717 0c.51630734.3055271 1.07741706.5265553 1.66206503.655345l.29418707.0566725-.17347695.9839041c-.70494478-.1165334-1.38558203-.3467594-2.01552871-.6810754l-.26679673-.1496231zm8.63003137-3.1410745.9388324.3416946c-.2371754.6739992-.5820951 1.3043178-1.0207212 1.8666408l-.1936788.2367617-.7653324-.6422054c.4556314-.5313108.8085871-1.1426479 1.0409-1.8028917zm-11.26571557 0c.19912533.5659233.48688614 1.095915.85196802 1.5703782l.18893198.2325135-.7653324.6422054c-.46511284-.5423995-.8385248-1.1562681-1.10619776-1.8172909l-.10820224-.2861116zm2.98641115-5.40375758 6.00000002 5.99999998-.7071068.7071068-6-5.99999999zm9.21813622.96165313c.2515515.66876676.3924886 1.37332892.4179358 2.08603675l.0038209.30586432-.9990803-.0000117c.0064405-.59989882-.0826983-1.19634818-.2634871-1.76706305l-.0980137-.28310973zm-13.14337922 0 .93882439.34171659c-.21122962.56151769-.3314642 1.15248403-.35677429 1.750614l-.00472648.29955878-.99908031.0000117c-.0087422-.81653816.13426921-1.6275962.42175669-2.39190107zm10.06841202-3.6646023c.6225747.35061085 1.1834226.79974418 1.661036 1.32935292l.1995328.23184963-.7653475.64218748c-.3806737-.46368907-.8323483-.86329844-1.337689-1.18428261l-.2570623-.15387264zm-6.99344486 0 .49953002.86523478c-.52274789.29437172-.99471877.66979291-1.39857796 1.11171803l-.19617336.22643722-.76534744-.64218748c.51816369-.6311239 1.14905485-1.16050444 1.86056874-1.56120255zm4.36598381-.88594632.34513864.05524888-.1735.9839c-.58966661-.11051404-1.19253336-.12630176-1.78597144-.04736316l-.29582856.04736316-.1735-.9839c.68795575-.12891407 1.39130692-.14733037 2.08366136-.05524888z\",\n  fillRule: \"evenodd\"\n}));\n\nexport { Approved, Ready, Waiting };","import i18n from '@dhis2/d2-i18n';\nimport { IconBlock16, IconError16 } from '@dhis2/ui';\nimport { Approved, Ready, Waiting } from './icons.js';\n\nconst getApprovalStateIcon = approvalState => {\n  switch (approvalState) {\n    case 'UNAPPROVED_READY':\n    case 'ACCEPTED_HERE':\n      return {\n        icon: Ready,\n        type: 'neutral'\n      };\n\n    case 'UNAPPROVED_WAITING':\n    case 'UNAPPROVED_ABOVE':\n      return {\n        icon: Waiting,\n        type: 'default'\n      };\n\n    case 'APPROVED_HERE':\n    case 'APPROVED_ABOVE':\n      return {\n        icon: Approved,\n        type: 'positive'\n      };\n\n    case 'UNAPPROVABLE':\n      return {\n        icon: IconBlock16,\n        type: 'negative'\n      };\n\n    case 'ERROR':\n      return {\n        icon: IconError16,\n        type: 'negative'\n      };\n\n    default:\n      throw new Error(`Unknown approval state: '${approvalState}'`);\n  }\n};\n\nconst getApprovalStateText = approvalState => {\n  switch (approvalState) {\n    case 'UNAPPROVED_READY':\n      return i18n.t('Ready for approval');\n\n    case 'ACCEPTED_HERE':\n      return i18n.t('Ready for approval — Accepted');\n\n    case 'UNAPPROVED_WAITING':\n      return i18n.t('Waiting for lower level approval');\n\n    case 'UNAPPROVED_ABOVE':\n      return i18n.t('Waiting for higher level approval');\n\n    case 'APPROVED_HERE':\n    case 'APPROVED_ABOVE':\n      return i18n.t('Approved');\n\n    case 'UNAPPROVABLE':\n      return i18n.t('Cannot be approved');\n\n    case 'ERROR':\n      return i18n.t('Could not retrieve approval status');\n\n    default:\n      throw new Error(`Unknown approval state: '${approvalState}'`);\n  }\n};\n\nconst getApprovalStateDisplayData = approvalState => {\n  const displayName = getApprovalStateText(approvalState);\n  const {\n    icon,\n    type\n  } = getApprovalStateIcon(approvalState);\n  return {\n    displayName,\n    icon,\n    type\n  };\n};\n\nexport { getApprovalStateDisplayData, getApprovalStateIcon };","import { Tag } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { getApprovalStateDisplayData } from './get-approval-state.js';\n\nconst StatusTag = ({\n  approvalState\n}) => {\n  const {\n    icon: Icon,\n    displayName,\n    type\n  } = getApprovalStateDisplayData(approvalState);\n  const props = {\n    [type]: true,\n    icon: /*#__PURE__*/React.createElement(Icon, null)\n  };\n  return /*#__PURE__*/React.createElement(Tag, props, displayName);\n};\n\nStatusTag.propTypes = {\n  approvalState: PropTypes.oneOf(['APPROVED_HERE', 'APPROVED_ABOVE', 'ACCEPTED_HERE', 'UNAPPROVED_READY', 'UNAPPROVED_WAITING', 'UNAPPROVED_ABOVE', 'UNAPPROVABLE'])\n};\nexport { StatusTag };","import { useDataQuery } from '@dhis2/app-runtime';\nimport { PropTypes } from '@dhis2/prop-types';\nimport { Layer } from '@dhis2/ui';\nimport React from 'react';\nimport { Loader } from '../shared/index.js';\nimport { AppContext } from './app-context.js';\nconst query = {\n  me: {\n    resource: 'me',\n    params: {\n      fields: ['authorities', 'organisationUnits']\n    }\n  },\n  dataApprovalWorkflows: {\n    // This is generic enpoint but will only return\n    // workflows a user is allowed to see\n    resource: 'dataApprovalWorkflows',\n    params: {\n      paging: false,\n      fields: ['id', 'displayName', 'dataApprovalLevels', 'periodType', 'dataSets[id,displayName,periodType]']\n    }\n  }\n};\n\nconst AppProvider = ({\n  children\n}) => {\n  const {\n    data,\n    loading,\n    error\n  } = useDataQuery(query);\n\n  if (loading) {\n    return /*#__PURE__*/React.createElement(Layer, null, /*#__PURE__*/React.createElement(Loader, null));\n  }\n\n  if (error) {\n    /**\n     * The app can't continue if this fails, because it doesn't\n     * have any data, so throw the error and let it be caught by\n     * the error boundary in the app-shell\n     */\n    throw error;\n  }\n\n  const {\n    authorities,\n    organisationUnits\n  } = data.me;\n  const {\n    dataApprovalWorkflows\n  } = data.dataApprovalWorkflows;\n  const providerValue = {\n    authorities,\n    organisationUnits,\n    dataApprovalWorkflows\n  };\n  return /*#__PURE__*/React.createElement(AppContext.Provider, {\n    value: providerValue\n  }, children);\n};\n\nAppProvider.propTypes = {\n  children: PropTypes.node.isRequired\n};\nexport { AppProvider };","import { useContext } from 'react';\nimport { AppContext } from './app-context.js';\nexport const useAppContext = () => useContext(AppContext);","import i18n from '@dhis2/d2-i18n';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { ErrorMessage } from '../shared/index.js';\nimport { useIsAuthorized } from './use-is-authorized.js';\n\nconst AuthWall = ({\n  children\n}) => {\n  const isAuthorized = useIsAuthorized();\n\n  if (!isAuthorized) {\n    return /*#__PURE__*/React.createElement(ErrorMessage, {\n      title: i18n.t('Not authorized')\n    }, i18n.t(\"You don't have access to the Data Approval App. Contact a system administrator to request access.\"));\n  }\n\n  return children;\n};\n\nAuthWall.propTypes = {\n  children: PropTypes.node.isRequired\n};\nexport { AuthWall };","import { useAppContext } from '../app-context/index.js';\nexport const useIsAuthorized = () => {\n  const {\n    authorities\n  } = useAppContext();\n  return authorities.some(authority => authority === 'ALL' || authority === 'M_dhis-web-approval');\n};","import { createContext } from 'react';\nconst WorkflowContext = /*#__PURE__*/createContext({\n  approvalState: '',\n  allowedActions: {},\n  refresh: () => {\n    throw new Error('WorkflowContext.refresh has not been initialized');\n  }\n});\nexport { WorkflowContext };","import { createContext } from 'react';\n\nconst defaultFn = () => {\n  throw new Error('Selection Context has not been initialized');\n};\n\nconst SelectionContext = /*#__PURE__*/createContext({\n  workflow: {},\n  period: {},\n  orgUnit: {},\n  selectWorkflow: defaultFn,\n  selectPeriod: defaultFn,\n  selectOrgUnit: defaultFn,\n  clearAll: defaultFn,\n  setOpenedSelect: defaultFn\n});\nexport { SelectionContext };","import { stringify } from 'query-string';\nexport const createHref = state => `/#/?${stringify(state)}`;","import { createHashHistory } from 'history';\nexport const history = createHashHistory();","import { readQueryParams } from '../navigation/index.js';\nimport { parsePeriodId } from '../shared/index.js';\nexport const initialValues = workflows => {\n  const {\n    wf,\n    pe,\n    ou,\n    ouDisplayName\n  } = readQueryParams();\n  const workflow = initialWorkflowValue(workflows, wf);\n  const period = initialPeriodValue(pe, workflow);\n  const orgUnit = initialOrgUnitValue(ou, ouDisplayName);\n  return {\n    workflow,\n    period,\n    orgUnit\n  };\n};\nexport const initialWorkflowValue = (workflows, workflowId) => {\n  if (workflows.length === 1) {\n    // auto-select if user only has one workflow\n    return workflows[0];\n  }\n\n  if (workflowId) {\n    /*\n     * Auto select workflow with query param id\n     * default to empty object if `find` returns undefined in case the\n     * workflow with the id from the url is not available to the user\n     */\n    return workflows.find(workflow => workflow.id === workflowId) || null;\n  }\n\n  return null;\n};\nexport const initialPeriodValue = (periodId, initialWorkflow = {}) => {\n  if (!periodId || !initialWorkflow.id) {\n    return null;\n  }\n\n  return parsePeriodId(periodId, [initialWorkflow.periodType]);\n};\nexport const initialOrgUnitValue = (path, displayName) => {\n  if (!path || !displayName) return null;\n  const [lastPathSegment] = path.match(/[/]?[^/]*$/);\n  const id = lastPathSegment.replace('/', '');\n  return {\n    id,\n    path,\n    displayName\n  };\n};","import { parse } from 'query-string';\nimport { history } from './history.js';\nexport const readQueryParams = () => {\n  const params = parse(history.location.search); // ensure only known params are returned\n\n  return {\n    wf: params.wf,\n    pe: params.pe,\n    ou: params.ou,\n    ouDisplayName: params.ouDisplayName\n  };\n};","import { PropTypes } from '@dhis2/prop-types';\nimport React, { useEffect, useReducer } from 'react';\nimport { useAppContext } from '../app-context/index.js';\nimport { pushStateToHistory } from '../navigation/index.js';\nimport { initialValues, initialWorkflowValue } from './initial-values.js';\nimport { SelectionContext } from './selection-context.js';\nconst ACTIONS = {\n  SET_OPENED_SELECT: 'SET_OPENED_SELECT',\n  CLEAR_ALL: 'CLEAR_ALL',\n  SELECT_WORKFLOW: 'SELECT_WORKFLOW',\n  SELECT_PERIOD: 'SELECT_PERIOD',\n  SELECT_ORG_UNIT: 'SELECT_ORG_UNIT',\n  SET_STATE_FROM_QUERY_PARAMS: 'SET_STATE_FROM_QUERY_PARAMS'\n};\n\nconst reducer = (state, {\n  type,\n  payload\n}) => {\n  var _state$workflow, _payload$workflow, _payload$period;\n\n  switch (type) {\n    case ACTIONS.SET_OPENED_SELECT:\n      return { ...state,\n        openedSelect: payload.openedSelect\n      };\n\n    case ACTIONS.CLEAR_ALL:\n      return {\n        openedSelect: '',\n        workflow: payload.workflow,\n        period: null,\n        orgUnit: null\n      };\n\n    case ACTIONS.SELECT_WORKFLOW:\n      return { ...state,\n        openedSelect: '',\n        workflow: payload.workflow,\n        period: state.workflow && ((_state$workflow = state.workflow) === null || _state$workflow === void 0 ? void 0 : _state$workflow.periodType) === ((_payload$workflow = payload.workflow) === null || _payload$workflow === void 0 ? void 0 : _payload$workflow.periodType) ? state.period : null\n      };\n\n    case ACTIONS.SELECT_PERIOD:\n      return { ...state,\n\n        /*\n         * Close dropdown only if selecting a period,\n         * not when unsetting it when the year changes\n         */\n        openedSelect: (_payload$period = payload.period) !== null && _payload$period !== void 0 && _payload$period.id ? '' : state.openedSelect,\n        period: payload.period\n      };\n\n    case ACTIONS.SELECT_ORG_UNIT:\n      return { ...state,\n        openedSelect: '',\n        orgUnit: payload.orgUnit\n      };\n\n    case ACTIONS.SET_STATE_FROM_QUERY_PARAMS:\n      return {\n        openedSelect: '',\n        ...initialValues(payload.dataApprovalWorkflows)\n      };\n\n    default:\n      return state;\n  }\n};\n\nconst SelectionProvider = ({\n  children\n}) => {\n  const {\n    dataApprovalWorkflows\n  } = useAppContext();\n  const [{\n    openedSelect,\n    workflow,\n    period,\n    orgUnit\n  }, dispatch] = useReducer(reducer, {\n    openedSelect: '',\n    ...initialValues(dataApprovalWorkflows)\n  });\n  const providerValue = {\n    workflow,\n    period,\n    orgUnit,\n    openedSelect,\n    clearAll: () => dispatch({\n      type: ACTIONS.CLEAR_ALL,\n      payload: {\n        workflow: initialWorkflowValue(dataApprovalWorkflows)\n      }\n    }),\n    setOpenedSelect: fieldName => dispatch({\n      type: ACTIONS.SET_OPENED_SELECT,\n      payload: {\n        openedSelect: fieldName\n      }\n    }),\n    selectWorkflow: workflow => dispatch({\n      type: ACTIONS.SELECT_WORKFLOW,\n      payload: {\n        workflow\n      }\n    }),\n    selectPeriod: period => dispatch({\n      type: ACTIONS.SELECT_PERIOD,\n      payload: {\n        period\n      }\n    }),\n    selectOrgUnit: orgUnit => dispatch({\n      type: ACTIONS.SELECT_ORG_UNIT,\n      payload: {\n        orgUnit\n      }\n    })\n  };\n  useEffect(() => {\n    pushStateToHistory({\n      workflow,\n      period,\n      orgUnit\n    });\n  }, [workflow, period, orgUnit]);\n  useEffect(() => {\n    const setStateFromQueryParams = () => {\n      dispatch({\n        type: ACTIONS.SET_STATE_FROM_QUERY_PARAMS,\n        payload: {\n          dataApprovalWorkflows\n        }\n      });\n    };\n\n    window.addEventListener('popstate', setStateFromQueryParams);\n    return () => {\n      window.removeEventListener('popstate', setStateFromQueryParams);\n    };\n  }, []);\n  return /*#__PURE__*/React.createElement(SelectionContext.Provider, {\n    value: providerValue\n  }, children);\n};\n\nSelectionProvider.propTypes = {\n  children: PropTypes.node.isRequired\n};\nexport { SelectionProvider };","import { stringify } from 'query-string';\nimport { history } from './history.js';\nexport const pushStateToHistory = state => {\n  var _state$workflow, _state$period, _state$orgUnit, _state$orgUnit2;\n\n  const paramString = stringify({\n    wf: (_state$workflow = state.workflow) === null || _state$workflow === void 0 ? void 0 : _state$workflow.id,\n    pe: (_state$period = state.period) === null || _state$period === void 0 ? void 0 : _state$period.id,\n    ou: (_state$orgUnit = state.orgUnit) === null || _state$orgUnit === void 0 ? void 0 : _state$orgUnit.path,\n    ouDisplayName: (_state$orgUnit2 = state.orgUnit) === null || _state$orgUnit2 === void 0 ? void 0 : _state$orgUnit2.displayName\n  });\n  const search = paramString ? `?${paramString}` : ''; // Only push if the search string changes\n\n  if (search !== history.location.search) {\n    history.push({\n      pathname: '/',\n      search\n    });\n  }\n};","import { useContext } from 'react';\nimport { SelectionContext } from './selection-context.js';\nexport const useSelectionContext = () => useContext(SelectionContext);","import { useDataQuery } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { PropTypes } from '@dhis2/prop-types';\nimport React, { useEffect } from 'react';\nimport { useSelectionContext } from '../selection-context/index.js';\nimport { ErrorMessage, Loader } from '../shared/index.js';\nimport { WorkflowContext } from './workflow-context.js';\nconst query = {\n  approvalStatus: {\n    resource: 'dataApprovals',\n    params: ({\n      workflow,\n      period,\n      orgUnit\n    }) => ({\n      wf: workflow.id,\n      pe: period.id,\n      ou: orgUnit.id\n    })\n  }\n};\n\nconst WorkflowProvider = ({\n  children\n}) => {\n  const {\n    workflow,\n    period,\n    orgUnit\n  } = useSelectionContext();\n  const {\n    loading,\n    error,\n    data,\n    called,\n    refetch\n  } = useDataQuery(query, {\n    lazy: true\n  });\n  useEffect(() => {\n    if (workflow && period && orgUnit) {\n      refetch({\n        workflow,\n        period,\n        orgUnit\n      });\n    }\n  }, [workflow, period, orgUnit]);\n\n  if (!workflow || !period || !orgUnit) {\n    return null;\n  }\n\n  if (loading || !called) {\n    return /*#__PURE__*/React.createElement(Loader, null);\n  }\n\n  if (error) {\n    return /*#__PURE__*/React.createElement(ErrorMessage, {\n      title: i18n.t('Could not load approval data')\n    }, error.message);\n  }\n\n  const {\n    state: approvalState,\n    ...allowedActions\n  } = data.approvalStatus;\n  return /*#__PURE__*/React.createElement(WorkflowContext.Provider, {\n    value: {\n      approvalState,\n      allowedActions,\n      refresh: refetch,\n      params: {\n        wf: workflow.id,\n        pe: period.id,\n        ou: orgUnit.id\n      }\n    }\n  }, children);\n};\n\nWorkflowProvider.propTypes = {\n  children: PropTypes.node.isRequired\n};\nexport { WorkflowProvider };","import { useContext } from 'react';\nimport { WorkflowContext } from './workflow-context.js';\nexport const useWorkflowContext = () => useContext(WorkflowContext);","import { useDataMutation } from '@dhis2/app-runtime';\nexport const ACCEPT_DATA_MUTATION = {\n  resource: 'dataAcceptances',\n  type: 'create',\n  params: ({\n    wf,\n    pe,\n    ou\n  }) => ({\n    wf,\n    pe,\n    ou\n  })\n};\nexport const useAcceptData = () => useDataMutation(ACCEPT_DATA_MUTATION);","import { useAlert } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { Button } from '@dhis2/ui';\nimport React, { useEffect } from 'react';\nimport { useWorkflowContext } from '../../workflow-context/index.js';\nimport { useAcceptData } from './use-accept-data.js';\n\nconst AcceptButton = () => {\n  const [acceptData, {\n    loading,\n    error\n  }] = useAcceptData();\n  const {\n    params,\n    refresh\n  } = useWorkflowContext();\n  const {\n    show\n  } = useAlert(i18n.t('Acceptance failed: {{error}}', {\n    error: error ? error.toString() : '',\n    nsSeparator: '-:-'\n  }));\n  useEffect(() => {\n    if (error !== null && error !== void 0 && error.message) show();\n  }, [error === null || error === void 0 ? void 0 : error.message]);\n  return /*#__PURE__*/React.createElement(Button, {\n    small: true,\n    disabled: loading,\n    onClick: async () => {\n      const {\n        wf,\n        pe,\n        ou\n      } = params;\n      await acceptData({\n        wf,\n        pe,\n        ou\n      });\n      refresh();\n    }\n  }, i18n.t('Accept'));\n};\n\nexport { AcceptButton };","import i18n from '@dhis2/d2-i18n';\nimport { Button, ButtonStrip, Modal, ModalTitle, ModalContent, ModalActions, NoticeBox } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { useSelectionContext } from '../../../selection-context/index.js';\nimport styles from './approve-modal.module.css';\n\nconst ApproveModal = ({\n  onApprove,\n  onCancel,\n  error\n}) => {\n  const {\n    workflow,\n    period\n  } = useSelectionContext();\n  const {\n    dataSets\n  } = workflow;\n  const count = dataSets.length;\n  return /*#__PURE__*/React.createElement(Modal, null, /*#__PURE__*/React.createElement(ModalTitle, null, count > 1 ? i18n.t('Approving {{count}} data sets', {\n    count\n  }) : i18n.t('Approving {{count}} data set', {\n    count\n  })), /*#__PURE__*/React.createElement(ModalContent, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.summary\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    className: styles.summaryTitle\n  }, count > 1 ? i18n.t('{{count}} data sets for {{- workflow}}, {{period}} will be approved:', {\n    count,\n    workflow: workflow.displayName,\n    period: period.displayName\n  }) : i18n.t('{{count}} data set for {{- workflow}}, {{period}} will be approved:', {\n    count,\n    workflow: workflow.displayName,\n    period: period.displayName\n  })), /*#__PURE__*/React.createElement(\"ul\", {\n    className: styles.summaryList\n  }, dataSets.map(({\n    id,\n    displayName\n  }) => /*#__PURE__*/React.createElement(\"li\", {\n    className: styles.summaryListItem,\n    key: id\n  }, displayName)))), /*#__PURE__*/React.createElement(\"p\", {\n    className: styles.confirmationStatement\n  }, i18n.t('Are you sure you want to approve this data?')), error && /*#__PURE__*/React.createElement(NoticeBox, {\n    error: true,\n    title: i18n.t('There was a problem saving this approval')\n  }, i18n.t('This data couldn’t be approved. Try again, or contact your system administrator.'))), /*#__PURE__*/React.createElement(ModalActions, null, /*#__PURE__*/React.createElement(ButtonStrip, null, /*#__PURE__*/React.createElement(Button, {\n    onClick: onCancel\n  }, i18n.t('Cancel')), /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    onClick: onApprove\n  }, i18n.t('Approve')))));\n};\n\nApproveModal.propTypes = {\n  onApprove: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  error: PropTypes.instanceOf(Error)\n};\nexport { ApproveModal };","import { useDataMutation } from '@dhis2/app-runtime';\nexport const APPROVE_DATA_MUTATION = {\n  resource: 'dataApprovals',\n  type: 'create',\n  params: ({\n    wf,\n    pe,\n    ou\n  }) => ({\n    wf,\n    pe,\n    ou\n  })\n};\nexport const useApproveData = ({\n  onComplete,\n  onError\n}) => useDataMutation(APPROVE_DATA_MUTATION, {\n  onComplete,\n  onError\n});","import { useAlert } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { Button } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { useWorkflowContext } from '../../workflow-context/index.js';\nimport { ApproveModal } from './approve-modal/index.js';\nimport { useApproveData } from './use-approve-data.js';\n\nconst ApproveButton = ({\n  disabled\n}) => {\n  // state\n  const [unexpectedError, setUnexpectedError] = useState(null);\n  const [showApproveModal, setShowApproveModal] = useState(false);\n  const {\n    params,\n    refresh\n  } = useWorkflowContext(); // callbacks\n\n  const showApprovalDialog = () => setShowApproveModal(true);\n\n  const hideApprovalDialog = () => setShowApproveModal(false);\n\n  const onApprove = () => {\n    const {\n      wf,\n      pe,\n      ou\n    } = params;\n    approveData({\n      wf,\n      pe,\n      ou\n    });\n  }; // api\n\n\n  const {\n    show: showApprovalSuccess\n  } = useAlert(i18n.t('Approval saved'));\n  const [approveData, {\n    loading,\n    error: approveError\n  }] = useApproveData({\n    onComplete: () => {\n      showApprovalSuccess();\n      refresh();\n      hideApprovalDialog();\n    },\n    onError: e => setUnexpectedError(e)\n  }); // derived state\n\n  const error = approveError || unexpectedError;\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Button, {\n    primary: true,\n    small: true,\n    disabled: disabled,\n    onClick: showApprovalDialog\n  }, i18n.t('Approve')), showApproveModal && /*#__PURE__*/React.createElement(ApproveModal, {\n    error: error,\n    loading: loading,\n    onApprove: onApprove,\n    onCancel: hideApprovalDialog\n  }));\n};\n\nApproveButton.propTypes = {\n  disabled: PropTypes.bool\n};\nexport { ApproveButton };","import PropTypes from 'prop-types';\nimport React from 'react';\nimport styles from './bottom-bar-item.module.css';\n\nconst BottomBarItem = ({\n  children\n}) => {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.bottomBarItem\n  }, children);\n};\n\nBottomBarItem.propTypes = {\n  children: PropTypes.any.isRequired\n};\nexport { BottomBarItem };","import { useDataMutation } from '@dhis2/app-runtime';\nexport const UNACCEPT_DATA_MUTATION = {\n  resource: 'dataAcceptances',\n  type: 'delete',\n  params: ({\n    wf,\n    pe,\n    ou\n  }) => ({\n    wf,\n    pe,\n    ou\n  })\n};\nexport const useUnacceptData = () => useDataMutation(UNACCEPT_DATA_MUTATION);","import { useAlert } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { Button } from '@dhis2/ui';\nimport React, { useEffect } from 'react';\nimport { useWorkflowContext } from '../../workflow-context/index.js';\nimport { useUnacceptData } from './use-unaccept-data.js';\n\nconst UnacceptButton = () => {\n  const [unacceptData, {\n    loading,\n    error\n  }] = useUnacceptData();\n  const {\n    params,\n    refresh\n  } = useWorkflowContext();\n  const {\n    show\n  } = useAlert(i18n.t('Unacceptance failed: {{error}}', {\n    error: error ? error.toString() : '',\n    nsSeparator: '-:-'\n  }));\n  useEffect(() => {\n    if (error !== null && error !== void 0 && error.message) show();\n  }, [error === null || error === void 0 ? void 0 : error.message]);\n  return /*#__PURE__*/React.createElement(Button, {\n    small: true,\n    disabled: loading,\n    onClick: async () => {\n      const {\n        wf,\n        pe,\n        ou\n      } = params;\n      await unacceptData({\n        wf,\n        pe,\n        ou\n      });\n      refresh();\n    }\n  }, i18n.t('Unaccept'));\n};\n\nexport { UnacceptButton };","import { useDataMutation } from '@dhis2/app-runtime';\nexport const UNAPPROVE_DATA_MUTATION = {\n  resource: 'dataApprovals',\n  type: 'delete',\n  params: ({\n    wf,\n    pe,\n    ou\n  }) => ({\n    wf,\n    pe,\n    ou\n  })\n};\nexport const useUnapproveData = () => useDataMutation(UNAPPROVE_DATA_MUTATION);","import { useAlert } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { Button } from '@dhis2/ui';\nimport React, { useEffect } from 'react';\nimport { useWorkflowContext } from '../../workflow-context/index.js';\nimport { useUnapproveData } from './use-unapprove-data.js';\n\nconst UnapproveButton = () => {\n  const [unapproveData, {\n    loading,\n    error\n  }] = useUnapproveData();\n  const {\n    params,\n    refresh\n  } = useWorkflowContext();\n  const {\n    show\n  } = useAlert(i18n.t('Unapproval failed: {{error}}', {\n    error: error ? error.toString() : '',\n    nsSeparator: '-:-'\n  }));\n  useEffect(() => {\n    if (error !== null && error !== void 0 && error.message) show();\n  }, [error === null || error === void 0 ? void 0 : error.message]);\n  return /*#__PURE__*/React.createElement(Button, {\n    small: true,\n    disabled: loading,\n    onClick: async () => {\n      const {\n        wf,\n        pe,\n        ou\n      } = params;\n      await unapproveData({\n        wf,\n        pe,\n        ou\n      });\n      refresh();\n    }\n  }, i18n.t('Unapprove'));\n};\n\nexport { UnapproveButton };","import React from 'react';\nimport { StatusTag } from '../shared/index.js';\nimport { useWorkflowContext } from '../workflow-context/index.js';\nimport { AcceptButton } from './accept-button/index.js';\nimport { ApproveButton } from './approve-button/index.js';\nimport { BottomBarItem } from './bottom-bar-item.js';\nimport styles from './bottom-bar.module.css';\nimport { UnacceptButton } from './unaccept-button/index.js';\nimport { UnapproveButton } from './unapprove-button/index.js';\n\nconst BottomBar = () => {\n  const {\n    allowedActions,\n    approvalState\n  } = useWorkflowContext();\n  const {\n    mayAccept,\n    mayApprove,\n    mayUnaccept,\n    mayUnapprove\n  } = allowedActions;\n  const disableApproveBtn = !mayApprove && !mayUnapprove;\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.bottomBar\n  }, /*#__PURE__*/React.createElement(BottomBarItem, null, /*#__PURE__*/React.createElement(StatusTag, {\n    approvalState: approvalState\n  })), (mayApprove || disableApproveBtn) && /*#__PURE__*/React.createElement(BottomBarItem, null, /*#__PURE__*/React.createElement(ApproveButton, {\n    disabled: disableApproveBtn\n  })), mayAccept && /*#__PURE__*/React.createElement(BottomBarItem, null, /*#__PURE__*/React.createElement(AcceptButton, null)), mayUnapprove && /*#__PURE__*/React.createElement(BottomBarItem, null, /*#__PURE__*/React.createElement(UnapproveButton, null)), mayUnaccept && /*#__PURE__*/React.createElement(BottomBarItem, null, /*#__PURE__*/React.createElement(UnacceptButton, null))));\n};\n\nexport { BottomBar };","import { TabBar, Tab } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { useSelectionContext } from '../../selection-context/index.js';\n\nconst DataSetNavigation = ({\n  selected,\n  onChange\n}) => {\n  const {\n    workflow\n  } = useSelectionContext();\n  const {\n    dataSets\n  } = workflow;\n  return /*#__PURE__*/React.createElement(TabBar, {\n    scrollable: true\n  }, dataSets.map(dataSet => /*#__PURE__*/React.createElement(Tab, {\n    key: dataSet.id,\n    onClick: () => onChange(dataSet.id),\n    selected: dataSet.id === selected\n  }, dataSet.displayName)));\n};\n\nDataSetNavigation.propTypes = {\n  onChange: PropTypes.func.isRequired,\n  selected: PropTypes.string\n};\nexport { DataSetNavigation };","import { DataTableToolbar, DataTable, TableHead, DataTableRow, DataTableColumnHeader, TableBody, DataTableCell } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nconst Table = ({\n  title,\n  columns,\n  rows\n}) => /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(DataTableToolbar, null, title), /*#__PURE__*/React.createElement(DataTable, null, /*#__PURE__*/React.createElement(TableHead, null, /*#__PURE__*/React.createElement(DataTableRow, null, columns.map(column => /*#__PURE__*/React.createElement(DataTableColumnHeader, {\n  key: column\n}, column)))), /*#__PURE__*/React.createElement(TableBody, null, rows.map((row, index) => /*#__PURE__*/React.createElement(DataTableRow, {\n  key: index\n}, row.map((value, index) => /*#__PURE__*/React.createElement(DataTableCell, {\n  key: index\n}, value)))))));\n\nTable.propTypes = {\n  columns: PropTypes.array.isRequired,\n  rows: PropTypes.array.isRequired,\n  title: PropTypes.string.isRequired\n};\nexport { Table };","import { useDataQuery } from '@dhis2/app-runtime';\nimport i18n from '@dhis2/d2-i18n';\nimport { NoticeBox, CircularLoader } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useEffect } from 'react';\nimport { useSelectionContext } from '../../selection-context/index.js';\nimport { getFixedPeriodsForTypeAndDateRange } from '../../shared/index.js';\nimport styles from './display.module.css';\nimport { Table } from './table.js';\nconst query = {\n  dataSetReport: {\n    resource: 'dataSetReport',\n    params: ({\n      dataSetId,\n      periodIds,\n      orgUnit\n    }) => ({\n      // arrays are being handled by the app runtime\n      pe: periodIds,\n      ds: dataSetId,\n      ou: orgUnit.id\n    })\n  }\n};\n\nconst Display = ({\n  dataSetId\n}) => {\n  const selection = useSelectionContext();\n  const {\n    orgUnit,\n    workflow,\n    period\n  } = selection;\n  const {\n    dataSets\n  } = workflow;\n  const selectedDataSet = dataSets.find(({\n    id\n  }) => id === dataSetId);\n  const periodIds = selectedDataSet ? getFixedPeriodsForTypeAndDateRange(selectedDataSet.periodType, period.startDate, period.endDate).map(({\n    id\n  }) => id) : [];\n  const {\n    called,\n    loading,\n    data,\n    error,\n    refetch\n  } = useDataQuery(query, {\n    lazy: true\n  });\n  const tables = data === null || data === void 0 ? void 0 : data.dataSetReport;\n\n  const fetchDataSet = () => refetch({\n    periodIds,\n    dataSetId,\n    orgUnit\n  });\n\n  useEffect(() => {\n    if (periodIds.length && dataSetId) {\n      fetchDataSet();\n    }\n  }, // joining so this produces a primitive value\n  [periodIds.join(','), dataSetId]);\n\n  if (!dataSetId) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.chooseDataSet\n    }, /*#__PURE__*/React.createElement(\"h2\", null, i18n.t('Choose a data set to review')), /*#__PURE__*/React.createElement(\"p\", null, i18n.t('{{- workflowName}} has multiple data sets. Choose a data set from the tabs above.', {\n      workflowName: workflow.displayName\n    })));\n  }\n\n  if (!called && periodIds.length || loading) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.display\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.loadingWrapper\n    }, /*#__PURE__*/React.createElement(CircularLoader, {\n      small: true\n    }), i18n.t('Loading data set')));\n  }\n\n  if (error) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.display\n    }, /*#__PURE__*/React.createElement(NoticeBox, {\n      error: true,\n      title: i18n.t('There was a problem displaying this data set')\n    }, /*#__PURE__*/React.createElement(\"p\", null, i18n.t(`This data set couldn't be loaded or displayed. Try again, or contact your system administrator.`)), /*#__PURE__*/React.createElement(\"button\", {\n      className: styles.retryButton,\n      onClick: fetchDataSet\n    }, i18n.t('Retry loading data set'))));\n  }\n\n  if (!periodIds.length || !tables.length) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.noData\n    }, /*#__PURE__*/React.createElement(\"p\", null, i18n.t(`This data set doesn't have any data for {{- period}} in {{- orgUnit}}.`, {\n      period: period.displayName,\n      orgUnit: orgUnit.displayName\n    })));\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.display\n  }, tables.map(table => /*#__PURE__*/React.createElement(Table, {\n    key: table.title,\n    title: table.title,\n    columns: table.headers.map(h => h.name),\n    rows: table.rows\n  })));\n};\n\nDisplay.propTypes = {\n  dataSetId: PropTypes.string\n};\nexport { Display };","import i18n from '@dhis2/d2-i18n';\nimport { IconDimensionDataSet16 } from '@dhis2/ui';\nimport React from 'react';\nimport { useSelectionContext } from '../../selection-context/index.js';\nimport { StatusTag } from '../../shared/approval-state/index.js';\nimport { useWorkflowContext } from '../../workflow-context/index.js';\nimport styles from './title-bar.module.css';\n\nconst TitleBar = () => {\n  const {\n    approvalState\n  } = useWorkflowContext();\n  const {\n    workflow\n  } = useSelectionContext();\n  const {\n    dataSets,\n    displayName: name\n  } = workflow;\n  const dataSetsCount = dataSets.length;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.titleBar\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: styles.workflowName\n  }, name), /*#__PURE__*/React.createElement(\"span\", {\n    className: styles.workflowDataSetsCount\n  }, /*#__PURE__*/React.createElement(IconDimensionDataSet16, null), dataSetsCount === 1 && i18n.t('1 data set', {\n    dataSetsCount\n  }), dataSetsCount !== 1 && i18n.t('{{dataSetsCount}} data sets', {\n    dataSetsCount\n  })), /*#__PURE__*/React.createElement(StatusTag, {\n    approvalState: approvalState\n  }));\n};\n\nexport { TitleBar };","import React, { useState } from 'react';\nimport { useSelectionContext } from '../selection-context/index.js';\nimport { DataSetNavigation } from './data-set-navigation/index.js';\nimport { Display } from './display/index.js';\nimport { TitleBar } from './title-bar/index.js';\n\nconst DataWorkspace = () => {\n  const {\n    workflow\n  } = useSelectionContext();\n  const [selectedDataSet, setSelectedDataSet] = useState(workflow.dataSets.length === 1 ? workflow.dataSets[0].id : null);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(TitleBar, null), /*#__PURE__*/React.createElement(DataSetNavigation, {\n    selected: selectedDataSet,\n    onChange: setSelectedDataSet\n  }), /*#__PURE__*/React.createElement(Display, {\n    dataSetId: selectedDataSet\n  }));\n};\n\nexport { DataWorkspace };","import i18n from '@dhis2/d2-i18n';\nimport { Button } from '@dhis2/ui';\nimport React from 'react';\nimport { useSelectionContext } from '../../selection-context/index.js';\nimport classes from './clear-all-button.module.css';\n\nconst ClearAllButton = () => {\n  const {\n    clearAll,\n    period,\n    orgUnit\n  } = useSelectionContext();\n  return period !== null && period !== void 0 && period.id || orgUnit !== null && orgUnit !== void 0 && orgUnit.path ? /*#__PURE__*/React.createElement(Button, {\n    className: classes.button,\n    secondary: true,\n    onClick: clearAll\n  }, i18n.t('Clear selections')) : null;\n};\n\nexport { ClearAllButton };","import { useDataEngine } from '@dhis2/app-runtime';\nimport PropTypes from 'prop-types';\nimport React, { createContext, useContext, useRef, useState } from 'react';\nimport { useDebouncedCallback } from 'use-debounce';\nconst ApprovalStatusesContext = /*#__PURE__*/createContext();\n\nconst useApprovalStatusesContext = () => useContext(ApprovalStatusesContext);\n\nclass ApprovalStatusesMap {\n  constructor(map) {\n    this._map = map || new Map();\n  }\n\n  _serialiseKey({\n    workflowId,\n    periodId,\n    orgUnitId\n  }) {\n    return `${workflowId}-${periodId}-${orgUnitId}`;\n  }\n\n  set(key, status) {\n    this._map.set(this._serialiseKey(key), status);\n  }\n\n  get(key) {\n    return this._map.get(this._serialiseKey(key));\n  }\n\n  clone() {\n    return new ApprovalStatusesMap(new Map(this._map));\n  }\n\n}\n\nconst useFetchApprovalStatus = ({\n  updateApprovalStatuses\n}) => {\n  const engine = useDataEngine();\n  const requestQueue = useRef([]);\n  const fetchApprovalStatuses = useDebouncedCallback(() => {\n    const batchedQueries = [];\n    requestQueue.current.forEach(query => {\n      const existingBatchedQuery = batchedQueries.find(({\n        workflowId,\n        periodId\n      }) => {\n        return workflowId === query.workflowId && periodId === query.periodId;\n      });\n\n      if (existingBatchedQuery) {\n        existingBatchedQuery.orgUnitIds.push(query.orgUnitId);\n      } else {\n        batchedQueries.push({\n          workflowId: query.workflowId,\n          periodId: query.periodId,\n          orgUnitIds: [query.orgUnitId]\n        });\n      }\n    });\n    requestQueue.current = [];\n    batchedQueries.forEach(async ({\n      workflowId,\n      periodId,\n      orgUnitIds\n    }) => {\n      updateApprovalStatuses({\n        periodId,\n        workflowId,\n        approvalStatusUpdates: orgUnitIds.reduce((statuses, orgUnitId) => {\n          statuses[orgUnitId] = 'LOADING';\n          return statuses;\n        }, {})\n      });\n      const updateObject = {};\n\n      try {\n        const {\n          approvalStatuses\n        } = await engine.query({\n          approvalStatuses: {\n            resource: 'dataApprovals/approvals',\n            params: {\n              wf: workflowId,\n              pe: periodId,\n              ou: orgUnitIds\n            }\n          }\n        });\n        approvalStatuses.forEach(({\n          ou,\n          state\n        }) => {\n          updateObject[ou] = state;\n        });\n      } catch (error) {\n        orgUnitIds.forEach(orgUnitId => {\n          updateObject[orgUnitId] = 'FETCH_ERROR';\n        });\n      }\n\n      updateApprovalStatuses({\n        periodId,\n        workflowId,\n        approvalStatusUpdates: updateObject\n      });\n    });\n  }, 10);\n  return ({\n    workflowId,\n    periodId,\n    orgUnitId\n  }) => {\n    requestQueue.current.push({\n      periodId,\n      workflowId,\n      orgUnitId\n    });\n    fetchApprovalStatuses();\n  };\n};\n\nexport const ApprovalStatusesProvider = ({\n  children\n}) => {\n  const [approvalStatuses, setApprovalStatuses] = useState(new ApprovalStatusesMap());\n\n  const updateApprovalStatuses = ({\n    workflowId,\n    periodId,\n    approvalStatusUpdates\n  }) => {\n    setApprovalStatuses(approvalStatuses => {\n      const newApprovalStatuses = approvalStatuses.clone();\n\n      for (const [orgUnitId, status] of Object.entries(approvalStatusUpdates)) {\n        newApprovalStatuses.set({\n          workflowId,\n          periodId,\n          orgUnitId\n        }, status);\n      }\n\n      return newApprovalStatuses;\n    });\n  };\n\n  const fetchApprovalStatus = useFetchApprovalStatus({\n    updateApprovalStatuses\n  });\n  return /*#__PURE__*/React.createElement(ApprovalStatusesContext.Provider, {\n    value: {\n      approvalStatuses,\n      fetchApprovalStatus\n    }\n  }, children);\n};\nApprovalStatusesProvider.propTypes = {\n  children: PropTypes.node\n};\nexport const useApprovalStatus = () => {\n  const {\n    approvalStatuses,\n    fetchApprovalStatus\n  } = useApprovalStatusesContext();\n  return {\n    getApprovalStatus: ({\n      workflowId,\n      periodId,\n      orgUnitId\n    }) => {\n      return approvalStatuses.get({\n        workflowId,\n        periodId,\n        orgUnitId\n      });\n    },\n    fetchApprovalStatus\n  };\n};","import { IconChevronDown24, IconChevronUp24, colors, Popover, Tooltip } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useRef } from 'react';\nimport classes from './context-select.module.css';\n\nconst ContextSelect = ({\n  children,\n  prefix,\n  placeholder,\n  value,\n  onClose,\n  onOpen,\n  disabled,\n  open,\n  requiredValuesMessage\n}) => {\n  const buttonRef = useRef();\n  const Icon = open ? IconChevronUp24 : IconChevronDown24;\n  const button = /*#__PURE__*/React.createElement(\"button\", {\n    ref: buttonRef,\n    className: classes.button,\n    onClick: onOpen,\n    disabled: disabled\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: classes.prefix\n  }, prefix), /*#__PURE__*/React.createElement(\"span\", {\n    className: classes.value\n  }, value || !disabled && placeholder), /*#__PURE__*/React.createElement(Icon, {\n    color: disabled ? colors.grey600 : undefined\n  }));\n  return /*#__PURE__*/React.createElement(React.Fragment, null, disabled ? /*#__PURE__*/React.createElement(Tooltip, {\n    content: requiredValuesMessage,\n    placement: \"bottom\"\n  }, ({\n    ref,\n    onMouseOver,\n    onMouseOut\n  }) => /*#__PURE__*/React.createElement(\"div\", {\n    ref: ref,\n    onMouseOver: onMouseOver,\n    onMouseOut: onMouseOut,\n    className: classes.tooltipwrap\n  }, button)) : button, open && /*#__PURE__*/React.createElement(Popover, {\n    reference: buttonRef,\n    arrow: false,\n    placement: \"bottom-end\",\n    onClickOutside: onClose\n  }, children));\n};\n\nContextSelect.propTypes = {\n  children: PropTypes.node.isRequired,\n  placeholder: PropTypes.string.isRequired,\n  prefix: PropTypes.string.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onOpen: PropTypes.func.isRequired,\n  disabled: PropTypes.bool,\n  open: PropTypes.bool,\n  requiredValuesMessage: PropTypes.string,\n  value: PropTypes.string\n};\nexport { ContextSelect };","import PropTypes from 'prop-types';\nimport React, { useEffect } from 'react';\nimport { useSelectionContext } from '../../selection-context/index.js';\nimport { getApprovalStateDisplayData } from '../../shared/approval-state/index.js';\nimport classes from './approval-status-label.module.css';\nimport { useApprovalStatus } from './approval-statuses.js';\n\nconst ApprovalStatusLabel = ({\n  label,\n  orgUnitId\n}) => {\n  const {\n    workflow,\n    period\n  } = useSelectionContext();\n  const {\n    getApprovalStatus,\n    fetchApprovalStatus\n  } = useApprovalStatus();\n  const approvalStatus = getApprovalStatus({\n    workflowId: workflow.id,\n    periodId: period.id,\n    orgUnitId\n  });\n  useEffect(() => {\n    fetchApprovalStatus({\n      periodId: period.id,\n      workflowId: workflow.id,\n      orgUnitId\n    });\n  }, []);\n\n  if (approvalStatus === 'LOADING') {\n    return label;\n  } else if (approvalStatus === 'FETCH_ERROR') {\n    return label;\n  } else if (approvalStatus) {\n    const {\n      displayName,\n      icon: Icon\n    } = getApprovalStateDisplayData(approvalStatus);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.container\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      title: displayName,\n      className: classes.iconContainer\n    }, /*#__PURE__*/React.createElement(Icon, null)), label);\n  }\n\n  return label;\n};\n\nApprovalStatusLabel.propTypes = {\n  label: PropTypes.string.isRequired,\n  orgUnitId: PropTypes.string.isRequired\n};\nexport { ApprovalStatusLabel };","import i18n from '@dhis2/d2-i18n';\nimport { OrganisationUnitTree } from '@dhis2/ui';\nimport React from 'react';\nimport { useAppContext } from '../../app-context/index.js';\nimport { useSelectionContext } from '../../selection-context/index.js';\nimport { ContextSelect } from '../context-select/index.js';\nimport { ApprovalStatusLabel } from './approval-status-label.js';\nimport classes from './org-unit-select.module.css';\nexport const ORG_UNIT = 'ORG_UNIT';\n\nconst OrgUnitSelect = () => {\n  const {\n    organisationUnits\n  } = useAppContext();\n  const {\n    orgUnit,\n    selectOrgUnit,\n    workflow,\n    period,\n    openedSelect,\n    setOpenedSelect\n  } = useSelectionContext();\n  const open = openedSelect === ORG_UNIT;\n  const value = orgUnit === null || orgUnit === void 0 ? void 0 : orgUnit.displayName;\n  const requiredValuesMessage = workflow !== null && workflow !== void 0 && workflow.id ? i18n.t('Choose a period first') : i18n.t('Choose a workflow and period first');\n  const roots = organisationUnits.map(({\n    id\n  }) => id);\n\n  const onChange = ({\n    displayName,\n    id,\n    path\n  }) => {\n    selectOrgUnit({\n      displayName,\n      id,\n      path\n    });\n  };\n\n  const selectedOrgUnitPath = orgUnit !== null && orgUnit !== void 0 && orgUnit.path ? [orgUnit.path] : undefined;\n  return /*#__PURE__*/React.createElement(ContextSelect, {\n    prefix: i18n.t('Organisation Unit'),\n    placeholder: i18n.t('Choose an organisation unit'),\n    value: value,\n    open: open,\n    disabled: !(workflow !== null && workflow !== void 0 && workflow.id && period !== null && period !== void 0 && period.id),\n    onOpen: () => setOpenedSelect(ORG_UNIT),\n    onClose: () => setOpenedSelect(''),\n    requiredValuesMessage: requiredValuesMessage\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.scrollbox\n  }, /*#__PURE__*/React.createElement(OrganisationUnitTree, {\n    roots: roots,\n    onChange: onChange,\n    initiallyExpanded: selectedOrgUnitPath,\n    selected: selectedOrgUnitPath,\n    singleSelection: true,\n    renderNodeLabel: ({\n      label,\n      node\n    }) => /*#__PURE__*/React.createElement(ApprovalStatusLabel, {\n      label: label,\n      orgUnitId: node.id\n    })\n  })));\n};\n\nexport { OrgUnitSelect };","import { Menu, MenuItem } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { createHref } from '../../navigation/index.js';\nimport { useSelectionContext } from '../../selection-context/index.js';\nimport { getFixedPeriodsByTypeAndYear } from '../../shared/index.js';\nimport classes from './period-menu.module.css';\n\nconst PeriodMenu = ({\n  periodType,\n  year\n}) => {\n  const {\n    workflow,\n    period: selectedPeriod,\n    orgUnit,\n    selectPeriod\n  } = useSelectionContext();\n  const periods = getFixedPeriodsByTypeAndYear(periodType, year);\n  return /*#__PURE__*/React.createElement(Menu, {\n    dense: true,\n    className: classes.menu\n  }, periods.map(period => /*#__PURE__*/React.createElement(MenuItem, {\n    active: period.id === (selectedPeriod === null || selectedPeriod === void 0 ? void 0 : selectedPeriod.id),\n    key: period.id,\n    href: createHref({\n      wf: workflow === null || workflow === void 0 ? void 0 : workflow.id,\n      ou: orgUnit === null || orgUnit === void 0 ? void 0 : orgUnit.path,\n      pe: period.id\n    }),\n    label: period.displayName,\n    onClick: () => selectPeriod(period)\n  })));\n};\n\nPeriodMenu.propTypes = {\n  periodType: PropTypes.string,\n  year: PropTypes.number\n};\nexport { PeriodMenu };","import { Button, IconArrowRight24, IconArrowLeft24 } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport classes from './year-navigator.module.css';\nexport const currentYear = new Date().getFullYear(); // To avoid users from navigating too far back\n\nconst startYear = 1970;\n\nconst YearNavigator = ({\n  year,\n  onYearChange\n}) => /*#__PURE__*/React.createElement(\"div\", {\n  className: classes.container\n}, /*#__PURE__*/React.createElement(Button, {\n  disabled: year === startYear,\n  onClick: () => onYearChange(year - 1),\n  icon: /*#__PURE__*/React.createElement(IconArrowLeft24, null)\n}), /*#__PURE__*/React.createElement(\"span\", {\n  className: classes.year\n}, year), /*#__PURE__*/React.createElement(Button, {\n  disabled: year === currentYear,\n  onClick: () => onYearChange(year + 1),\n  icon: /*#__PURE__*/React.createElement(IconArrowRight24, null)\n}));\n\nYearNavigator.propTypes = {\n  year: PropTypes.number.isRequired,\n  onYearChange: PropTypes.func\n};\nexport { YearNavigator };","import i18n from '@dhis2/d2-i18n';\nimport React, { useEffect, useState } from 'react';\nimport { useSelectionContext } from '../../selection-context/index.js';\nimport { ContextSelect } from '../context-select/index.js';\nimport { PeriodMenu } from './period-menu.js';\nimport { YearNavigator, currentYear } from './year-navigator.js';\nexport const PERIOD = 'PERIOD';\n\nconst PeriodSelect = () => {\n  const {\n    period,\n    workflow,\n    selectPeriod,\n    openedSelect,\n    setOpenedSelect\n  } = useSelectionContext();\n  const [year, setYear] = useState((period === null || period === void 0 ? void 0 : period.year) || currentYear);\n  const open = openedSelect === PERIOD;\n  const value = period === null || period === void 0 ? void 0 : period.displayName;\n  useEffect(() => {\n    if (period !== null && period !== void 0 && period.year) {\n      setYear(period.year);\n    }\n  }, [period === null || period === void 0 ? void 0 : period.year]);\n  return /*#__PURE__*/React.createElement(ContextSelect, {\n    prefix: i18n.t('Period'),\n    placeholder: i18n.t('Choose a period'),\n    value: value,\n    open: open,\n    disabled: !(workflow !== null && workflow !== void 0 && workflow.id),\n    onOpen: () => setOpenedSelect(PERIOD),\n    onClose: () => setOpenedSelect(''),\n    requiredValuesMessage: i18n.t('Choose a workflow first')\n  }, /*#__PURE__*/React.createElement(YearNavigator, {\n    year: year,\n    onYearChange: year => {\n      selectPeriod(null);\n      setYear(year);\n    }\n  }), /*#__PURE__*/React.createElement(PeriodMenu, {\n    periodType: workflow === null || workflow === void 0 ? void 0 : workflow.periodType,\n    year: year\n  }));\n};\n\nexport { PeriodSelect };","import { MenuItem } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { createHref } from '../../navigation/index.js';\nimport classes from './workflow-select-option.module.css';\n\nconst WorkflowSelectOption = ({\n  id,\n  name,\n  periodType,\n  active,\n  onClick\n}) => {\n  const label = /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.option\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: classes.title\n  }, name), /*#__PURE__*/React.createElement(\"span\", {\n    className: classes.subtitle\n  }, periodType || 'UNAVAILABLE'));\n  return /*#__PURE__*/React.createElement(MenuItem, {\n    href: createHref({\n      wf: id\n    }),\n    className: classes.bordered,\n    active: active,\n    onClick: onClick,\n    label: label\n  });\n};\n\nWorkflowSelectOption.propTypes = {\n  id: PropTypes.string.isRequired,\n  name: PropTypes.string.isRequired,\n  active: PropTypes.bool,\n  periodType: PropTypes.string,\n  onClick: PropTypes.func\n};\nexport { WorkflowSelectOption };","import i18n from '@dhis2/d2-i18n';\nimport { Menu } from '@dhis2/ui';\nimport React from 'react';\nimport { useAppContext } from '../../app-context/index.js';\nimport { useSelectionContext } from '../../selection-context/index.js';\nimport { ContextSelect } from '../context-select/index.js';\nimport { WorkflowSelectOption } from './workflow-select-option.js';\nimport classes from './workflow-select.module.css';\nconst WORKFLOW = 'WORKFLOW';\n\nconst WorkflowSelect = () => {\n  const {\n    dataApprovalWorkflows\n  } = useAppContext();\n  const {\n    workflow: selectedWorkflow,\n    selectWorkflow,\n    openedSelect,\n    setOpenedSelect\n  } = useSelectionContext();\n  const open = openedSelect === WORKFLOW;\n  const value = selectedWorkflow === null || selectedWorkflow === void 0 ? void 0 : selectedWorkflow.displayName;\n  return /*#__PURE__*/React.createElement(ContextSelect, {\n    prefix: i18n.t('Workflow'),\n    placeholder: i18n.t('Choose a workflow'),\n    value: value,\n    open: open,\n    onOpen: () => setOpenedSelect(WORKFLOW),\n    onClose: () => setOpenedSelect('')\n  }, dataApprovalWorkflows.length === 0 ? /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.message\n  }, i18n.t('No workflows found. None may exist, or you may not have access to any.')) : /*#__PURE__*/React.createElement(Menu, null, dataApprovalWorkflows.map(workflow => /*#__PURE__*/React.createElement(WorkflowSelectOption, {\n    key: workflow.id,\n    id: workflow.id,\n    name: workflow.displayName,\n    periodType: workflow.periodType,\n    active: workflow.id === (selectedWorkflow === null || selectedWorkflow === void 0 ? void 0 : selectedWorkflow.id),\n    onClick: () => selectWorkflow(workflow)\n  }))));\n};\n\nexport { WorkflowSelect, WORKFLOW };","import React from 'react';\nimport { ClearAllButton } from './clear-all-button/index.js';\nimport { ApprovalStatusesProvider } from './org-unit-select/approval-statuses.js';\nimport { OrgUnitSelect } from './org-unit-select/index.js';\nimport { PeriodSelect } from './period-select/index.js';\nimport { WorkflowSelect } from './workflow-select/index.js';\n\nconst TopBar = () => /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(WorkflowSelect, null), /*#__PURE__*/React.createElement(PeriodSelect, null), /*#__PURE__*/React.createElement(ApprovalStatusesProvider, null, /*#__PURE__*/React.createElement(OrgUnitSelect, null)), /*#__PURE__*/React.createElement(ClearAllButton, null));\n\nexport { TopBar };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport classes from './layout.module.css';\n\nconst LayoutSection = ({\n  children,\n  className\n}) => /*#__PURE__*/React.createElement(\"div\", {\n  className: className\n}, children);\n\nLayoutSection.propTypes = {\n  children: PropTypes.node,\n  className: PropTypes.string\n};\n\nconst Container = props => /*#__PURE__*/React.createElement(LayoutSection, _extends({}, props, {\n  className: classes.container\n}));\n\nconst Top = props => /*#__PURE__*/React.createElement(LayoutSection, _extends({}, props, {\n  className: classes.top\n}));\n\nconst Content = props => /*#__PURE__*/React.createElement(LayoutSection, _extends({}, props, {\n  className: classes.content\n}));\n\nconst Bottom = props => /*#__PURE__*/React.createElement(LayoutSection, _extends({}, props, {\n  className: classes.bottom\n}));\n\nexport const Layout = {\n  Container,\n  Top,\n  Content,\n  Bottom\n};","//------------------------------------------------------------------------------\n// <auto-generated>\n// This code was generated by d2-i18n-generate.\n//\n// Changes to this file may cause incorrect behavior and will be lost if\n// the code is regenerated.\n// </auto-generated>\n//------------------------------------------------------------------------------\nimport i18n from '@dhis2/d2-i18n';\nimport enTranslations from './en/translations.json';\nconst namespace = 'default';\ni18n.addResources('en', namespace, enTranslations);\nexport default i18n;","import { App } from './app.js';\nimport '../locales/index.js';\nexport default App;","import { CssVariables } from '@dhis2/ui';\nimport React from 'react';\nimport { AppProvider } from '../app-context/index.js';\nimport { AuthWall } from '../auth/index.js';\nimport { BottomBar } from '../bottom-bar/index.js';\nimport { DataWorkspace } from '../data-workspace/index.js';\nimport { SelectionProvider } from '../selection-context/index.js';\nimport { TopBar } from '../top-bar/index.js';\nimport { WorkflowProvider } from '../workflow-context/index.js';\nimport { Layout } from './layout.js';\n\nconst App = () => /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(CssVariables, {\n  spacers: true,\n  colors: true,\n  theme: true\n}), /*#__PURE__*/React.createElement(AppProvider, null, /*#__PURE__*/React.createElement(AuthWall, null, /*#__PURE__*/React.createElement(SelectionProvider, null, /*#__PURE__*/React.createElement(Layout.Container, null, /*#__PURE__*/React.createElement(Layout.Top, null, /*#__PURE__*/React.createElement(TopBar, null)), /*#__PURE__*/React.createElement(WorkflowProvider, null, /*#__PURE__*/React.createElement(Layout.Content, null, /*#__PURE__*/React.createElement(DataWorkspace, null)), /*#__PURE__*/React.createElement(Layout.Bottom, null, /*#__PURE__*/React.createElement(BottomBar, null))))))));\n\nexport { App };"],"sourceRoot":""}