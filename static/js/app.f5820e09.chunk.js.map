{"version":3,"sources":["D2App/auth/auth-wall.module.css","D2App/top-bar/clear-all-button/clear-all-button.module.css","D2App/top-bar/context-select/context-select.module.css","D2App/top-bar/workflow-select/workflow-select-option.module.css","D2App/top-bar/workflow-select/workflow-select.module.css","D2App/app/layout.module.css","D2App/current-user/current-user-context.js","D2App/current-user/current-user-provider.js","D2App/current-user/use-current-user.js","D2App/auth/auth-wall.js","D2App/auth/use-is-authorized.js","D2App/bottom-bar/bottom-bar.js","D2App/data-workspace/data-workspace.js","D2App/top-bar/selection/selection-context.js","D2App/top-bar/selection/selection-provider.js","D2App/top-bar/selection/use-selection.js","D2App/top-bar/clear-all-button/clear-all-button.js","D2App/top-bar/context-select/context-select.js","D2App/top-bar/org-unit-select/org-unit-select.js","D2App/top-bar/period-select/period-select.js","D2App/top-bar/workflow-select/workflow-select-option.js","D2App/top-bar/workflow-select/workflow-select.js","D2App/top-bar/top-bar.js","D2App/app/layout.js","D2App/app/index.js","D2App/app/app.js"],"names":["module","exports","CurrentUserContext","createContext","meQuery","me","resource","params","fields","dataApprovalWorkflowsQuery","dataApprovalWorkflows","id","CurrentUserProvider","children","data","workflowsData","loading","workflowsLoading","error","workflowsError","refetch","refetchWorkflows","called","workflowsCalled","useDataQuery","lazy","meData","meLoading","meError","onComplete","React","createElement","Layer","CenteredContent","CircularLoader","Provider","value","useCurrentUser","useContext","AuthWall","authorities","some","authority","useIsAuthorized","className","classes","wrapper","NoticeBox","title","i18n","t","BottomBar","DataWorkspace","noop","SelectionContext","workflow","setWorkflow","period","setPeriod","orgUnit","setOrgUnit","initialWorkflowValue","workflows","find","length","ACTIONS","reducer","state","type","payload","openedSelect","SelectionProvider","query","setQuery","useQueryParams","wf","StringParam","pe","ou","dispatch","useReducer","code","name","providerValue","clearAll","setOpenedSelect","fieldName","selectWorkflow","selectPeriod","selectOrgUnit","useEffect","useSelection","ClearAllButton","Button","button","secondary","onClick","ContextSelect","label","onClose","onOpen","disabled","open","ref","useRef","Icon","IconChevronUp24","IconChevronDown24","Fragment","prefix","color","colors","grey600","undefined","Popover","reference","arrow","placement","onClickOutside","ORG_UNIT","OrgUnitSelect","PERIOD","PeriodSelect","WorkflowSelectOption","periodType","active","option","subtitle","MenuItem","bordered","WORKFLOW","WorkflowSelect","selectedWorkflow","message","Menu","map","key","TopBar","_extends","Object","assign","target","i","arguments","source","prototype","hasOwnProperty","call","apply","this","LayoutSection","Layout","props","container","top","content","bottom","App","QueryParamProvider","CssVariables","spacers","theme"],"mappings":"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","file":"static/js/app.f5820e09.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"auth-wall_wrapper__2MmQe\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"clear-all-button_button__mDEHm\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"context-select_button__1y8va\",\"prefix\":\"context-select_prefix__3xDFu\",\"value\":\"context-select_value__oltZj\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bordered\":\"workflow-select-option_bordered__JBAIX\",\"option\":\"workflow-select-option_option__1cqTS\",\"title\":\"workflow-select-option_title__3zrtv\",\"subtitle\":\"workflow-select-option_subtitle__3yrup\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"message\":\"workflow-select_message__1jq5N\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"layout_container__Cp-96\",\"top\":\"layout_top__2gcI9\",\"content\":\"layout_content__10QOH\",\"bottom\":\"layout_bottom__2toTd\"};","import { createContext } from 'react';\nconst CurrentUserContext = /*#__PURE__*/createContext({});\nexport { CurrentUserContext };","import { useDataQuery } from '@dhis2/app-runtime';\nimport { PropTypes } from '@dhis2/prop-types';\nimport { CircularLoader, Layer, CenteredContent } from '@dhis2/ui';\nimport React from 'react';\nimport { CurrentUserContext } from './current-user-context.js';\nconst meQuery = {\n  me: {\n    resource: 'me',\n    params: {\n      fields: ['id', 'authorities', 'programs', 'dataSets', 'userGroups', 'organisationUnits', 'dataViewOrganisationUnits']\n    }\n  }\n};\nconst dataApprovalWorkflowsQuery = {\n  dataApprovalWorkflows: {\n    resource: 'users',\n    id: ({\n      id\n    }) => `${id}/dataApprovalWorkflows`\n  }\n};\n\nconst CurrentUserProvider = ({\n  children\n}) => {\n  const {\n    data: workflowsData,\n    loading: workflowsLoading,\n    error: workflowsError,\n    refetch: refetchWorkflows,\n    called: workflowsCalled\n  } = useDataQuery(dataApprovalWorkflowsQuery, {\n    lazy: true\n  });\n  const {\n    data: meData,\n    loading: meLoading,\n    error: meError\n  } = useDataQuery(meQuery, {\n    onComplete: ({\n      me: {\n        id\n      }\n    }) => refetchWorkflows({\n      id\n    })\n  });\n  const loading = !workflowsCalled || workflowsLoading || meLoading;\n  const error = !loading && (workflowsError || meError);\n\n  if (loading) {\n    return /*#__PURE__*/React.createElement(Layer, null, /*#__PURE__*/React.createElement(CenteredContent, null, /*#__PURE__*/React.createElement(CircularLoader, null)));\n  }\n\n  if (error) {\n    /**\n     * The app can't continue if this fails, because it doesn't\n     * have any data, so throw the error and let it be caught by\n     * the error boundary in the app-shell\n     */\n    throw error;\n  }\n\n  return /*#__PURE__*/React.createElement(CurrentUserContext.Provider, {\n    value: { ...meData.me,\n      ...workflowsData.dataApprovalWorkflows\n    }\n  }, children);\n};\n\nCurrentUserProvider.propTypes = {\n  children: PropTypes.node.isRequired\n};\nexport { CurrentUserProvider };","import { useContext } from 'react';\nimport { CurrentUserContext } from './current-user-context.js';\nexport const useCurrentUser = () => useContext(CurrentUserContext);","import i18n from '@dhis2/d2-i18n';\nimport { NoticeBox } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport classes from './auth-wall.module.css';\nimport { useIsAuthorized } from './use-is-authorized.js';\n\nconst AuthWall = ({\n  children\n}) => {\n  const isAuthorized = useIsAuthorized();\n\n  if (!isAuthorized) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.wrapper\n    }, /*#__PURE__*/React.createElement(NoticeBox, {\n      error: true,\n      title: i18n.t('Not authorized')\n    }, i18n.t(\"You don't have access to the Data Approval App. Contact a system administrator to request access.\")));\n  }\n\n  return children;\n};\n\nAuthWall.propTypes = {\n  children: PropTypes.node.isRequired\n};\nexport { AuthWall };","import { useCurrentUser } from '../current-user/index.js';\nexport const useIsAuthorized = () => {\n  const {\n    authorities\n  } = useCurrentUser();\n  return authorities.some(authority => authority === 'ALL' || authority === 'M_dhis-web-approval');\n};","import React from 'react';\n\nconst BottomBar = () => /*#__PURE__*/React.createElement(\"pre\", null, \"BottomBar placeholder\");\n\nexport { BottomBar };","import React from 'react';\n\nconst DataWorkspace = () => /*#__PURE__*/React.createElement(\"pre\", null, \"DataWorkspace placeholder\");\n\nexport { DataWorkspace };","import { createContext } from 'react';\n\nconst noop = () => {};\n\nconst SelectionContext = /*#__PURE__*/createContext({\n  workflow: {},\n  setWorkflow: noop,\n  period: {},\n  setPeriod: noop,\n  orgUnit: {},\n  setOrgUnit: noop\n});\nexport { SelectionContext };","import { PropTypes } from '@dhis2/prop-types';\nimport React, { useEffect, useReducer } from 'react';\nimport { useQueryParams, StringParam } from 'use-query-params';\nimport { useCurrentUser } from '../../current-user/index.js';\nimport { SelectionContext } from './selection-context.js'; // TODO: should take a periodCode and return a period object\n\nconst parsePeriodCode = code => ({\n  code: code,\n  name: code\n});\n\nconst initialWorkflowValue = (workflows, id) => {\n  if (id) {\n    /*\n     * Auto select workflow with query param id\n     * default to empty object if `find` returns undefined in case the\n     * workflow with the id from the url is not available to the user\n     */\n    return workflows.find(workflow => workflow.id === id) || {};\n  }\n\n  if (workflows.length === 1) {\n    // auto-select if user only has one workflow\n    return workflows[0];\n  }\n\n  return {};\n};\n\nconst ACTIONS = {\n  SET_OPENED_SELECT: 'SET_OPENED_SELECT',\n  CLEAR_ALL: 'CLEAR_ALL',\n  SELECT_WORKFLOW: 'SELECT_WORKFLOW',\n  SELECT_PERIOD: 'SELECT_PERIOD',\n  SELECT_ORG_UNIT: 'SELECT_ORG_UNIT'\n};\n\nconst reducer = (state, {\n  type,\n  payload\n}) => {\n  switch (type) {\n    case ACTIONS.SET_OPENED_SELECT:\n      return { ...state,\n        openedSelect: payload\n      };\n\n    case ACTIONS.CLEAR_ALL:\n      return {\n        openedSelect: '',\n        workflow: {},\n        period: {},\n        orgUnit: {}\n      };\n\n    case ACTIONS.SELECT_WORKFLOW:\n      return {\n        openedSelect: '',\n        workflow: payload,\n        period: {},\n        orgUnit: {}\n      };\n\n    case ACTIONS.SELECT_PERIOD:\n      return { ...state,\n        openedSelect: '',\n        period: payload,\n        orgUnit: {}\n      };\n\n    case ACTIONS.SELECT_ORG_UNIT:\n      return { ...state,\n        openedSelect: '',\n        orgUnit: payload\n      };\n\n    default:\n      return state;\n  }\n};\n\nconst SelectionProvider = ({\n  children\n}) => {\n  const [query, setQuery] = useQueryParams({\n    wf: StringParam,\n    pe: StringParam,\n    ou: StringParam\n  });\n  const {\n    dataApprovalWorkflows\n  } = useCurrentUser();\n  const [{\n    openedSelect,\n    workflow,\n    period,\n    orgUnit\n  }, dispatch] = useReducer(reducer, {\n    openedSelect: '',\n    workflow: initialWorkflowValue(dataApprovalWorkflows, query.wf),\n    period: query.pe ? parsePeriodCode(query.pe) : {},\n    orgUnit: query.ou ? {\n      id: query.ou\n    } : {}\n  });\n  const providerValue = {\n    workflow,\n    period,\n    orgUnit,\n    openedSelect,\n    clearAll: () => dispatch({\n      type: ACTIONS.CLEAR_ALL,\n      payload: initialWorkflowValue(dataApprovalWorkflows)\n    }),\n    setOpenedSelect: fieldName => dispatch({\n      type: ACTIONS.SET_OPENED_SELECT,\n      payload: fieldName\n    }),\n    selectWorkflow: workflow => dispatch({\n      type: ACTIONS.SELECT_WORKFLOW,\n      payload: workflow\n    }),\n    selectPeriod: period => dispatch({\n      type: ACTIONS.SELECT_PERIOD,\n      payload: period\n    }),\n    selectOrgUnit: orgUnit => dispatch({\n      type: ACTIONS.SELECT_ORG_UNIT,\n      payload: orgUnit\n    })\n  };\n  useEffect(() => {\n    setQuery({\n      wf: workflow.id,\n      pe: period.code,\n      ou: orgUnit.id\n    });\n  }, [workflow, period, orgUnit]);\n  return /*#__PURE__*/React.createElement(SelectionContext.Provider, {\n    value: providerValue\n  }, children);\n};\n\nSelectionProvider.propTypes = {\n  children: PropTypes.node\n};\nexport { SelectionProvider };","import { useContext } from 'react';\nimport { SelectionContext } from './selection-context.js';\nexport const useSelection = () => useContext(SelectionContext);","import i18n from '@dhis2/d2-i18n';\nimport { Button } from '@dhis2/ui';\nimport React from 'react';\nimport { useSelection } from '../selection/index.js';\nimport classes from './clear-all-button.module.css';\n\nconst ClearAllButton = () => {\n  const {\n    clearAll,\n    period,\n    orgUnit\n  } = useSelection();\n  return period.code || orgUnit.id ? /*#__PURE__*/React.createElement(Button, {\n    className: classes.button,\n    secondary: true,\n    onClick: clearAll\n  }, i18n.t('Clear selections')) : null;\n};\n\nexport { ClearAllButton };","import { IconChevronDown24, IconChevronUp24, colors, Popover } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useRef } from 'react';\nimport classes from './context-select.module.css';\n\nconst ContextSelect = ({\n  children,\n  label,\n  value,\n  onClose,\n  onOpen,\n  disabled,\n  open\n}) => {\n  const ref = useRef();\n  const Icon = open ? IconChevronUp24 : IconChevronDown24;\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"button\", {\n    ref: ref,\n    className: classes.button,\n    onClick: onOpen,\n    disabled: disabled\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: classes.prefix\n  }, label), /*#__PURE__*/React.createElement(\"span\", {\n    className: classes.value\n  }, value), /*#__PURE__*/React.createElement(Icon, {\n    color: disabled ? colors.grey600 : undefined\n  })), open && /*#__PURE__*/React.createElement(Popover, {\n    reference: ref,\n    arrow: false,\n    placement: \"bottom-start\",\n    onClickOutside: onClose\n  }, children));\n};\n\nContextSelect.propTypes = {\n  children: PropTypes.node.isRequired,\n  label: PropTypes.string.isRequired,\n  value: PropTypes.string.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onOpen: PropTypes.func.isRequired,\n  disabled: PropTypes.bool,\n  open: PropTypes.bool\n};\nexport { ContextSelect };","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport { ContextSelect } from '../context-select/index.js';\nimport { useSelection } from '../selection/index.js';\nconst ORG_UNIT = 'ORG_UNIT';\n\nconst OrgUnitSelect = () => {\n  const {\n    orgUnit\n    /*, setOrgUnit */\n    ,\n    workflow,\n    period,\n    openedSelect,\n    setOpenedSelect\n  } = useSelection();\n  const open = openedSelect === ORG_UNIT;\n  const value = orgUnit.name || i18n.t('Choose an organisation unit');\n  return /*#__PURE__*/React.createElement(ContextSelect, {\n    label: i18n.t('Organisation Unit'),\n    value: value,\n    open: open,\n    disabled: !(workflow.id && period.code),\n    onOpen: () => setOpenedSelect(ORG_UNIT),\n    onClose: () => setOpenedSelect('')\n  }, /*#__PURE__*/React.createElement(\"pre\", null, \"Org Unit picker placeholder\"));\n};\n\nexport { OrgUnitSelect };","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport { ContextSelect } from '../context-select/index.js';\nimport { useSelection } from '../selection/index.js';\nconst PERIOD = 'PERIOD';\n\nconst PeriodSelect = () => {\n  const {\n    period,\n    workflow,\n    selectPeriod,\n    openedSelect,\n    setOpenedSelect\n  } = useSelection();\n  const open = openedSelect === PERIOD;\n  const value = period.name || i18n.t('Choose a period');\n  return /*#__PURE__*/React.createElement(ContextSelect, {\n    label: i18n.t('Period'),\n    value: value,\n    open: open,\n    disabled: !workflow.id,\n    onOpen: () => setOpenedSelect(PERIOD),\n    onClose: () => setOpenedSelect('')\n  }, /*#__PURE__*/React.createElement(\"pre\", null, \"Period picker placeholder \", /*#__PURE__*/React.createElement(\"br\", null), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => selectPeriod({\n      code: '20210404',\n      name: '04-04-2020'\n    })\n  }, \"Set period to sth\")));\n};\n\nexport { PeriodSelect };","import { MenuItem } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport classes from './workflow-select-option.module.css';\n\nconst WorkflowSelectOption = ({\n  name,\n  periodType,\n  active,\n  onClick\n}) => {\n  const label = /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.option\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: classes.title\n  }, name), /*#__PURE__*/React.createElement(\"span\", {\n    className: classes.subtitle\n  }, periodType || 'UNAVAILABLE'));\n  return /*#__PURE__*/React.createElement(MenuItem, {\n    className: classes.bordered,\n    active: active,\n    onClick: onClick,\n    label: label\n  });\n};\n\nWorkflowSelectOption.propTypes = {\n  name: PropTypes.string.isRequired,\n  active: PropTypes.bool,\n  periodType: PropTypes.string,\n  onClick: PropTypes.func\n};\nexport { WorkflowSelectOption };","import i18n from '@dhis2/d2-i18n';\nimport { Menu } from '@dhis2/ui';\nimport React from 'react';\nimport { useCurrentUser } from '../../current-user/index.js';\nimport { ContextSelect } from '../context-select/index.js';\nimport { useSelection } from '../selection/index.js';\nimport { WorkflowSelectOption } from './workflow-select-option.js';\nimport classes from './workflow-select.module.css';\nconst WORKFLOW = 'WORKFLOW';\n\nconst WorkflowSelect = () => {\n  const {\n    dataApprovalWorkflows\n  } = useCurrentUser();\n  const {\n    workflow: selectedWorkflow,\n    selectWorkflow,\n    openedSelect,\n    setOpenedSelect\n  } = useSelection();\n  const open = openedSelect === WORKFLOW;\n  const value = selectedWorkflow.name || i18n.t('Choose a workflow');\n  return /*#__PURE__*/React.createElement(ContextSelect, {\n    label: i18n.t('Workflow'),\n    value: value,\n    open: open,\n    onOpen: () => setOpenedSelect(WORKFLOW),\n    onClose: () => setOpenedSelect('')\n  }, dataApprovalWorkflows.length === 0 ? /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.message\n  }, i18n.t('No workflows found. None may exist or you may not have access to any.')) : /*#__PURE__*/React.createElement(Menu, null, dataApprovalWorkflows.map(workflow => /*#__PURE__*/React.createElement(WorkflowSelectOption, {\n    key: workflow.id,\n    name: workflow.name,\n    periodType: workflow.periodType,\n    active: workflow.id === selectedWorkflow.id,\n    onClick: () => selectWorkflow(workflow)\n  }))));\n};\n\nexport { WorkflowSelect };","import React from 'react';\nimport { ClearAllButton } from './clear-all-button/index.js';\nimport { OrgUnitSelect } from './org-unit-select/index.js';\nimport { PeriodSelect } from './period-select/index.js';\nimport { SelectionProvider } from './selection/index.js';\nimport { WorkflowSelect } from './workflow-select/index.js';\n\nconst TopBar = () => /*#__PURE__*/React.createElement(SelectionProvider, null, /*#__PURE__*/React.createElement(WorkflowSelect, null), /*#__PURE__*/React.createElement(PeriodSelect, null), /*#__PURE__*/React.createElement(OrgUnitSelect, null), /*#__PURE__*/React.createElement(ClearAllButton, null));\n\nexport { TopBar };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport classes from './layout.module.css';\n\nconst LayoutSection = ({\n  children,\n  className\n}) => /*#__PURE__*/React.createElement(\"div\", {\n  className: className\n}, children);\n\nLayoutSection.propTypes = {\n  children: PropTypes.node,\n  className: PropTypes.string\n};\n\nconst Container = props => /*#__PURE__*/React.createElement(LayoutSection, _extends({}, props, {\n  className: classes.container\n}));\n\nconst Top = props => /*#__PURE__*/React.createElement(LayoutSection, _extends({}, props, {\n  className: classes.top\n}));\n\nconst Content = props => /*#__PURE__*/React.createElement(LayoutSection, _extends({}, props, {\n  className: classes.content\n}));\n\nconst Bottom = props => /*#__PURE__*/React.createElement(LayoutSection, _extends({}, props, {\n  className: classes.bottom\n}));\n\nexport const Layout = {\n  Container,\n  Top,\n  Content,\n  Bottom\n};","import { App } from './app.js';\nexport default App;","import { CssVariables } from '@dhis2/ui';\nimport React from 'react';\nimport { QueryParamProvider } from 'use-query-params';\nimport { AuthWall } from '../auth/index.js';\nimport { BottomBar } from '../bottom-bar/index.js';\nimport { CurrentUserProvider } from '../current-user/index.js';\nimport { DataWorkspace } from '../data-workspace/index.js';\nimport { TopBar } from '../top-bar/index.js';\nimport { Layout } from './layout.js';\n\nconst App = () => /*#__PURE__*/React.createElement(QueryParamProvider, null, /*#__PURE__*/React.createElement(CssVariables, {\n  spacers: true,\n  colors: true,\n  theme: true\n}), /*#__PURE__*/React.createElement(CurrentUserProvider, null, /*#__PURE__*/React.createElement(AuthWall, null, /*#__PURE__*/React.createElement(Layout.Container, null, /*#__PURE__*/React.createElement(Layout.Top, null, /*#__PURE__*/React.createElement(TopBar, null)), /*#__PURE__*/React.createElement(Layout.Content, null, /*#__PURE__*/React.createElement(DataWorkspace, null)), /*#__PURE__*/React.createElement(Layout.Bottom, null, /*#__PURE__*/React.createElement(BottomBar, null))))));\n\nexport { App };"],"sourceRoot":""}