(this["webpackJsonp@dhis2/app-shell"]=this["webpackJsonp@dhis2/app-shell"]||[]).push([[135],{490:function(e,t,a){"use strict";const r=a(492),o=a(493),n=a(494),l=a(495),s=Symbol("encodeFragmentIdentifier");function i(e){if("string"!==typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function c(e,t){return t.encode?t.strict?r(e):encodeURIComponent(e):e}function p(e,t){return t.decode?o(e):e}function d(e){return Array.isArray(e)?e.sort():"object"===typeof e?d(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function u(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function m(e){const t=(e=u(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function y(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"===typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function f(e,t){i((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const a=function(e){let t;switch(e.arrayFormat){case"index":return(e,a,r)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===r[e]&&(r[e]={}),r[e][t[1]]=a):r[e]=a};case"bracket":return(e,a,r)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],a):r[e]=[a]:r[e]=a};case"comma":case"separator":return(t,a,r)=>{const o="string"===typeof a&&a.includes(e.arrayFormatSeparator),n="string"===typeof a&&!o&&p(a,e).includes(e.arrayFormatSeparator);a=n?p(a,e):a;const l=o||n?a.split(e.arrayFormatSeparator).map((t=>p(t,e))):null===a?a:p(a,e);r[t]=l};case"bracket-separator":return(t,a,r)=>{const o=/(\[\])$/.test(t);if(t=t.replace(/\[\]$/,""),!o)return void(r[t]=a?p(a,e):a);const n=null===a?[]:a.split(e.arrayFormatSeparator).map((t=>p(t,e)));void 0!==r[t]?r[t]=[].concat(r[t],n):r[t]=n};default:return(e,t,a)=>{void 0!==a[e]?a[e]=[].concat(a[e],t):a[e]=t}}}(t),r=Object.create(null);if("string"!==typeof e)return r;if(!(e=e.trim().replace(/^[?#&]/,"")))return r;for(const o of e.split("&")){if(""===o)continue;let[e,l]=n(t.decode?o.replace(/\+/g," "):o,"=");l=void 0===l?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?l:p(l,t),a(p(e,t),l,r)}for(const o of Object.keys(r)){const e=r[o];if("object"===typeof e&&null!==e)for(const a of Object.keys(e))e[a]=y(e[a],t);else r[o]=y(e,t)}return!1===t.sort?r:(!0===t.sort?Object.keys(r).sort():Object.keys(r).sort(t.sort)).reduce(((e,t)=>{const a=r[t];return Boolean(a)&&"object"===typeof a&&!Array.isArray(a)?e[t]=d(a):e[t]=a,e}),Object.create(null))}t.extract=m,t.parse=f,t.stringify=(e,t)=>{if(!e)return"";i((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const a=a=>{return t.skipNull&&(null===(r=e[a])||void 0===r)||t.skipEmptyString&&""===e[a];var r},r=function(e){switch(e.arrayFormat){case"index":return t=>(a,r)=>{const o=a.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?a:null===r?[...a,[c(t,e),"[",o,"]"].join("")]:[...a,[c(t,e),"[",c(o,e),"]=",c(r,e)].join("")]};case"bracket":return t=>(a,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?a:null===r?[...a,[c(t,e),"[]"].join("")]:[...a,[c(t,e),"[]=",c(r,e)].join("")];case"comma":case"separator":case"bracket-separator":{const t="bracket-separator"===e.arrayFormat?"[]=":"=";return a=>(r,o)=>void 0===o||e.skipNull&&null===o||e.skipEmptyString&&""===o?r:(o=null===o?"":o,0===r.length?[[c(a,e),t,c(o,e)].join("")]:[[r,c(o,e)].join(e.arrayFormatSeparator)])}default:return t=>(a,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?a:null===r?[...a,c(t,e)]:[...a,[c(t,e),"=",c(r,e)].join("")]}}(t),o={};for(const l of Object.keys(e))a(l)||(o[l]=e[l]);const n=Object.keys(o);return!1!==t.sort&&n.sort(t.sort),n.map((a=>{const o=e[a];return void 0===o?"":null===o?c(a,t):Array.isArray(o)?0===o.length&&"bracket-separator"===t.arrayFormat?c(a,t)+"[]":o.reduce(r(a),[]).join("&"):c(a,t)+"="+c(o,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[a,r]=n(e,"#");return Object.assign({url:a.split("?")[0]||"",query:f(m(e),t)},t&&t.parseFragmentIdentifier&&r?{fragmentIdentifier:p(r,t)}:{})},t.stringifyUrl=(e,a)=>{a=Object.assign({encode:!0,strict:!0,[s]:!0},a);const r=u(e.url).split("?")[0]||"",o=t.extract(e.url),n=t.parse(o,{sort:!1}),l=Object.assign(n,e.query);let i=t.stringify(l,a);i&&(i=`?${i}`);let p=function(e){let t="";const a=e.indexOf("#");return-1!==a&&(t=e.slice(a)),t}(e.url);return e.fragmentIdentifier&&(p=`#${a[s]?c(e.fragmentIdentifier,a):e.fragmentIdentifier}`),`${r}${i}${p}`},t.pick=(e,a,r)=>{r=Object.assign({parseFragmentIdentifier:!0,[s]:!1},r);const{url:o,query:n,fragmentIdentifier:i}=t.parseUrl(e,r);return t.stringifyUrl({url:o,query:l(n,a),fragmentIdentifier:i},r)},t.exclude=(e,a,r)=>{const o=Array.isArray(a)?e=>!a.includes(e):(e,t)=>!a(e,t);return t.pick(e,o,r)}},491:function(e,t,a){e.exports={wrapper:"error-message_wrapper__17C15"}},492:function(e,t,a){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},493:function(e,t,a){"use strict";var r="%[a-f0-9]{2}",o=new RegExp(r,"gi"),n=new RegExp("("+r+")+","gi");function l(e,t){try{return decodeURIComponent(e.join(""))}catch(o){}if(1===e.length)return e;t=t||1;var a=e.slice(0,t),r=e.slice(t);return Array.prototype.concat.call([],l(a),l(r))}function s(e){try{return decodeURIComponent(e)}catch(r){for(var t=e.match(o),a=1;a<t.length;a++)t=(e=l(t,a).join("")).match(o);return e}}e.exports=function(e){if("string"!==typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var a={"%FE%FF":"\ufffd\ufffd","%FF%FE":"\ufffd\ufffd"},r=n.exec(e);r;){try{a[r[0]]=decodeURIComponent(r[0])}catch(t){var o=s(r[0]);o!==r[0]&&(a[r[0]]=o)}r=n.exec(e)}a["%C2"]="\ufffd";for(var l=Object.keys(a),i=0;i<l.length;i++){var c=l[i];e=e.replace(new RegExp(c,"g"),a[c])}return e}(e)}}},494:function(e,t,a){"use strict";e.exports=(e,t)=>{if("string"!==typeof e||"string"!==typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const a=e.indexOf(t);return-1===a?[e]:[e.slice(0,a),e.slice(a+t.length)]}},495:function(e,t,a){"use strict";e.exports=function(e,t){for(var a={},r=Object.keys(e),o=Array.isArray(t),n=0;n<r.length;n++){var l=r[n],s=e[l];(o?-1!==t.indexOf(l):t(l,s,e))&&(a[l]=s)}return a}},496:function(e,t,a){"use strict";function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}a.d(t,"a",(function(){return r}))},497:function(e,t,a){e.exports={summary:"approve-modal_summary__1abcn",summaryTitle:"approve-modal_summaryTitle__2sA2i",summaryList:"approve-modal_summaryList__1lufS",confirmationStatement:"approve-modal_confirmationStatement__1LDKw"}},498:function(e,t,a){e.exports={bottomBarItem:"bottom-bar-item_bottomBarItem__2GbAg"}},499:function(e,t,a){e.exports={bottomBar:"bottom-bar_bottomBar__2CojG"}},500:function(e,t,a){e.exports={display:"display_display__1GxX4",chooseDataSet:"display_chooseDataSet__2Nojl display_display__1GxX4",loadingWrapper:"display_loadingWrapper__1l_5I",noData:"display_noData__XihRO display_display__1GxX4",retryButton:"display_retryButton__19fWD"}},501:function(e,t,a){e.exports={titleBar:"title-bar_titleBar__8rOU1",workflowName:"title-bar_workflowName__3s44E",workflowDataSetsCount:"title-bar_workflowDataSetsCount__4Ew1p"}},502:function(e,t,a){e.exports={button:"context-select_button__1y8va",prefix:"context-select_prefix__3xDFu",value:"context-select_value__oltZj",tooltipwrap:"context-select_tooltipwrap__3Fqbe"}},503:function(e,t,a){e.exports={menu:"period-menu_menu__2CHPS"}},504:function(e,t,a){e.exports={container:"year-navigator_container__3XXd2",year:"year-navigator_year__14nbM"}},505:function(e,t,a){e.exports={button:"clear-all-button_button__mDEHm"}},506:function(e,t,a){e.exports={scrollbox:"org-unit-select_scrollbox__23k48"}},507:function(e,t,a){e.exports={bordered:"workflow-select-option_bordered__JBAIX",option:"workflow-select-option_option__1cqTS",title:"workflow-select-option_title__3zrtv",subtitle:"workflow-select-option_subtitle__3yrup"}},508:function(e,t,a){e.exports={message:"workflow-select_message__1jq5N"}},509:function(e,t,a){e.exports={container:"layout_container__Cp-96",top:"layout_top__2gcI9",content:"layout_content__10QOH",bottom:"layout_bottom__2toTd"}},510:function(e){e.exports=JSON.parse('{"Not authorized":"Not authorized","You don\'t have access to the Data Approval App. Contact a system administrator to request access.":"You don\'t have access to the Data Approval App. Contact a system administrator to request access.","Acceptance failed: {{error}}":"Acceptance failed: {{error}}","Accept":"Accept","Approval saved":"Approval saved","Approve":"Approve","Approving {{count}} data sets":"Approving {{count}} data sets","Approving {{count}} data sets_plural":"Approving {{count}} data sets","Approving {{count}} data set":"Approving {{count}} data set","Approving {{count}} data set_plural":"Approving {{count}} data set","Are you sure you want to approve this data?":"Are you sure you want to approve this data?","There was a problem saving this approval":"There was a problem saving this approval","This data couldn\u2019t be approved. Try again, or contact your system administrator.":"This data couldn\u2019t be approved. Try again, or contact your system administrator.","Cancel":"Cancel","Unacceptance failed: {{error}}":"Unacceptance failed: {{error}}","Unaccept":"Unaccept","Unapproval failed: {{error}}":"Unapproval failed: {{error}}","Unapprove":"Unapprove","Choose a data set to review":"Choose a data set to review","{{- workflowName}} has multiple data sets. Choose a data set from the tabs above.":"{{- workflowName}} has multiple data sets. Choose a data set from the tabs above.","There was a problem displaying this data set":"There was a problem displaying this data set","This data set couldn\'t be loaded or displayed. Try again, or contact your system administrator.":"This data set couldn\'t be loaded or displayed. Try again, or contact your system administrator.","Retry loading data set":"Retry loading data set","Loading data set":"Loading data set","This data set doesn\'t have any data for the selected period and organisation unit.":"This data set doesn\'t have any data for the selected period and organisation unit.","{{dataSetsCount}} data sets":"{{dataSetsCount}} data sets","Approved":"Approved","Ready for approval and accepted":"Ready for approval and accepted","Ready for approval":"Ready for approval","Waiting":"Waiting","Cannot approve":"Cannot approve","Clear selections":"Clear selections","Choose a period first":"Choose a period first","Choose a workflow and period first":"Choose a workflow and period first","Organisation Unit":"Organisation Unit","Choose an organisation unit":"Choose an organisation unit","January":"January","February":"February","March":"March","April":"April","May":"May","June":"June","July":"July","August":"August","September":"September","October":"October","November":"November","December":"December","Week {{weekNumber}}":"Week {{weekNumber}}","Bi-Week {{biWeekNumber}}":"Bi-Week {{biWeekNumber}}","Daily":"Daily","Weekly":"Weekly","Weekly (Start Wednesday)":"Weekly (Start Wednesday)","Weekly (Start Thursday)":"Weekly (Start Thursday)","Weekly (Start Saturday)":"Weekly (Start Saturday)","Weekly (Start Sunday)":"Weekly (Start Sunday)","Bi-weekly":"Bi-weekly","Monthly":"Monthly","Bi-monthly":"Bi-monthly","Quarterly":"Quarterly","Six-monthly":"Six-monthly","Six-monthly April":"Six-monthly April","Yearly":"Yearly","Financial year (Start November)":"Financial year (Start November)","Financial year (Start October)":"Financial year (Start October)","Financial year (Start July)":"Financial year (Start July)","Financial year (Start April)":"Financial year (Start April)","Period":"Period","Choose a period":"Choose a period","Choose a workflow first":"Choose a workflow first","Workflow":"Workflow","Choose a workflow":"Choose a workflow","No workflows found. None may exist, or you may not have access to any.":"No workflows found. None may exist, or you may not have access to any.","Could not load approval data":"Could not load approval data"}')},511:function(e,t,a){"use strict";a.r(t);var r=a(6),o=a(0),n=a.n(o);const l=Object(o.createContext)({});var s=a(7),i=a(491),c=a.n(i);const p=({children:e,title:t})=>n.a.createElement("div",{className:c.a.wrapper},n.a.createElement(r.B,{error:!0,title:t},e)),d=()=>n.a.createElement(r.e,null,n.a.createElement(r.f,null));var u=a(5);const m=()=>n.a.createElement("svg",{height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg"},n.a.createElement("path",{d:"m7 10.707-2.5-2.5005.7065-.7065 1.7935 1.793 3.7925-3.793.7075.7075zm1-9.707c-3.86599325 0-7 3.13400675-7 7 0 3.8659932 3.13400675 7 7 7 3.8659932 0 7-3.1340068 7-7 0-1.85651543-.7374979-3.63699282-2.0502525-4.94974747-1.3127547-1.31275465-3.09323207-2.05025253-4.9497475-2.05025253zm0 13c-3.3137085 0-6-2.6862915-6-6s2.6862915-6 6-6 6 2.6862915 6 6c0 1.59129894-.632141 3.1174224-1.7573593 4.2426407s-2.65134176 1.7573593-4.2426407 1.7573593z",fillRule:"evenodd"})),y=()=>n.a.createElement("svg",{height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg"},n.a.createElement("path",{d:"m8 1c3.8659932 0 7 3.13400675 7 7 0 3.8659932-3.1340068 7-7 7-3.86599325 0-7-3.1340068-7-7 0-3.86599325 3.13400675-7 7-7zm0 1c-3.3137085 0-6 2.6862915-6 6s2.6862915 6 6 6 6-2.6862915 6-6-2.6862915-6-6-6zm0 3c1.65685425 0 3 1.34314575 3 3s-1.34314575 3-3 3-3-1.34314575-3-3 1.34314575-3 3-3z"})),f=()=>n.a.createElement("svg",{height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg"},n.a.createElement("path",{d:"m10.9909978 13.1912785.4995502.8652231c-.6149252.36386-1.28431.6250019-1.98177134.7738229l-.30055406.0568756-.17347694-.9839041c.69055396-.1141334 1.35389354-.3555692 1.95625214-.7120175zm-5.99434717 0c.51630734.3055271 1.07741706.5265553 1.66206503.655345l.29418707.0566725-.17347695.9839041c-.70494478-.1165334-1.38558203-.3467594-2.01552871-.6810754l-.26679673-.1496231zm8.63003137-3.1410745.9388324.3416946c-.2371754.6739992-.5820951 1.3043178-1.0207212 1.8666408l-.1936788.2367617-.7653324-.6422054c.4556314-.5313108.8085871-1.1426479 1.0409-1.8028917zm-11.26571557 0c.19912533.5659233.48688614 1.095915.85196802 1.5703782l.18893198.2325135-.7653324.6422054c-.46511284-.5423995-.8385248-1.1562681-1.10619776-1.8172909l-.10820224-.2861116zm2.98641115-5.40375758 6.00000002 5.99999998-.7071068.7071068-6-5.99999999zm9.21813622.96165313c.2515515.66876676.3924886 1.37332892.4179358 2.08603675l.0038209.30586432-.9990803-.0000117c.0064405-.59989882-.0826983-1.19634818-.2634871-1.76706305l-.0980137-.28310973zm-13.14337922 0 .93882439.34171659c-.21122962.56151769-.3314642 1.15248403-.35677429 1.750614l-.00472648.29955878-.99908031.0000117c-.0087422-.81653816.13426921-1.6275962.42175669-2.39190107zm10.06841202-3.6646023c.6225747.35061085 1.1834226.79974418 1.661036 1.32935292l.1995328.23184963-.7653475.64218748c-.3806737-.46368907-.8323483-.86329844-1.337689-1.18428261l-.2570623-.15387264zm-6.99344486 0 .49953002.86523478c-.52274789.29437172-.99471877.66979291-1.39857796 1.11171803l-.19617336.22643722-.76534744-.64218748c.51816369-.6311239 1.14905485-1.16050444 1.86056874-1.56120255zm4.36598381-.88594632.34513864.05524888-.1735.9839c-.58966661-.11051404-1.19253336-.12630176-1.78597144-.04736316l-.29582856.04736316-.1735-.9839c.68795575-.12891407 1.39130692-.14733037 2.08366136-.05524888z",fillRule:"evenodd"})),g=({approvalState:e})=>{const{icon:t,displayName:a,type:o}=(e=>{switch(e){case"APPROVED_HERE":case"APPROVED_ELSEWHERE":return{icon:m,displayName:u.a.t("Approved"),type:"positive"};case"ACCEPTED_HERE":case"ACCEPTED_ELSEWHERE":return{icon:y,displayName:u.a.t("Ready for approval and accepted"),type:"neutral"};case"UNAPPROVED_READY":return{icon:y,displayName:u.a.t("Ready for approval"),type:"neutral"};case"UNAPPROVED_WAITING":case"UNAPPROVED_ELSEWHERE":case"UNAPPROVED_ABOVE":return{icon:f,displayName:u.a.t("Waiting"),type:"default"};case"UNAPPROVABLE":return{icon:f,displayName:u.a.t("Cannot approve"),type:"negative"};default:throw new Error(`Unknown approval state: '${e}'`)}})(e),l={[o]:!0,icon:n.a.createElement(t,null)};return n.a.createElement(r.I,l,a)},h={me:{resource:"me",params:{fields:["id","authorities","organisationUnits"]}},dataApprovalWorkflows:{resource:"dataApprovalWorkflows",params:{paging:!1,fields:["id","displayName","dataApprovalLevels","periodType","dataSets[id,displayName,periodType]"]}}},v=({children:e})=>{const{data:t,loading:a,error:o}=Object(s.f)(h);if(a)return n.a.createElement(r.u,null,n.a.createElement(d,null));if(o)throw o;const i={...t.me,...t.dataApprovalWorkflows};return n.a.createElement(l.Provider,{value:i},e)},w=()=>Object(o.useContext)(l),E=({children:e})=>(()=>{const{authorities:e}=w();return e.some((e=>"ALL"===e||"M_dhis-web-approval"===e))})()?e:n.a.createElement(p,{title:u.a.t("Not authorized")},u.a.t("You don't have access to the Data Approval App. Contact a system administrator to request access.")),b=Object(o.createContext)({displayName:"",dataSets:[],approvalState:"",allowedActions:{},params:{},refresh:()=>{throw new Error("WorkflowContext.refresh has not been initialized")}});var D=a(490);const S=e=>`/#/?${Object(D.stringify)(e)}`;var k,N=a(496),_=k||(k={});_.Pop="POP",_.Push="PUSH",_.Replace="REPLACE";var O=function(e){return e};function A(e){e.preventDefault(),e.returnValue=""}function F(){var e=[];return{get length(){return e.length},push:function(t){return e.push(t),function(){e=e.filter((function(e){return e!==t}))}},call:function(t){e.forEach((function(e){return e&&e(t)}))}}}function $(){return Math.random().toString(36).substr(2,8)}function C(e){var t=e.pathname,a=e.search;return(void 0===t?"/":t)+(void 0===a?"":a)+(void 0===(e=e.hash)?"":e)}function x(e){var t={};if(e){var a=e.indexOf("#");0<=a&&(t.hash=e.substr(a),e=e.substr(0,a)),0<=(a=e.indexOf("?"))&&(t.search=e.substr(a),e=e.substr(0,a)),e&&(t.pathname=e)}return t}const P=function(e){function t(){var e=x(s.location.hash.substr(1)),t=e.pathname,a=e.search;e=e.hash;var r=i.state||{};return[r.idx,O({pathname:void 0===t?"/":t,search:void 0===a?"":a,hash:void 0===e?"":e,state:r.usr||null,key:r.key||"default"})]}function a(){if(c)y.call(c),c=null;else{var e=k.Pop,a=t(),r=a[0];if(a=a[1],y.length){if(null!=r){var o=d-r;o&&(c={action:e,location:a,retry:function(){l(-1*o)}},l(o))}}else n(e)}}function r(e){var t=document.querySelector("base"),a="";return t&&t.getAttribute("href")&&(a=-1===(a=(t=s.location.href).indexOf("#"))?t:t.slice(0,a)),a+"#"+("string"===typeof e?e:C(e))}function o(e,t){return void 0===t&&(t=null),O(Object(N.a)({},u,{},"string"===typeof e?x(e):e,{state:t,key:$()}))}function n(e){p=e,e=t(),d=e[0],u=e[1],m.call({action:p,location:u})}function l(e){i.go(e)}void 0===e&&(e={});var s=void 0===(e=e.window)?document.defaultView:e,i=s.history,c=null;s.addEventListener("popstate",a),s.addEventListener("hashchange",(function(){C(t()[1])!==C(u)&&a()}));var p=k.Pop,d=(e=t())[0],u=e[1],m=F(),y=F();return null==d&&(d=0,i.replaceState(Object(N.a)({},i.state,{idx:d}),"")),{get action(){return p},get location(){return u},createHref:r,push:function e(t,a){var l=k.Push,c=o(t,a);if(!y.length||(y.call({action:l,location:c,retry:function(){e(t,a)}}),0)){var p=[{usr:c.state,key:c.key,idx:d+1},r(c)];c=p[0],p=p[1];try{i.pushState(c,"",p)}catch(u){s.location.assign(p)}n(l)}},replace:function e(t,a){var l=k.Replace,s=o(t,a);y.length&&(y.call({action:l,location:s,retry:function(){e(t,a)}}),1)||(s=[{usr:s.state,key:s.key,idx:d},r(s)],i.replaceState(s[0],"",s[1]),n(l))},go:l,back:function(){l(-1)},forward:function(){l(1)},listen:function(e){return m.push(e)},block:function(e){var t=y.push(e);return 1===y.length&&s.addEventListener("beforeunload",A),function(){t(),y.length||s.removeEventListener("beforeunload",A)}}}}(),j=()=>{const e=Object(D.parse)(P.location.search);return{wf:e.wf,pe:e.pe,ou:e.ou,ouDisplayName:e.ouDisplayName}},W=()=>{const{wf:e,pe:t,ou:a}=j();if(e&&t&&a){const r=a.split("/");return{wf:e,pe:t,ou:r[r.length-1]}}return null},U=()=>{const[e,t]=Object(o.useState)(W);return Object(o.useEffect)((()=>P.listen((()=>{t(W())}))),[]),e},Y={approvalStatus:{resource:"dataApprovals",params:({wf:e,pe:t,ou:a})=>({wf:e,pe:t,ou:a})}},T=({children:e})=>{const t=U(),{displayName:a,dataSets:r}=(e=>{const{dataApprovalWorkflows:t}=w();return e&&e.wf&&t&&t.find((({id:t})=>t===e.wf))||{}})(t),{loading:l,error:i,data:c,called:m,refetch:y}=Object(s.f)(Y,{lazy:!0});if(Object(o.useEffect)((()=>{t&&y(t)}),[t]),!t||!m)return null;if(l)return n.a.createElement(d,null);if(i)return n.a.createElement(p,{title:u.a.t("Could not load approval data")},i.message);const{state:f,...g}=c.approvalStatus;return n.a.createElement(b.Provider,{value:{displayName:a,dataSets:r,approvalState:f,allowedActions:g,params:t,refresh:y}},e)},R=()=>Object(o.useContext)(b),I={resource:"dataAcceptances",type:"create",params:({wf:e,pe:t,ou:a})=>({wf:e,pe:t,ou:a})},B=()=>{const[e,{loading:t,error:a}]=Object(s.e)(I),{params:l,refresh:i}=R(),{show:c}=Object(s.b)(u.a.t("Acceptance failed: {{error}}",{error:a?a.toString():"",nsSeparator:null}));return Object(o.useEffect)((()=>{null!==a&&void 0!==a&&a.message&&c()}),[null===a||void 0===a?void 0:a.message]),n.a.createElement(r.c,{small:!0,disabled:t,onClick:async()=>{const{wf:t,pe:a,ou:r}=l;await e({wf:t,pe:a,ou:r}),i()}},u.a.t("Accept"))};var L=a(497),M=a.n(L);const z=({onApprove:e,onCancel:t,error:a})=>{const{dataSets:o}=R(),l=o.length;return n.a.createElement(r.x,null,n.a.createElement(r.A,null,l>1?u.a.t("Approving {{count}} data sets",{count:l}):u.a.t("Approving {{count}} data set",{count:l})),n.a.createElement(r.z,null,n.a.createElement("div",{className:M.a.summary},n.a.createElement("h1",{className:M.a.summaryTitle},l>1?u.a.t("{{count}} data sets will be approved:",{count:l}):u.a.t("{{count}} data set will be approved:",{count:l})),false,n.a.createElement("ul",{className:M.a.summaryList},o.map((({id:e,displayName:t})=>n.a.createElement("li",{className:M.a.summaryListItem,key:e},t))))),n.a.createElement("p",{className:M.a.confirmationStatement},u.a.t("Are you sure you want to approve this data?")),a&&n.a.createElement(r.B,{error:!0,title:u.a.t("There was a problem saving this approval")},u.a.t("This data couldn\u2019t be approved. Try again, or contact your system administrator."))),n.a.createElement(r.y,null,n.a.createElement(r.d,null,n.a.createElement(r.c,{onClick:t},u.a.t("Cancel")),n.a.createElement(r.c,{primary:!0,onClick:e},u.a.t("Approve")))))},J={resource:"dataApprovals",type:"create",params:({wf:e,pe:t,ou:a})=>({wf:e,pe:t,ou:a})},q=({disabled:e})=>{const[t,a]=Object(o.useState)(null),[l,i]=Object(o.useState)(!1),{params:c,refresh:p}=R(),d=()=>i(!1),{show:m}=Object(s.b)(u.a.t("Approval saved")),[y,{loading:f,error:g}]=(({onComplete:e,onError:t})=>Object(s.e)(J,{onComplete:e,onError:t}))({onComplete:()=>{m(),p(),d()},onError:e=>a(e)}),h=g||t;return n.a.createElement(n.a.Fragment,null,n.a.createElement(r.c,{primary:!0,small:!0,disabled:e,onClick:()=>i(!0)},u.a.t("Approve")),l&&n.a.createElement(z,{error:h,loading:f,onApprove:()=>{const{wf:e,pe:t,ou:a}=c;y({wf:e,pe:t,ou:a})},onCancel:d}))};var V=a(498),H=a.n(V);const G=({children:e})=>n.a.createElement("div",{className:H.a.bottomBarItem},e);var Q=a(499),X=a.n(Q);const K={resource:"dataAcceptances",type:"delete",params:({wf:e,pe:t,ou:a})=>({wf:e,pe:t,ou:a})},Z=()=>{const[e,{loading:t,error:a}]=Object(s.e)(K),{params:l,refresh:i}=R(),{show:c}=Object(s.b)(u.a.t("Unacceptance failed: {{error}}",{error:a?a.toString():"",nsSeparator:null}));return Object(o.useEffect)((()=>{null!==a&&void 0!==a&&a.message&&c()}),[null===a||void 0===a?void 0:a.message]),n.a.createElement(r.c,{small:!0,disabled:t,onClick:async()=>{const{wf:t,pe:a,ou:r}=l;await e({wf:t,pe:a,ou:r}),i()}},u.a.t("Unaccept"))},ee={resource:"dataApprovals",type:"delete",params:({wf:e,pe:t,ou:a})=>({wf:e,pe:t,ou:a})},te=()=>{const[e,{loading:t,error:a}]=Object(s.e)(ee),{params:l,refresh:i}=R(),{show:c}=Object(s.b)(u.a.t("Unapproval failed: {{error}}",{error:a?a.toString():"",nsSeparator:null}));return Object(o.useEffect)((()=>{null!==a&&void 0!==a&&a.message&&c()}),[null===a||void 0===a?void 0:a.message]),n.a.createElement(r.c,{small:!0,disabled:t,onClick:async()=>{const{wf:t,pe:a,ou:r}=l;await e({wf:t,pe:a,ou:r}),i()}},u.a.t("Unapprove"))},ae=()=>{const{allowedActions:e,approvalState:t}=R(),{mayAccept:a,mayApprove:r,mayUnaccept:o,mayUnapprove:l}=e,s=!r&&!l;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:X.a.bottomBar},n.a.createElement(G,null,n.a.createElement(g,{approvalState:t})),(r||s)&&n.a.createElement(G,null,n.a.createElement(q,{disabled:s})),a&&n.a.createElement(G,null,n.a.createElement(B,null)),l&&n.a.createElement(G,null,n.a.createElement(te,null)),o&&n.a.createElement(G,null,n.a.createElement(Z,null))))},re=({dataSets:e,selected:t,onChange:a})=>n.a.createElement(r.F,{scrollable:!0},e.map((e=>n.a.createElement(r.E,{key:e.id,onClick:()=>a(e.id),selected:e.id===t},e.displayName))));var oe=a(500),ne=a.n(oe);const le=({title:e,columns:t,rows:a})=>n.a.createElement(n.a.Fragment,null,n.a.createElement(r.m,null,e),n.a.createElement(r.i,null,n.a.createElement(r.H,null,n.a.createElement(r.l,null,t.map((e=>n.a.createElement(r.k,{key:e},e))))),n.a.createElement(r.G,null,a.map(((e,t)=>n.a.createElement(r.l,{key:t},e.map(((e,t)=>n.a.createElement(r.j,{key:t},e))))))))),se={dataSetReport:{resource:"dataSetReport",params:({ds:e,pe:t,ou:a})=>({ds:e,pe:t,ou:a})}},ie=({workflowName:e,periodId:t,organisationUnitId:a,dataSetId:l})=>{const{called:i,loading:c,data:p,error:d,refetch:m}=Object(s.f)(se,{lazy:!0}),y=null===p||void 0===p?void 0:p.dataSetReport,f=()=>{m({ds:l,pe:t,ou:a})};return Object(o.useEffect)((()=>{l&&f()}),[l]),l?d?n.a.createElement("div",{className:ne.a.display},n.a.createElement(r.B,{error:!0,title:u.a.t("There was a problem displaying this data set")},n.a.createElement("p",null,u.a.t("This data set couldn't be loaded or displayed. Try again, or contact your system administrator.")),n.a.createElement("button",{className:ne.a.retryButton,onClick:f},u.a.t("Retry loading data set")))):!i||c?n.a.createElement("div",{className:ne.a.display},n.a.createElement("div",{className:ne.a.loadingWrapper},n.a.createElement(r.f,{small:!0}),u.a.t("Loading data set"))):0===y.length?n.a.createElement("div",{className:ne.a.noData},n.a.createElement("p",null,u.a.t("This data set doesn't have any data for the selected period and organisation unit."))):n.a.createElement("div",{className:ne.a.display},y.map((e=>n.a.createElement(le,{key:e.title,title:e.title,columns:e.headers.map((e=>e.name)),rows:e.rows})))):n.a.createElement("div",{className:ne.a.chooseDataSet},n.a.createElement("h2",null,u.a.t("Choose a data set to review")),n.a.createElement("p",null,u.a.t("{{- workflowName}} has multiple data sets. Choose a data set from the tabs above.",{workflowName:e})))};var ce=a(501),pe=a.n(ce);const de=({name:e,dataSetsCount:t,approvalState:a})=>n.a.createElement("div",{className:pe.a.titleBar},n.a.createElement("span",{className:pe.a.workflowName},e),n.a.createElement("span",{className:pe.a.workflowDataSetsCount},n.a.createElement(r.s,null),u.a.t("{{dataSetsCount}} data sets",{dataSetsCount:t})),n.a.createElement(g,{approvalState:a})),ue=()=>{const{pe:e,ou:t}=U(),a=R(),[r,l]=Object(o.useState)(1===a.dataSets.length?a.dataSets[0].id:null);return n.a.createElement(n.a.Fragment,null,n.a.createElement(de,{name:a.displayName,dataSetsCount:a.dataSets.length,approvalState:a.approvalState}),n.a.createElement(re,{dataSets:a.dataSets,selected:r,onChange:l}),n.a.createElement(ie,{workflowName:a.displayName,periodId:e,organisationUnitId:t,dataSetId:r}))},me=()=>{throw new Error("Selection Context has not been initialized")},ye=Object(o.createContext)({workflow:{},setWorkflow:me,period:{},setPeriod:me,orgUnit:{},setOrgUnit:me});var fe=a(502),ge=a.n(fe);const he=({children:e,prefix:t,placeholder:a,value:l,onClose:s,onOpen:i,disabled:c,open:p,requiredValuesMessage:d})=>{const u=Object(o.useRef)(),m=p?r.r:r.q,y=n.a.createElement("button",{ref:u,className:ge.a.button,onClick:i,disabled:c},n.a.createElement("span",{className:ge.a.prefix},t),n.a.createElement("span",{className:ge.a.value},l||!c&&a),n.a.createElement(m,{color:c?r.K.grey600:void 0}));return n.a.createElement(n.a.Fragment,null,c?n.a.createElement(r.J,{content:d,placement:"bottom"},(({ref:e,onMouseOver:t,onMouseOut:a})=>n.a.createElement("div",{ref:e,onMouseOver:t,onMouseOut:a,className:ge.a.tooltipwrap},y))):y,p&&n.a.createElement(r.D,{reference:u,arrow:!1,placement:"bottom-end",onClickOutside:s},e))},ve="Daily",we="Weekly",Ee="WeeklyWednesday",be="WeeklyThursday",De="WeeklySaturday",Se="WeeklySunday",ke="BiWeekly",Ne="Monthly",_e="BiMonthly",Oe="Quarterly",Ae="SixMonthly",Fe="SixMonthlyApril",$e="Yearly",Ce="FinancialApril",xe="FinancialJuly",Pe="FinancialOct",je="FinancialNov",We=e=>[u.a.t("January"),u.a.t("February"),u.a.t("March"),u.a.t("April"),u.a.t("May"),u.a.t("June"),u.a.t("July"),u.a.t("August"),u.a.t("September"),u.a.t("October"),u.a.t("November"),u.a.t("December")][e],Ue=(e,t,a)=>r=>{let o=[];const n=parseInt(r.offset,10),l=r.filterFuturePeriods,s=r.reversePeriods,i=new Date(Date.now()).getFullYear()+n,c=((e,t)=>{const a=new Date(e,0,4),r=a.getDay(),o=a,n=r-t;return n>0?o.setDate(a.getDate()-n):n<0&&(o.setDate(a.getDate()-n),o.setDate(o.getDate()-7)),o})(i,t.startDay);let p=1;for(;c.getFullYear()<=i;){const a={};a.startDate=e(c),a.iso=`${i}${t.shortName}W${p}`,a.id=a.iso,c.setDate(c.getDate()+6),a.endDate=e(c);const r=p;if(a.displayName=`${u.a.t("Week {{weekNumber}}",{weekNumber:r})} - ${a.startDate} - ${a.endDate}`,c.getFullYear()>i&&c.getDate()>=4)break;o.push(a),c.setDate(c.getDate()+1),p+=1}return o=l?a(o):o,o=s?o.reverse():o,o},Ye=(e,t)=>a=>{let r=[];const o=parseInt(a.offset,10),n=a.filterFuturePeriods,l=a.reversePeriods,s=new Date(Date.now()).getFullYear()+o,i=new Date(`01 Jan ${s}`),c=i.getDay();let p=1;for(c<=4?i.setDate(i.getDate()-(c-1)):i.setDate(i.getDate()+(8-c));i.getFullYear()<=s;){const t={};t.iso=`${s}BiW${p}`,t.id=t.iso,t.startDate=e(i),i.setDate(i.getDate()+13),t.endDate=e(i);const a=p;if(t.displayName=`${u.a.t("Bi-Week {{biWeekNumber}}",{biWeekNumber:a})} - ${t.startDate} - ${t.endDate}`,i.getFullYear()>s&&i.getDate()>=4)break;r.push(t),i.setDate(i.getDate()+1),p+=1}return r=n?t(r):r,r=l?r.reverse():r,r},Te=(e,t)=>{const a=e=>{const t=e.getFullYear();let a=String(e.getMonth()+1);return a=a.length<2?`0${a}`:a,t+a};return r=>{let o=[];const n=parseInt(r.offset,10),l=r.filterFuturePeriods,s=r.reversePeriods,i=new Date(Date.now()).getFullYear()+n,c=new Date(`31 Dec ${i}`);for(;c.getFullYear()===i;){const t={};t.endDate=e(c),c.setDate(1),t.startDate=e(c);const r=We(c.getMonth());t.displayName=`${r} ${i}`,t.iso=a(c),t.id=t.iso,o.push(t),c.setDate(0)}return o=l?t(o):o,o=s?o:o.reverse(),o}},Re=(e,t)=>a=>{let r=[];const o=parseInt(a.offset,10),n=a.filterFuturePeriods,l=a.reversePeriods,s=new Date(Date.now()).getFullYear()+o,i=new Date(`31 Dec ${s}`);let c=6;for(;i.getFullYear()===s;){const t={};t.endDate=e(i),i.setDate(0),i.setDate(1),t.startDate=e(i);const a=We(i.getMonth()),o=We(i.getMonth()+1),n=i.getFullYear();t.displayName=`${a} - ${o} ${n}`,t.iso=`${s}0${c}B`,t.id=t.iso,r.push(t),i.setDate(0),c--}return r=n?t(r):r,r=l?r:r.reverse(),r},Ie=(e,t)=>a=>{let r=[];const o=parseInt(a.offset,10),n=a.filterFuturePeriods,l=a.reversePeriods,s=new Date(Date.now()).getFullYear()+o,i=new Date(`31 Dec ${s}`);let c=4;for(;i.getFullYear()===s;){const t={};t.endDate=e(i),i.setDate(0),i.setDate(0),i.setDate(1),t.startDate=e(i);const a=We(i.getMonth()),o=We(i.getMonth()+2),n=i.getFullYear();t.displayName=`${a} - ${o} ${n}`,t.iso=`${s}Q${c}`,t.id=t.iso,r.push(t),i.setDate(0),c-=1}return r=n?t(r):r,r=l?r:r.reverse(),r},Be=e=>t=>{let a=[];const r=parseInt(t.offset,10),o=t.filterFuturePeriods,n=t.reversePeriods,l=new Date(Date.now()).getFullYear()+r;let s={};return s.startDate=`${l}-01-01`,s.endDate=`${l}-06-30`,s.displayName=`${We(0)} - ${We(5)} ${l}`,s.iso=`${l}S1`,s.id=s.iso,a.push(s),s={},s.startDate=`${l}-07-01`,s.endDate=`${l}-12-31`,s.displayName=`${We(6)} - ${We(11)} ${l}`,s.iso=`${l}S2`,s.id=s.iso,a.push(s),a=o?e(a):a,a=n?a.reverse():a,a},Le=e=>t=>{let a=[];const r=parseInt(t.offset,10),o=t.filterFuturePeriods,n=t.reversePeriods,l=new Date(Date.now()).getFullYear()+r;let s={};return s.startDate=`${l}-04-01`,s.endDate=`${l}-09-30`,s.displayName=`${We(3)} - ${We(8)} ${l}`,s.iso=`${l}AprilS1`,s.id=s.iso,a.push(s),s={},s.startDate=`${l}-10-01`,s.endDate=`${l+1}-03-31`,s.displayName=`${We(9)} ${l} - ${We(2)} ${l+1}`,s.iso=`${l}AprilS2`,s.id=s.iso,a.push(s),a=o?e(a):a,a=n?a.reverse():a,a},Me=(e,t)=>a=>{let r=[];const o=parseInt(a.offset,10),n=a.filterFuturePeriods,l=a.reversePeriods,s=new Date(Date.now()).getFullYear()+o,i=new Date(`31 Dec ${s}`);for(;s-i.getFullYear()<10;){const t={};t.endDate=e(i),i.setMonth(0,1),t.startDate=e(i);const a=i.getFullYear().toString();t.displayName=a,t.iso=i.getFullYear().toString(),t.id=t.iso.toString(),r.push(t),i.setDate(0)}return r=n?t(r):r,r=l?r:r.reverse(),r},ze=(e,t)=>a=>{let r=[];const o=parseInt(a.offset,10),n=a.filterFuturePeriods,l=a.reversePeriods,s=new Date(Date.now()).getFullYear()+o,i=new Date(`30 Sep ${s+1}`);for(let t=0;t<10;t++){const t={};t.endDate=e(i),i.setYear(i.getFullYear()-1),i.setDate(i.getDate()+1),t.startDate=e(i);const a=i.getFullYear(),o=i.getFullYear()+1;t.displayName=`${We(9)} ${a} - ${We(8)} ${o}`,t.id=`${i.getFullYear()}Oct`,r.push(t),i.setDate(i.getDate()-1)}return r=n?t(r):r,r=l?r:r.reverse(),r},Je=(e,t)=>a=>{let r=[];const o=parseInt(a.offset,10),n=a.filterFuturePeriods,l=a.reversePeriods,s=new Date(Date.now()).getFullYear()+o,i=new Date(`31 Oct ${s+1}`);for(let t=0;t<10;t++){const t={};t.endDate=e(i),i.setYear(i.getFullYear()-1),i.setDate(i.getDate()+1),t.startDate=e(i);const a=i.getFullYear(),o=i.getFullYear()+1;t.displayName=`${We(10)} ${a} - ${We(9)} ${o}`,t.id=`${i.getFullYear()}Nov`,r.push(t),i.setDate(i.getDate()-1)}return r=n?t(r):r,r=l?r:r.reverse(),r},qe=(e,t)=>a=>{let r=[];const o=parseInt(a.offset,10),n=a.filterFuturePeriods,l=a.reversePeriods,s=new Date(Date.now()).getFullYear()+o,i=new Date(`30 Jun ${s+1}`);for(let t=0;t<10;t++){const t={};t.endDate=e(i),i.setYear(i.getFullYear()-1),i.setDate(i.getDate()+1),t.startDate=e(i);const a=i.getFullYear(),o=i.getFullYear()+1;t.displayName=`${We(6)} ${a} - ${We(5)} ${o}`,t.id=`${i.getFullYear()}July`,r.push(t),i.setDate(i.getDate()-1)}return r=n?t(r):r,r=l?r:r.reverse(),r},Ve=(e,t)=>a=>{let r=[];const o=parseInt(a.offset,10),n=a.filterFuturePeriods,l=a.reversePeriods,s=new Date(Date.now()).getFullYear()+o,i=new Date(`31 Mar ${s+1}`);for(let t=0;t<10;t++){const t={};t.endDate=e(i),i.setYear(i.getFullYear()-1),i.setDate(i.getDate()+1),t.startDate=e(i);const a=i.getFullYear(),o=i.getFullYear()+1;t.displayName=`${We(3)} ${a} - ${We(2)} ${o}`,t.id=`${i.getFullYear()}April`,r.push(t),i.setDate(i.getDate()-1)}return r=n?t(r):r,r=l?r:r.reverse(),r},He=e=>{const t=e.getFullYear();let a=String(e.getMonth()+1),r=String(e.getDate());return a=a.length<2?`0${a}`:a,r=r.length<2?`0${r}`:r,`${t}-${a}-${r}`},Ge=e=>{const t=[],a=new Date(Date.now());for(let r=0;r<e.length;r++)new Date(e[r].startDate)<=a&&t.push(e[r]);return t},Qe=()=>{return[{type:ve,regex:/^([0-9]{4})([0-9]{2})([0-9]{2})$/,getPeriods:(e=He,t=Ge,a=>{let r=[];const o=parseInt(a.offset,10),n=a.filterFuturePeriods,l=a.reversePeriods,s=new Date(Date.now()).getFullYear()+o,i=new Date(`01 Jan ${s}`);for(;i.getFullYear()===s;){const t={};t.startDate=e(i),t.endDate=t.startDate,t.displayName=t.startDate,t.iso=t.startDate.replace(/-/g,""),t.id=t.iso,r.push(t),i.setDate(i.getDate()+1)}return r=n?t(r):r,r=l?r.reverse():r,r}),displayName:u.a.t("Daily")},{type:we,regex:/^([0-9]{4})()W([0-9]{1,2})$/,getPeriods:Ue(He,{shortName:"",startDay:1},Ge),displayName:u.a.t("Weekly")},{type:Ee,regex:/^([0-9]{4})(Wed)W([0-9]{1,2})$/,getPeriods:Ue(He,{shortName:"Wed",startDay:3},Ge),displayName:u.a.t("Weekly (Start Wednesday)")},{type:be,regex:/^([0-9]{4})(Thu)W([0-9]{1,2})$/,getPeriods:Ue(He,{shortName:"Thu",startDay:4},Ge),displayName:u.a.t("Weekly (Start Thursday)")},{type:De,regex:/^([0-9]{4})(Sat)W([0-9]{1,2})$/,getPeriods:Ue(He,{shortName:"Sat",startDay:6},Ge),displayName:u.a.t("Weekly (Start Saturday)")},{type:Se,regex:/^([0-9]{4})(Sun)W([0-9]{1,2})$/,getPeriods:Ue(He,{shortName:"Sun",startDay:7},Ge),displayName:u.a.t("Weekly (Start Sunday)")},{type:ke,regex:/^([0-9]{4})BiW([0-9]{1,2})$/,getPeriods:Ye(He,Ge),displayName:u.a.t("Bi-weekly")},{type:Ne,regex:/^([0-9]{4})([0-9]{2})$/,getPeriods:Te(He,Ge),displayName:u.a.t("Monthly")},{type:_e,regex:/^([0-9]{4})([0-9]{2})B$/,getPeriods:Re(He,Ge),displayName:u.a.t("Bi-monthly")},{type:Oe,regex:/^([0-9]{4})Q([1234])$/,getPeriods:Ie(He,Ge),displayName:u.a.t("Quarterly")},{type:Ae,regex:/^([0-9]{4})S([12])$/,getPeriods:Be(Ge),displayName:u.a.t("Six-monthly")},{type:Fe,regex:/^([0-9]{4})AprilS([12])$/,getPeriods:Le(Ge),displayName:u.a.t("Six-monthly April")},{type:$e,regex:/^([0-9]{4})$/,getPeriods:Me(He,Ge),displayName:u.a.t("Yearly")},{type:je,regex:/^([0-9]{4})Nov$/,getPeriods:Je(He,Ge),displayName:u.a.t("Financial year (Start November)")},{type:Pe,regex:/^([0-9]{4})Oct$/,getPeriods:ze(He,Ge),displayName:u.a.t("Financial year (Start October)")},{type:xe,regex:/^([0-9]{4})July$/,getPeriods:qe(He,Ge),displayName:u.a.t("Financial year (Start July)")},{type:Ce,regex:/^([0-9]{4})April$/,getPeriods:Ve(He,Ge),displayName:u.a.t("Financial year (Start April)")}];var e,t},Xe=e=>e-new Date(Date.now()).getFullYear(),Ke=(e,t)=>{const a=(e=>Qe().find((t=>t.type===e)))(e),r=Xe(t);return a&&Number.isInteger(r)?a.getPeriods({offset:r}):void 0};var Ze=a(503),et=a.n(Ze);const tt=({periodType:e,year:t})=>{const{workflow:a,period:o,orgUnit:l,selectPeriod:s}=Et(),i=Ke(e,t);return n.a.createElement(r.v,{dense:!0,className:et.a.menu},i.map((e=>n.a.createElement(r.w,{active:e.id===o.id,key:e.id,href:S({wf:a.id,ou:l.path,pe:e.id}),label:e.displayName,onClick:()=>s(e)}))))};var at=a(504),rt=a.n(at);const ot=(new Date).getFullYear(),nt=({year:e,onYearChange:t})=>n.a.createElement("div",{className:rt.a.container},n.a.createElement(r.c,{disabled:1970===e,onClick:()=>t(e-1),icon:n.a.createElement(r.o,null)}),n.a.createElement("span",{className:rt.a.year},e),n.a.createElement(r.c,{disabled:e===ot,onClick:()=>t(e+1),icon:n.a.createElement(r.p,null)})),lt="PERIOD",st=()=>{const{period:e,workflow:t,selectPeriod:a,openedSelect:r,setOpenedSelect:l}=Et(),[s,i]=Object(o.useState)(e.year||ot),c=r===lt,p=e.displayName;return Object(o.useEffect)((()=>{e.year&&i(e.year)}),[e]),n.a.createElement(he,{prefix:u.a.t("Period"),placeholder:u.a.t("Choose a period"),value:p,open:c,disabled:!t.id,onOpen:()=>l(lt),onClose:()=>l(""),requiredValuesMessage:u.a.t("Choose a workflow first")},n.a.createElement(nt,{year:s,onYearChange:e=>{a({}),i(e)}}),n.a.createElement(tt,{periodType:t.periodType,year:s}))},it=e=>{const{wf:t,pe:a,ou:r,ouDisplayName:o}=j(),n=ct(e,t);return{workflow:n,period:pt(a,n),orgUnit:dt(r,o)}},ct=(e,t)=>t?e.find((e=>e.id===t))||{}:1===e.length?e[0]:{},pt=(e,t={})=>e&&t.id&&((e,t)=>{const a=t?Qe().filter((({type:e})=>t.some((t=>t===e)))):Qe();let r,o,n=0;for(;n<a.length&&!o;)r=a[n],o=e.match(r.regex),n++;if(!o)return;const l=parseInt(o[1]),s=Xe(l);return{...r.getPeriods({offset:s}).find((t=>t.id===e)),year:l,periodType:r}})(e,[t.periodType])||{},dt=(e,t)=>e&&t?{path:e,displayName:t}:{},ut="SET_OPENED_SELECT",mt="CLEAR_ALL",yt="SELECT_WORKFLOW",ft="SELECT_PERIOD",gt="SELECT_ORG_UNIT",ht="SET_STATE_FROM_QUERY_PARAMS",vt=(e,{type:t,payload:a})=>{switch(t){case ut:return{...e,openedSelect:a.openedSelect};case mt:return{openedSelect:"",workflow:a.workflow,period:{},orgUnit:{}};case yt:return{...e,openedSelect:"",workflow:a.workflow,period:e.workflow&&e.workflow.periodType===a.workflow.periodType?e.period:{}};case ft:return{...e,openedSelect:a.period.id?"":e.openedSelect,period:a.period};case gt:return{...e,openedSelect:"",orgUnit:a.orgUnit};case ht:return{openedSelect:"",...it(a.dataApprovalWorkflows)};default:return e}},wt=({children:e})=>{const{dataApprovalWorkflows:t}=w(),[{openedSelect:a,workflow:r,period:l,orgUnit:s},i]=Object(o.useReducer)(vt,{openedSelect:"",...it(t)}),c={workflow:r,period:l,orgUnit:s,openedSelect:a,clearAll:()=>i({type:mt,payload:{workflow:ct(t)}}),setOpenedSelect:e=>i({type:ut,payload:{openedSelect:e}}),selectWorkflow:e=>i({type:yt,payload:{workflow:e}}),selectPeriod:e=>i({type:ft,payload:{period:e}}),selectOrgUnit:e=>i({type:gt,payload:{orgUnit:e}})};return Object(o.useEffect)((()=>{(e=>{const t=Object(D.stringify)({wf:e.workflow.id,pe:e.period.id,ou:e.orgUnit.path,ouDisplayName:e.orgUnit.displayName}),a=t?`?${t}`:"";a!==P.location.search&&P.push({pathname:"/",search:a})})({workflow:r,period:l,orgUnit:s})}),[r,l,s]),Object(o.useEffect)((()=>{const e=()=>{i({type:ht,payload:{dataApprovalWorkflows:t}})};return window.addEventListener("popstate",e),()=>{window.removeEventListener("popstate",e)}}),[]),n.a.createElement(ye.Provider,{value:c},e)},Et=()=>Object(o.useContext)(ye);var bt=a(505),Dt=a.n(bt);const St=()=>{const{clearAll:e,period:t,orgUnit:a}=Et();return t.id||a.path?n.a.createElement(r.c,{className:Dt.a.button,secondary:!0,onClick:e},u.a.t("Clear selections")):null};var kt=a(506),Nt=a.n(kt);const _t="ORG_UNIT",Ot=()=>{const{organisationUnits:e}=w(),{orgUnit:t,selectOrgUnit:a,workflow:o,period:l,openedSelect:s,setOpenedSelect:i}=Et(),c=s===_t,p=t.displayName,d=o.id?u.a.t("Choose a period first"):u.a.t("Choose a workflow and period first"),m=e.map((({id:e})=>e)),y=t.path?[t.path]:void 0;return n.a.createElement(he,{prefix:u.a.t("Organisation Unit"),placeholder:u.a.t("Choose an organisation unit"),value:p,open:c,disabled:!(o.id&&l.id),onOpen:()=>i(_t),onClose:()=>i(""),requiredValuesMessage:d},n.a.createElement("div",{className:Nt.a.scrollbox},n.a.createElement(r.C,{roots:m,onChange:({displayName:e,id:t,path:r})=>{a({displayName:e,id:t,path:r})},initiallyExpanded:y,selected:y,singleSelection:!0})))};var At=a(507),Ft=a.n(At);const $t=({id:e,name:t,periodType:a,active:o,onClick:l})=>{const s=n.a.createElement("div",{className:Ft.a.option},n.a.createElement("span",{className:Ft.a.title},t),n.a.createElement("span",{className:Ft.a.subtitle},a||"UNAVAILABLE"));return n.a.createElement(r.w,{href:S({wf:e}),className:Ft.a.bordered,active:o,onClick:l,label:s})};var Ct=a(508),xt=a.n(Ct);const Pt="WORKFLOW",jt=()=>{const{dataApprovalWorkflows:e}=w(),{workflow:t,selectWorkflow:a,openedSelect:o,setOpenedSelect:l}=Et(),s=o===Pt,i=t.displayName;return n.a.createElement(he,{prefix:u.a.t("Workflow"),placeholder:u.a.t("Choose a workflow"),value:i,open:s,onOpen:()=>l(Pt),onClose:()=>l("")},0===e.length?n.a.createElement("div",{className:xt.a.message},u.a.t("No workflows found. None may exist, or you may not have access to any.")):n.a.createElement(r.v,null,e.map((e=>n.a.createElement($t,{key:e.id,id:e.id,name:e.displayName,periodType:e.periodType,active:e.id===t.id,onClick:()=>a(e)})))))},Wt=()=>n.a.createElement(wt,null,n.a.createElement(jt,null),n.a.createElement(st,null),n.a.createElement(Ot,null),n.a.createElement(St,null));var Ut=a(509),Yt=a.n(Ut);function Tt(){return(Tt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}const Rt=({children:e,className:t})=>n.a.createElement("div",{className:t},e),It=e=>n.a.createElement(Rt,Tt({},e,{className:Yt.a.container})),Bt=e=>n.a.createElement(Rt,Tt({},e,{className:Yt.a.top})),Lt=e=>n.a.createElement(Rt,Tt({},e,{className:Yt.a.content})),Mt=e=>n.a.createElement(Rt,Tt({},e,{className:Yt.a.bottom}));var zt=a(510);u.a.addResources("en","default",zt);u.a,t.default=()=>n.a.createElement(n.a.Fragment,null,n.a.createElement(r.h,{spacers:!0,colors:!0,theme:!0}),n.a.createElement(v,null,n.a.createElement(E,null,n.a.createElement(It,null,n.a.createElement(Bt,null,n.a.createElement(Wt,null)),n.a.createElement(T,null,n.a.createElement(Lt,null,n.a.createElement(ue,null)),n.a.createElement(Mt,null,n.a.createElement(ae,null)))))))}}]);
//# sourceMappingURL=app.98459f0a.chunk.js.map