(this["webpackJsonp@dhis2/app-shell"]=this["webpackJsonp@dhis2/app-shell"]||[]).push([[135],{514:function(e,t,a){e.exports={wrapper:"error-message_wrapper__17C15"}},515:function(e,t,a){e.exports={container:"approval-status-icon_container__1f38G"}},522:function(e,t,a){e.exports={summary:"approve-modal_summary__1abcn",summaryTitle:"approve-modal_summaryTitle__2sA2i",summaryList:"approve-modal_summaryList__1lufS",confirmationStatement:"approve-modal_confirmationStatement__1LDKw"}},523:function(e,t,a){e.exports={bottomBarItem:"bottom-bar-item_bottomBarItem__2GbAg"}},524:function(e,t,a){e.exports={bottomBar:"bottom-bar_bottomBar__2CojG"}},525:function(e,t,a){e.exports={display:"display_display__pmr3Z",chooseDataSet:"display_chooseDataSet__2HsJD display_display__pmr3Z",loadingWrapper:"display_loadingWrapper__iFDcl",noData:"display_noData__2YWIA display_display__pmr3Z",retryButton:"display_retryButton__3sQOQ",nonDefaultFormWarning:"display_nonDefaultFormWarning__3MIpe"}},526:function(e,t,a){e.exports={titleBar:"title-bar_titleBar__3Zvkn",workflowName:"title-bar_workflowName__1S55b",workflowDataSetsCount:"title-bar_workflowDataSetsCount__t1ej1"}},527:function(e,t,a){e.exports={button:"clear-all-button_button__mDEHm"}},528:function(e,t,a){e.exports={button:"context-select_button__1y8va",prefix:"context-select_prefix__3xDFu",value:"context-select_value__oltZj",tooltipwrap:"context-select_tooltipwrap__3Fqbe"}},529:function(e,t,a){e.exports={container:"approval-status-icons-legend_container__eFk9p",label:"approval-status-icons-legend_label__1zQia"}},530:function(e,t,a){e.exports={container:"approval-status-label_container__1xOLq",iconContainer:"approval-status-label_iconContainer__3bZcv",loadingIcon:"approval-status-label_loadingIcon__96xFy",loading:"approval-status-label_loading__3HPLn"}},531:function(e,t,a){e.exports={popoverContainer:"org-unit-select_popoverContainer__3jDDB",scrollbox:"org-unit-select_scrollbox__23k48"}},532:function(e,t,a){e.exports={menu:"period-menu_menu__2CHPS"}},533:function(e,t,a){e.exports={container:"year-navigator_container__3XXd2",year:"year-navigator_year__14nbM"}},534:function(e,t,a){e.exports={bordered:"workflow-select-option_bordered__JBAIX",option:"workflow-select-option_option__1cqTS",title:"workflow-select-option_title__3zrtv",subtitle:"workflow-select-option_subtitle__3yrup"}},535:function(e,t,a){e.exports={message:"workflow-select_message__1jq5N"}},536:function(e,t,a){e.exports={container:"layout_container__Cp-96",top:"layout_top__2gcI9",content:"layout_content__10QOH",bottom:"layout_bottom__2toTd"}},537:function(e){e.exports=JSON.parse('{"Not authorized":"Not authorized","You don\'t have access to the Data Approval App. Contact a system administrator to request access.":"You don\'t have access to the Data Approval App. Contact a system administrator to request access.","Acceptance failed: {{error}}":"Acceptance failed: {{error}}","Accept":"Accept","Approval saved":"Approval saved","Approve":"Approve","Approving {{count}} data sets":"Approving {{count}} data sets","Approving {{count}} data sets_plural":"Approving {{count}} data sets","Approving {{count}} data set":"Approving {{count}} data set","Approving {{count}} data set_plural":"Approving {{count}} data set","Are you sure you want to approve this data?":"Are you sure you want to approve this data?","There was a problem saving this approval":"There was a problem saving this approval","This data couldn\u2019t be approved. Try again, or contact your system administrator.":"This data couldn\u2019t be approved. Try again, or contact your system administrator.","Cancel":"Cancel","Unacceptance failed: {{error}}":"Unacceptance failed: {{error}}","Unaccept":"Unaccept","Unapproval failed: {{error}}":"Unapproval failed: {{error}}","Unapprove":"Unapprove","This workflow does not contain any data sets.":"This workflow does not contain any data sets.","Choose a data set to review":"Choose a data set to review","{{- workflowName}} has multiple data sets. Choose a data set from the tabs above.":"{{- workflowName}} has multiple data sets. Choose a data set from the tabs above.","Loading data set":"Loading data set","There was a problem displaying this data set":"There was a problem displaying this data set","This data set couldn\'t be loaded or displayed. Try again, or contact your system administrator.":"This data set couldn\'t be loaded or displayed. Try again, or contact your system administrator.","Retry loading data set":"Retry loading data set","This data set doesn\'t have any data for {{- period}} in {{- orgUnit}}.":"This data set doesn\'t have any data for {{- period}} in {{- orgUnit}}.","This data set may not display properly":"This data set may not display properly","This data set does not use a default form. The data is displayed as a simple grid below, but this might not be a suitable representation.":"This data set does not use a default form. The data is displayed as a simple grid below, but this might not be a suitable representation.","Displaying data from data sets using custom forms is currently not supported in this app. Please refer to the legacy app instead.":"Displaying data from data sets using custom forms is currently not supported in this app. Please refer to the legacy app instead.","1 data set":"1 data set","{{dataSetsCount}} data sets":"{{dataSetsCount}} data sets","Approved {{- dateTimeStr}}":"Approved {{- dateTimeStr}}","Approved by {{- name}} {{timeAgo}}":"Approved by {{- name}} {{timeAgo}}","Approved {{timeAgo}}":"Approved {{timeAgo}}","Approved by {{- name}}":"Approved by {{- name}}","Approved":"Approved","Ready for approval":"Ready for approval","Ready for approval \u2014 Accepted":"Ready for approval \u2014 Accepted","Waiting for lower level approval":"Waiting for lower level approval","Waiting for higher level approval":"Waiting for higher level approval","Cannot be approved":"Cannot be approved","Could not retrieve approval status":"Could not retrieve approval status","January":"January","February":"February","March":"March","April":"April","May":"May","June":"June","July":"July","August":"August","September":"September","October":"October","November":"November","December":"December","Week {{weekNumber}}":"Week {{weekNumber}}","Bi-Week {{biWeekNumber}}":"Bi-Week {{biWeekNumber}}","Daily":"Daily","Weekly":"Weekly","Weekly (Start Wednesday)":"Weekly (Start Wednesday)","Weekly (Start Thursday)":"Weekly (Start Thursday)","Weekly (Start Saturday)":"Weekly (Start Saturday)","Weekly (Start Sunday)":"Weekly (Start Sunday)","Bi-weekly":"Bi-weekly","Monthly":"Monthly","Bi-monthly":"Bi-monthly","Quarterly":"Quarterly","Six-monthly":"Six-monthly","Six-monthly April":"Six-monthly April","Yearly":"Yearly","Financial year (Start November)":"Financial year (Start November)","Financial year (Start October)":"Financial year (Start October)","Financial year (Start July)":"Financial year (Start July)","Financial year (Start April)":"Financial year (Start April)","Clear selections":"Clear selections","Waiting for approval":"Waiting for approval","Failed to load approval state":"Failed to load approval state","Choose a period first":"Choose a period first","Choose a workflow and period first":"Choose a workflow and period first","Organisation Unit":"Organisation Unit","Choose an organisation unit":"Choose an organisation unit","Period":"Period","Choose a period":"Choose a period","Choose a workflow first":"Choose a workflow first","Workflow":"Workflow","Choose a workflow":"Choose a workflow","No workflows found. None may exist, or you may not have access to any.":"No workflows found. None may exist, or you may not have access to any.","Could not load approval data":"Could not load approval data"}')},540:function(e,t,a){"use strict";a.r(t);var r=a(6),o=a(0),l=a.n(o);const n=Object(o.createContext)({authorities:[],organisationUnits:[],dataApprovalWorkflows:[]});var s=a(7),i=a(514),p=a.n(i);const d=({children:e,title:t})=>l.a.createElement("div",{className:p.a.wrapper},l.a.createElement(r.F,{error:!0,title:t},e));var c=a(5);const u="Daily",m="Weekly",y="WeeklyWednesday",v="WeeklyThursday",f="WeeklySaturday",g="WeeklySunday",w="BiWeekly",h="Monthly",E="BiMonthly",b="Quarterly",D="SixMonthly",N="SixMonthlyApril",A="Yearly",S="FinancialApril",_="FinancialJuly",k="FinancialOct",O="FinancialNov",C=new Set([u,m,y,v,f,g,w,h,E,b,D,N,A,S,_,k,O]),$=e=>C.has(e),P=e=>[c.a.t("January"),c.a.t("February"),c.a.t("March"),c.a.t("April"),c.a.t("May"),c.a.t("June"),c.a.t("July"),c.a.t("August"),c.a.t("September"),c.a.t("October"),c.a.t("November"),c.a.t("December")][e],F=()=>new Date(Date.now()),T=e=>{const t=parseInt(e,10)||0;return F().getFullYear()+t},x=(e,t,a)=>r=>{let o=[];const l=r.filterFuturePeriods,n=r.reversePeriods,s=T(r.offset),i=((e,t=1)=>{const a=new Date(e,0,4),r=a.getDay(),o=a,l=r-t;return l>0?o.setDate(a.getDate()-l):l<0&&(o.setDate(a.getDate()-l),o.setDate(o.getDate()-7)),o})(s,t.startDay);let p=1;for(;i.getFullYear()<=s;){const a={};a.startDate=e(i),a.iso=`${s}${t.shortName}W${p}`,a.id=a.iso,i.setDate(i.getDate()+6),a.endDate=e(i);const r=p;if(a.displayName=`${c.a.t("Week {{weekNumber}}",{weekNumber:r})} - ${a.startDate} - ${a.endDate}`,i.getFullYear()>s&&i.getDate()>=4)break;o.push(a),i.setDate(i.getDate()+1),p+=1}return o=l?a(o):o,o=n?o.reverse():o,o},W=(e,t)=>a=>{let r=[];const o=a.filterFuturePeriods,l=a.reversePeriods,n=T(a.offset),s=new Date(`01 Jan ${n}`),i=s.getDay();let p=1;for(i<=4?s.setDate(s.getDate()-(i-1)):s.setDate(s.getDate()+(8-i));s.getFullYear()<=n;){const t={};t.iso=`${n}BiW${p}`,t.id=t.iso,t.startDate=e(s),s.setDate(s.getDate()+13),t.endDate=e(s);const a=p;if(t.displayName=`${c.a.t("Bi-Week {{biWeekNumber}}",{biWeekNumber:a})} - ${t.startDate} - ${t.endDate}`,s.getFullYear()>n&&s.getDate()>=4)break;r.push(t),s.setDate(s.getDate()+1),p+=1}return r=o?t(r):r,r=l?r.reverse():r,r},I=(e,t)=>{const a=e=>{const t=e.getFullYear();let a=String(e.getMonth()+1);return a=a.length<2?`0${a}`:a,t+a};return r=>{let o=[];const l=r.filterFuturePeriods,n=r.reversePeriods,s=T(r.offset),i=new Date(`31 Dec ${s}`);for(;i.getFullYear()===s;){const t={};t.endDate=e(i),i.setDate(1),t.startDate=e(i);const r=P(i.getMonth());t.displayName=`${r} ${s}`,t.iso=a(i),t.id=t.iso,o.push(t),i.setDate(0)}return o=l?t(o):o,o=n?o:o.reverse(),o}},U=(e,t)=>a=>{let r=[];const o=a.filterFuturePeriods,l=a.reversePeriods,n=T(a.offset),s=new Date(`31 Dec ${n}`);let i=6;for(;s.getFullYear()===n;){const t={};t.endDate=e(s),s.setDate(0),s.setDate(1),t.startDate=e(s);const a=P(s.getMonth()),o=P(s.getMonth()+1),l=s.getFullYear();t.displayName=`${a} - ${o} ${l}`,t.iso=`${n}0${i}B`,t.id=t.iso,r.push(t),s.setDate(0),i--}return r=o?t(r):r,r=l?r:r.reverse(),r},R=(e,t)=>a=>{let r=[];const o=a.filterFuturePeriods,l=a.reversePeriods,n=T(a.offset),s=new Date(`31 Dec ${n}`);let i=4;for(;s.getFullYear()===n;){const t={};t.endDate=e(s),s.setDate(0),s.setDate(0),s.setDate(1),t.startDate=e(s);const a=P(s.getMonth()),o=P(s.getMonth()+2),l=s.getFullYear();t.displayName=`${a} - ${o} ${l}`,t.iso=`${n}Q${i}`,t.id=t.iso,r.push(t),s.setDate(0),i-=1}return r=o?t(r):r,r=l?r:r.reverse(),r},Y=e=>t=>{let a=[];const r=t.filterFuturePeriods,o=t.reversePeriods,l=T(t.offset);let n={};return n.startDate=`${l}-01-01`,n.endDate=`${l}-06-30`,n.displayName=`${P(0)} - ${P(5)} ${l}`,n.iso=`${l}S1`,n.id=n.iso,a.push(n),n={},n.startDate=`${l}-07-01`,n.endDate=`${l}-12-31`,n.displayName=`${P(6)} - ${P(11)} ${l}`,n.iso=`${l}S2`,n.id=n.iso,a.push(n),a=r?e(a):a,a=o?a.reverse():a,a},j=e=>t=>{let a=[];const r=t.filterFuturePeriods,o=t.reversePeriods,l=T(t.offset);let n={};return n.startDate=`${l}-04-01`,n.endDate=`${l}-09-30`,n.displayName=`${P(3)} - ${P(8)} ${l}`,n.iso=`${l}AprilS1`,n.id=n.iso,a.push(n),n={},n.startDate=`${l}-10-01`,n.endDate=`${l+1}-03-31`,n.displayName=`${P(9)} ${l} - ${P(2)} ${l+1}`,n.iso=`${l}AprilS2`,n.id=n.iso,a.push(n),a=r?e(a):a,a=o?a.reverse():a,a},B=(e,t)=>a=>{let r=[];const o=a.filterFuturePeriods,l=a.reversePeriods,n=T(a.offset),s=new Date(`31 Dec ${n}`);for(;n-s.getFullYear()<10;){const t={};t.endDate=e(s),s.setMonth(0,1),t.startDate=e(s);const a=s.getFullYear().toString();t.displayName=a,t.iso=s.getFullYear().toString(),t.id=t.iso.toString(),r.push(t),s.setDate(0)}return r=o?t(r):r,r=l?r:r.reverse(),r},L=(e,t)=>a=>{let r=[];const o=a.filterFuturePeriods,l=a.reversePeriods,n=T(a.offset),s=new Date(`30 Sep ${n+1}`);for(let t=0;t<10;t++){const t={};t.endDate=e(s),s.setYear(s.getFullYear()-1),s.setDate(s.getDate()+1),t.startDate=e(s);const a=s.getFullYear(),o=s.getFullYear()+1;t.displayName=`${P(9)} ${a} - ${P(8)} ${o}`,t.id=`${s.getFullYear()}Oct`,r.push(t),s.setDate(s.getDate()-1)}return r=o?t(r):r,r=l?r:r.reverse(),r},M=(e,t)=>a=>{let r=[];const o=a.filterFuturePeriods,l=a.reversePeriods,n=T(a.offset),s=new Date(`31 Oct ${n+1}`);for(let t=0;t<10;t++){const t={};t.endDate=e(s),s.setYear(s.getFullYear()-1),s.setDate(s.getDate()+1),t.startDate=e(s);const a=s.getFullYear(),o=s.getFullYear()+1;t.displayName=`${P(10)} ${a} - ${P(9)} ${o}`,t.id=`${s.getFullYear()}Nov`,r.push(t),s.setDate(s.getDate()-1)}return r=o?t(r):r,r=l?r:r.reverse(),r},V=(e,t)=>a=>{let r=[];const o=a.filterFuturePeriods,l=a.reversePeriods,n=T(a.offset),s=new Date(`30 Jun ${n+1}`);for(let t=0;t<10;t++){const t={};t.endDate=e(s),s.setYear(s.getFullYear()-1),s.setDate(s.getDate()+1),t.startDate=e(s);const a=s.getFullYear(),o=s.getFullYear()+1;t.displayName=`${P(6)} ${a} - ${P(5)} ${o}`,t.id=`${s.getFullYear()}July`,r.push(t),s.setDate(s.getDate()-1)}return r=o?t(r):r,r=l?r:r.reverse(),r},H=(e,t)=>a=>{let r=[];const o=a.filterFuturePeriods,l=a.reversePeriods,n=T(a.offset),s=new Date(`31 Mar ${n+1}`);for(let t=0;t<10;t++){const t={};t.endDate=e(s),s.setYear(s.getFullYear()-1),s.setDate(s.getDate()+1),t.startDate=e(s);const a=s.getFullYear(),o=s.getFullYear()+1;t.displayName=`${P(3)} ${a} - ${P(2)} ${o}`,t.id=`${s.getFullYear()}April`,r.push(t),s.setDate(s.getDate()-1)}return r=o?t(r):r,r=l?r:r.reverse(),r},z=e=>{const t=e.getFullYear();let a=String(e.getMonth()+1),r=String(e.getDate());return a=a.length<2?`0${a}`:a,r=r.length<2?`0${r}`:r,`${t}-${a}-${r}`},J=e=>{const t=[],a=F();for(let r=0;r<e.length;r++)new Date(e[r].startDate)<=a&&t.push(e[r]);return t},q=()=>{return[{type:u,regex:/^([0-9]{4})([0-9]{2})([0-9]{2})$/,getPeriods:(e=z,t=J,a=>{let r=[];const o=a.filterFuturePeriods,l=a.reversePeriods,n=T(a.offset),s=new Date(`01 Jan ${n}`);for(;s.getFullYear()===n;){const t={};t.startDate=e(s),t.endDate=t.startDate,t.displayName=t.startDate,t.iso=t.startDate.replace(/-/g,""),t.id=t.iso,r.push(t),s.setDate(s.getDate()+1)}return r=o?t(r):r,r=l?r.reverse():r,r}),displayName:c.a.t("Daily")},{type:m,regex:/^([0-9]{4})()W([0-9]{1,2})$/,getPeriods:x(z,{shortName:"",startDay:1},J),displayName:c.a.t("Weekly")},{type:y,regex:/^([0-9]{4})(Wed)W([0-9]{1,2})$/,getPeriods:x(z,{shortName:"Wed",startDay:3},J),displayName:c.a.t("Weekly (Start Wednesday)")},{type:v,regex:/^([0-9]{4})(Thu)W([0-9]{1,2})$/,getPeriods:x(z,{shortName:"Thu",startDay:4},J),displayName:c.a.t("Weekly (Start Thursday)")},{type:f,regex:/^([0-9]{4})(Sat)W([0-9]{1,2})$/,getPeriods:x(z,{shortName:"Sat",startDay:6},J),displayName:c.a.t("Weekly (Start Saturday)")},{type:g,regex:/^([0-9]{4})(Sun)W([0-9]{1,2})$/,getPeriods:x(z,{shortName:"Sun",startDay:7},J),displayName:c.a.t("Weekly (Start Sunday)")},{type:w,regex:/^([0-9]{4})BiW([0-9]{1,2})$/,getPeriods:W(z,J),displayName:c.a.t("Bi-weekly")},{type:h,regex:/^([0-9]{4})([0-9]{2})$/,getPeriods:I(z,J),displayName:c.a.t("Monthly")},{type:E,regex:/^([0-9]{4})([0-9]{2})B$/,getPeriods:U(z,J),displayName:c.a.t("Bi-monthly")},{type:b,regex:/^([0-9]{4})Q([1234])$/,getPeriods:R(z,J),displayName:c.a.t("Quarterly")},{type:D,regex:/^([0-9]{4})S([12])$/,getPeriods:Y(J),displayName:c.a.t("Six-monthly")},{type:N,regex:/^([0-9]{4})AprilS([12])$/,getPeriods:j(J),displayName:c.a.t("Six-monthly April")},{type:A,regex:/^([0-9]{4})$/,getPeriods:B(z,J),displayName:c.a.t("Yearly")},{type:O,regex:/^([0-9]{4})Nov$/,getPeriods:M(z,J),displayName:c.a.t("Financial year (Start November)")},{type:k,regex:/^([0-9]{4})Oct$/,getPeriods:L(z,J),displayName:c.a.t("Financial year (Start October)")},{type:_,regex:/^([0-9]{4})July$/,getPeriods:V(z,J),displayName:c.a.t("Financial year (Start July)")},{type:S,regex:/^([0-9]{4})April$/,getPeriods:H(z,J),displayName:c.a.t("Financial year (Start April)")}];var e,t},G=e=>{const t=parseInt(e,10);if(!Number.isInteger(t))throw new Error(`Invalid year "${e}" passed to "getYearOffsetFromNow"`);return t-F().getFullYear()},Q=(e,t)=>{const a=(e=>{if(!$(e))throw new Error(`Invalid period type "${e}" supplied to "getFixedPeriodType"`);const t=q().find((({type:t})=>t===e));if(!t)throw new Error(`Could not find periodType object for "${e}"`);return t})(e),r=G(t);return a&&Number.isInteger(r)?a.getPeriods({offset:r}):[]},Z=e=>!isNaN(e.getTime()),K=(e,t,a)=>{if(t=new Date(t),a=new Date(a),!Z(t))throw new Error("Invalid startDate provided to getFixedPeriodsForTypeAndDateRange");if(!Z(a))throw new Error("Invalid endDate provided to getFixedPeriodsForTypeAndDateRange");let r=a.getFullYear(),o=!1;const l=[];for(;!o;)Q(e,r).reverse().forEach((e=>{const r=new Date(e.endDate),n=r>=t;n||(o=!0),n&&r<=a&&l.push(e)})),--r;return l.reverse()},X=()=>l.a.createElement(r.e,null,l.a.createElement(r.f,null));var ee=a(20),te=a.n(ee);const ae=({color:e})=>l.a.createElement("svg",{height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg",color:e},l.a.createElement("path",{d:"m7 10.707-2.5-2.5005.7065-.7065 1.7935 1.793 3.7925-3.793.7075.7075zm1-9.707c-3.86599325 0-7 3.13400675-7 7 0 3.8659932 3.13400675 7 7 7 3.8659932 0 7-3.1340068 7-7 0-1.85651543-.7374979-3.63699282-2.0502525-4.94974747-1.3127547-1.31275465-3.09323207-2.05025253-4.9497475-2.05025253zm0 13c-3.3137085 0-6-2.6862915-6-6s2.6862915-6 6-6 6 2.6862915 6 6c0 1.59129894-.632141 3.1174224-1.7573593 4.2426407s-2.65134176 1.7573593-4.2426407 1.7573593z",fill:"currentColor",fillRule:"evenodd"})),re=({color:e})=>l.a.createElement("svg",{height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg",color:e},l.a.createElement("path",{d:"m8 1c-.46686 0-.92352.04577-1.36559.13323l.19407.98099c.3785-.07488.77017-.11422 1.17152-.11422s.79302.03934 1.17152.11422l.19407-.98099c-.44207-.08746-.89873-.13323-1.36559-.13323zm-3.88966 1.17934c-.76315.51091-1.42009 1.16785-1.931 1.931l.83097.55632c.43819-.65453 1.00182-1.21816 1.65635-1.65635zm9.71036 1.931c-.511-.76315-1.1679-1.42009-1.931-1.931l-.5564.83097c.6546.43819 1.2182 1.00182 1.6564 1.65635zm1.1793 3.88966c0-.46686-.0458-.92352-.1332-1.36559l-.981.19407c.0749.3785.1142.77017.1142 1.17152s-.0393.79302-.1142 1.17152l.981.19407c.0874-.44207.1332-.89873.1332-1.36559zm-13.86677-1.36559c-.08746.44207-.13323.89873-.13323 1.36559s.04577.92352.13323 1.36559l.98099-.19407c-.07488-.3785-.11422-.77017-.11422-1.17152s.03934-.79302.11422-1.17152zm1.04611 5.25529c.51091.7631 1.16785 1.42 1.931 1.931l.55632-.831c-.65453-.4382-1.21816-1.0018-1.65635-1.6564zm9.71036 1.931c.7631-.511 1.42-1.1679 1.931-1.931l-.831-.5564c-.4382.6546-1.0018 1.2182-1.6564 1.6564zm-5.25529 1.0461c.44207.0874.89873.1332 1.36559.1332s.92352-.0458 1.36559-.1332l-.19407-.981c-.3785.0749-.77017.1142-1.17152.1142s-.79302-.0393-1.17152-.1142zm3.36559-6.8668c0 1.10457-.89543 2-2 2s-2-.89543-2-2 .89543-2 2-2 2 .89543 2 2zm1 0c0 1.65685-1.34315 3-3 3s-3-1.34315-3-3 1.34315-3 3-3 3 1.34315 3 3z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})),oe=({color:e})=>l.a.createElement("svg",{height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg",color:e},l.a.createElement("path",{d:"M3 2H4H5H11H12H13V3H12V6.20711L10.2071 8L12 9.79289V13H13V14H12H11H5H4H3V13H4V9.79289L5.79289 8L4 6.20711V3H3V2ZM5 13H11V10.2071L8.79289 8L11 5.79289V3H5V5.79289L7.20711 8L5 10.2071V13Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})),le=({approvalStatus:e,approvedAt:t,approvedBy:a})=>{switch(e){case"UNAPPROVED_READY":return c.a.t("Ready for approval");case"ACCEPTED_HERE":return c.a.t("Ready for approval \u2014 Accepted");case"UNAPPROVED_WAITING":return c.a.t("Waiting for lower level approval");case"UNAPPROVED_ABOVE":return c.a.t("Waiting for higher level approval");case"APPROVED_HERE":case"APPROVED_ABOVE":return(({approvedAt:e,approvedBy:t})=>{if(e){const a=te()(e).fromNow();return t?c.a.t("Approved by {{- name}} {{timeAgo}}",{name:t,timeAgo:a}):c.a.t("Approved {{timeAgo}}",{timeAgo:a})}return t?c.a.t("Approved by {{- name}}",{name:t}):c.a.t("Approved")})({approvedAt:t,approvedBy:a});case"UNAPPROVABLE":return c.a.t("Cannot be approved");case"ERROR":return c.a.t("Could not retrieve approval status");default:throw new Error(`Unknown approval status: '${e}'`)}},ne=({approvalStatus:e,approvedAt:t,approvedBy:a})=>{const o=le({approvalStatus:e,approvedAt:t,approvedBy:a}),{icon:l,type:n}=(e=>{switch(e){case"UNAPPROVED_READY":case"ACCEPTED_HERE":return{icon:re,type:"neutral"};case"UNAPPROVED_WAITING":case"UNAPPROVED_ABOVE":return{icon:oe,type:"default"};case"APPROVED_HERE":case"APPROVED_ABOVE":return{icon:ae,type:"positive"};case"UNAPPROVABLE":return{icon:r.r,type:"negative"};case"ERROR":return{icon:r.v,type:"negative"};default:throw new Error(`Unknown approval status: '${e}'`)}})(e);return{displayName:o,icon:l,type:n}};function se(){return(se=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}const ie=({approvalStatus:e,approvedAt:t,approvedBy:a})=>{const{icon:o,displayName:n,type:s}=ne({approvalStatus:e,approvedAt:t,approvedBy:a}),i={[s]:!0,icon:l.a.createElement(o,null)},p=(e=>"APPROVED_HERE"===e||"APPROVED_ABOVE"===e)(e)&&t,d=l.a.createElement(r.M,se({},i,{maxWidth:"auto"}),n);if(!p)return d;const u=te()(t).format("LLL"),m=c.a.t("Approved {{- dateTimeStr}}",{dateTimeStr:u});return l.a.createElement(r.N,{content:m},d)};var pe=a(515),de=a.n(pe);const ce=e=>{switch(e){case"default":return r.O.grey500;case"neutral":return r.O.blue700;case"positive":return r.O.green600;case"negative":return r.O.red600}},ue=({approvalStatus:e,showTitle:t})=>{const{icon:a,displayName:r,type:o}=ne({approvalStatus:e});return l.a.createElement("span",{title:t?r:"",className:de.a.container},l.a.createElement(a,{color:ce(o)}))};ue.defaultProps={showTitle:!0};const me={me:{resource:"me",params:{fields:["authorities","organisationUnits[id,path]"]}},dataApprovalWorkflows:{resource:"dataApprovalWorkflows",params:{paging:!1,fields:["id","displayName","dataApprovalLevels","periodType","dataSets[id,displayName,periodType,formType]"]}}},ye=({children:e})=>{const{data:t,loading:a,error:o}=Object(s.g)(me);if(a)return l.a.createElement(r.y,null,l.a.createElement(X,null));if(o)throw o;const{authorities:i,organisationUnits:p}=t.me,{dataApprovalWorkflows:d}=t.dataApprovalWorkflows,c={authorities:i,organisationUnits:p,dataApprovalWorkflows:d};return l.a.createElement(n.Provider,{value:c},e)},ve=()=>Object(o.useContext)(n),fe=({children:e})=>(()=>{const{authorities:e}=ve();return e.some((e=>"ALL"===e||"M_dhis-web-approval"===e))})()?e:l.a.createElement(d,{title:c.a.t("Not authorized")},c.a.t("You don't have access to the Data Approval App. Contact a system administrator to request access.")),ge=Object(o.createContext)({approvalStatus:"",allowedActions:{},refresh:()=>{throw new Error("WorkflowContext.refresh has not been initialized")}}),we=()=>{throw new Error("Selection Context has not been initialized")},he=Object(o.createContext)({workflow:{},period:{},orgUnit:{},selectWorkflow:we,selectPeriod:we,selectOrgUnit:we,clearAll:we,setOpenedSelect:we});var Ee=a(513);const be=e=>`/#/?${Object(Ee.stringify)(e)}`;var De=a(520);const Ne=Object(De.a)(),Ae=e=>{const{wf:t,pe:a,ou:r,ouDisplayName:o}=(()=>{const e=Object(Ee.parse)(Ne.location.search);return{wf:e.wf,pe:e.pe,ou:e.ou,ouDisplayName:e.ouDisplayName}})(),l=Se(e,t);return{workflow:l,period:_e(a,l),orgUnit:ke(r,o)}},Se=(e,t)=>1===e.length?e[0]:t&&e.find((e=>e.id===t))||null,_e=(e,t={})=>e&&t.id?((e,t)=>{const a=t?q().filter((({type:e})=>t.some((t=>t===e)))):q();let r,o,l=0;for(;l<a.length&&!o;)r=a[l],o=e.match(r.regex),l++;if(!o)return null;const n=parseInt(o[1],10),s=G(n);return{...r.getPeriods({offset:s}).find((t=>t.id===e)),year:n,periodType:r}})(e,[t.periodType]):null,ke=(e,t)=>{if(!e||!t)return null;const[a]=e.match(/[/]?[^/]*$/);return{id:a.replace("/",""),path:e,displayName:t}},Oe="SET_OPENED_SELECT",Ce="CLEAR_ALL",$e="SELECT_WORKFLOW",Pe="SELECT_PERIOD",Fe="SELECT_ORG_UNIT",Te="SET_STATE_FROM_QUERY_PARAMS",xe=(e,{type:t,payload:a})=>{var r,o,l;switch(t){case Oe:return{...e,openedSelect:a.openedSelect};case Ce:return{openedSelect:"",workflow:a.workflow,period:null,orgUnit:null};case $e:return{...e,openedSelect:"",workflow:a.workflow,period:e.workflow&&(null===(r=e.workflow)||void 0===r?void 0:r.periodType)===(null===(o=a.workflow)||void 0===o?void 0:o.periodType)?e.period:null};case Pe:return{...e,openedSelect:null!==(l=a.period)&&void 0!==l&&l.id?"":e.openedSelect,period:a.period};case Fe:return{...e,openedSelect:"",orgUnit:a.orgUnit};case Te:return{openedSelect:"",...Ae(a.dataApprovalWorkflows)};default:return e}},We=({children:e})=>{const{dataApprovalWorkflows:t}=ve(),[{openedSelect:a,workflow:r,period:n,orgUnit:s},i]=Object(o.useReducer)(xe,{openedSelect:"",...Ae(t)}),p={workflow:r,period:n,orgUnit:s,openedSelect:a,clearAll:()=>i({type:Ce,payload:{workflow:Se(t)}}),setOpenedSelect:e=>i({type:Oe,payload:{openedSelect:e}}),selectWorkflow:e=>i({type:$e,payload:{workflow:e}}),selectPeriod:e=>i({type:Pe,payload:{period:e}}),selectOrgUnit:e=>i({type:Fe,payload:{orgUnit:e}})};return Object(o.useEffect)((()=>{(e=>{var t,a,r,o;const l=Object(Ee.stringify)({wf:null===(t=e.workflow)||void 0===t?void 0:t.id,pe:null===(a=e.period)||void 0===a?void 0:a.id,ou:null===(r=e.orgUnit)||void 0===r?void 0:r.path,ouDisplayName:null===(o=e.orgUnit)||void 0===o?void 0:o.displayName}),n=l?`?${l}`:"";n!==Ne.location.search&&Ne.push({pathname:"/",search:n})})({workflow:r,period:n,orgUnit:s})}),[r,n,s]),Object(o.useEffect)((()=>{const e=()=>{i({type:Te,payload:{dataApprovalWorkflows:t}})};return window.addEventListener("popstate",e),()=>{window.removeEventListener("popstate",e)}}),[]),l.a.createElement(he.Provider,{value:p},e)},Ie=()=>Object(o.useContext)(he),Ue={approvalStatus:{resource:"dataApprovals",params:({workflow:e,period:t,orgUnit:a})=>({wf:e.id,pe:t.id,ou:a.id})}},Re=({children:e})=>{const{workflow:t,period:a,orgUnit:r}=Ie(),{loading:n,error:i,data:p,called:u,refetch:m}=Object(s.g)(Ue,{lazy:!0});if(Object(o.useEffect)((()=>{t&&a&&r&&m({workflow:t,period:a,orgUnit:r})}),[t,a,r]),!t||!a||!r)return null;if(n||!u)return l.a.createElement(X,null);if(i)return l.a.createElement(d,{title:c.a.t("Could not load approval data")},i.message);const{state:y,approvedBy:v,approvedAt:f,...g}=p.approvalStatus;return l.a.createElement(ge.Provider,{value:{approvalStatus:y,approvedBy:v,approvedAt:f,allowedActions:g,refresh:m,params:{wf:t.id,pe:a.id,ou:r.id}}},e)},Ye=()=>Object(o.useContext)(ge),je={resource:"dataAcceptances",type:"create",params:({wf:e,pe:t,ou:a})=>({wf:e,pe:t,ou:a})},Be=()=>{const[e,{loading:t,error:a}]=Object(s.f)(je),{params:n,refresh:i}=Ye(),{show:p}=Object(s.b)(c.a.t("Acceptance failed: {{error}}",{error:a?a.toString():"",nsSeparator:"-:-"}));return Object(o.useEffect)((()=>{null!==a&&void 0!==a&&a.message&&p()}),[null===a||void 0===a?void 0:a.message]),l.a.createElement(r.c,{small:!0,disabled:t,onClick:async()=>{const{wf:t,pe:a,ou:r}=n;await e({wf:t,pe:a,ou:r}),i()}},c.a.t("Accept"))};var Le=a(522),Me=a.n(Le);const Ve=({onApprove:e,onCancel:t,error:a})=>{const{workflow:o,period:n}=Ie(),{dataSets:s}=o,i=s.length;return l.a.createElement(r.B,null,l.a.createElement(r.E,null,i>1?c.a.t("Approving {{count}} data sets",{count:i}):c.a.t("Approving {{count}} data set",{count:i})),l.a.createElement(r.D,null,l.a.createElement("div",{className:Me.a.summary},l.a.createElement("h1",{className:Me.a.summaryTitle},i>1?c.a.t("{{count}} data sets for {{- workflow}}, {{period}} will be approved:",{count:i,workflow:o.displayName,period:n.displayName}):c.a.t("{{count}} data set for {{- workflow}}, {{period}} will be approved:",{count:i,workflow:o.displayName,period:n.displayName})),l.a.createElement("ul",{className:Me.a.summaryList},s.map((({id:e,displayName:t})=>l.a.createElement("li",{className:Me.a.summaryListItem,key:e},t))))),l.a.createElement("p",{className:Me.a.confirmationStatement},c.a.t("Are you sure you want to approve this data?")),a&&l.a.createElement(r.F,{error:!0,title:c.a.t("There was a problem saving this approval")},c.a.t("This data couldn\u2019t be approved. Try again, or contact your system administrator."))),l.a.createElement(r.C,null,l.a.createElement(r.d,null,l.a.createElement(r.c,{onClick:t},c.a.t("Cancel")),l.a.createElement(r.c,{primary:!0,onClick:e},c.a.t("Approve")))))},He={resource:"dataApprovals",type:"create",params:({wf:e,pe:t,ou:a})=>({wf:e,pe:t,ou:a})},ze=({disabled:e})=>{const[t,a]=Object(o.useState)(null),[n,i]=Object(o.useState)(!1),{params:p,refresh:d}=Ye(),u=()=>i(!1),{show:m}=Object(s.b)(c.a.t("Approval saved"),{success:!0}),[y,{loading:v,error:f}]=(({onComplete:e,onError:t})=>Object(s.f)(He,{onComplete:e,onError:t}))({onComplete:()=>{m(),u(),d()},onError:e=>a(e)}),g=f||t;return l.a.createElement(l.a.Fragment,null,l.a.createElement(r.c,{primary:!0,small:!0,disabled:e,onClick:()=>i(!0)},c.a.t("Approve")),n&&l.a.createElement(Ve,{error:g,loading:v,onApprove:()=>{const{wf:e,pe:t,ou:a}=p;y({wf:e,pe:t,ou:a})},onCancel:u}))};var Je=a(523),qe=a.n(Je);const Ge=({children:e})=>l.a.createElement("div",{className:qe.a.bottomBarItem},e);var Qe=a(524),Ze=a.n(Qe);const Ke={resource:"dataAcceptances",type:"delete",params:({wf:e,pe:t,ou:a})=>({wf:e,pe:t,ou:a})},Xe=()=>{const[e,{loading:t,error:a}]=Object(s.f)(Ke),{params:n,refresh:i}=Ye(),{show:p}=Object(s.b)(c.a.t("Unacceptance failed: {{error}}",{error:a?a.toString():"",nsSeparator:"-:-"}));return Object(o.useEffect)((()=>{null!==a&&void 0!==a&&a.message&&p()}),[null===a||void 0===a?void 0:a.message]),l.a.createElement(r.c,{small:!0,disabled:t,onClick:async()=>{const{wf:t,pe:a,ou:r}=n;await e({wf:t,pe:a,ou:r}),i()}},c.a.t("Unaccept"))},et={resource:"dataApprovals",type:"delete",params:({wf:e,pe:t,ou:a})=>({wf:e,pe:t,ou:a})},tt=()=>{const[e,{loading:t,error:a}]=Object(s.f)(et),{params:n,refresh:i}=Ye(),{show:p}=Object(s.b)(c.a.t("Unapproval failed: {{error}}",{error:a?a.toString():"",nsSeparator:"-:-"}));return Object(o.useEffect)((()=>{null!==a&&void 0!==a&&a.message&&p()}),[null===a||void 0===a?void 0:a.message]),l.a.createElement(r.c,{small:!0,disabled:t,onClick:async()=>{const{wf:t,pe:a,ou:r}=n;await e({wf:t,pe:a,ou:r}),i()}},c.a.t("Unapprove"))},at=()=>{const{allowedActions:e,approvalStatus:t,approvedBy:a,approvedAt:r}=Ye(),{mayAccept:o,mayApprove:n,mayUnaccept:s,mayUnapprove:i}=e,p=!n&&!i;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:Ze.a.bottomBar,"data-test":"bottom-bar"},l.a.createElement(Ge,null,l.a.createElement(ie,{approvalStatus:t,approvedBy:a,approvedAt:r})),(n||p)&&l.a.createElement(Ge,null,l.a.createElement(ze,{disabled:p})),o&&l.a.createElement(Ge,null,l.a.createElement(Be,null)),i&&l.a.createElement(Ge,null,l.a.createElement(tt,null)),s&&l.a.createElement(Ge,null,l.a.createElement(Xe,null))))},rt=({dataSets:e,selected:t,onChange:a})=>e&&(null===e||void 0===e?void 0:e.length)>0?l.a.createElement(r.J,{scrollable:!0},e.map((e=>l.a.createElement(r.I,{key:e.id,onClick:()=>a(e.id),selected:e.id===t},e.displayName)))):null;var ot=a(525),lt=a.n(ot);const nt=({title:e,columns:t,rows:a})=>l.a.createElement(l.a.Fragment,null,l.a.createElement(r.m,null,e),l.a.createElement(r.i,null,l.a.createElement(r.L,null,l.a.createElement(r.l,null,t.map((e=>l.a.createElement(r.k,{key:e},e))))),l.a.createElement(r.K,null,a.map(((e,t)=>l.a.createElement(r.l,{key:t},e.map(((e,t)=>l.a.createElement(r.j,{key:t},e))))))))),st={dataSetReport:{resource:"dataSetReport",params:({dataSetId:e,periodIds:t,orgUnit:a})=>({pe:t,ds:e,ou:a.id})}},it=({dataSetId:e})=>{const t=Ie(),{orgUnit:a,workflow:n,period:i}=t,{dataSets:p}=n,d=p.find((({id:t})=>t===e)),u="DEFAULT"!==(null===d||void 0===d?void 0:d.formType),m=d?K(d.periodType,i.startDate,i.endDate).map((({id:e})=>e)):[],{called:y,loading:v,data:f,error:g,refetch:w}=Object(s.g)(st,{lazy:!0}),h=null===f||void 0===f?void 0:f.dataSetReport,E=()=>w({periodIds:m,dataSetId:e,orgUnit:a});return Object(o.useEffect)((()=>{m.length&&e&&E()}),[m.join(","),e]),p&&0!==p.length?e?!y&&m.length||v?l.a.createElement("div",{className:lt.a.display},l.a.createElement("div",{className:lt.a.loadingWrapper},l.a.createElement(r.f,{small:!0}),c.a.t("Loading data set"))):g?l.a.createElement("div",{className:lt.a.display},l.a.createElement(r.F,{error:!0,title:c.a.t("There was a problem displaying this data set")},l.a.createElement("p",null,c.a.t("This data set couldn't be loaded or displayed. Try again, or contact your system administrator.")),l.a.createElement("button",{className:lt.a.retryButton,onClick:E},c.a.t("Retry loading data set")))):m.length&&h.length?l.a.createElement("div",{className:lt.a.display},u&&l.a.createElement(r.F,{warning:!0,title:c.a.t("This data set may not display properly"),className:lt.a.nonDefaultFormWarning},l.a.createElement("p",null,c.a.t("This data set does not use a default form. The data is displayed as a simple grid below, but this might not be a suitable representation."),l.a.createElement("br",null),c.a.t("Displaying data from data sets using custom forms is currently not supported in this app. Please refer to the legacy app instead."))),h.map((e=>l.a.createElement(nt,{key:e.title,title:e.title,columns:e.headers.map((e=>e.name)),rows:e.rows})))):l.a.createElement("div",{className:lt.a.noData},l.a.createElement("p",null,c.a.t("This data set doesn't have any data for {{- period}} in {{- orgUnit}}.",{period:i.displayName,orgUnit:a.displayName}))):l.a.createElement("div",{className:lt.a.chooseDataSet},l.a.createElement("h2",null,c.a.t("Choose a data set to review")),l.a.createElement("p",null,c.a.t("{{- workflowName}} has multiple data sets. Choose a data set from the tabs above.",{workflowName:n.displayName}))):l.a.createElement("div",{className:lt.a.noData},l.a.createElement("p",null,c.a.t("This workflow does not contain any data sets.")))};var pt=a(526),dt=a.n(pt);const ct=()=>{const{approvalStatus:e,approvedBy:t,approvedAt:a}=Ye(),{workflow:o}=Ie(),{dataSets:n,displayName:s}=o,i=n.length;return l.a.createElement("div",{className:dt.a.titleBar},l.a.createElement("span",{className:dt.a.workflowName},s),l.a.createElement("span",{className:dt.a.workflowDataSetsCount},l.a.createElement(r.u,null),1===i&&c.a.t("1 data set",{dataSetsCount:i}),1!==i&&c.a.t("{{dataSetsCount}} data sets",{dataSetsCount:i})),l.a.createElement(ie,{approvalStatus:e,approvedBy:t,approvedAt:a}))},ut=()=>{const{workflow:e}=Ie(),[t,a]=Object(o.useState)(1===e.dataSets.length?e.dataSets[0].id:null);return l.a.createElement(l.a.Fragment,null,l.a.createElement(ct,null),l.a.createElement(rt,{dataSets:null===e||void 0===e?void 0:e.dataSets,selected:t,onChange:a}),l.a.createElement(it,{dataSetId:t}))};var mt=a(527),yt=a.n(mt);const vt=()=>{const{clearAll:e,period:t,orgUnit:a}=Ie();return null!==t&&void 0!==t&&t.id||null!==a&&void 0!==a&&a.path?l.a.createElement(r.c,{className:yt.a.button,secondary:!0,onClick:e},c.a.t("Clear selections")):null};var ft=a(539);const gt=Object(o.createContext)();class wt{constructor(e){this._map=e||new Map}_serialiseKey({workflowId:e,periodId:t,orgUnitId:a}){return`${e}-${t}-${a}`}set(e,t){this._map.set(this._serialiseKey(e),t)}get(e){return this._map.get(this._serialiseKey(e))}clone(){return new wt(new Map(this._map))}}const ht=({children:e})=>{const[t,a]=Object(o.useState)(new wt),r=(({updateApprovalStatuses:e})=>{const t=Object(s.e)(),a=Object(o.useRef)([]),r=Object(ft.a)((()=>{const r=[];a.current.forEach((e=>{const t=r.find((({workflowId:t,periodId:a})=>t===e.workflowId&&a===e.periodId));t?t.orgUnitIds.push(e.orgUnitId):r.push({workflowId:e.workflowId,periodId:e.periodId,orgUnitIds:[e.orgUnitId]})})),a.current=[],r.forEach((async({workflowId:a,periodId:r,orgUnitIds:o})=>{e({periodId:r,workflowId:a,approvalStatusUpdates:o.reduce(((e,t)=>(e[t]="LOADING",e)),{})});const l={};try{const{approvalStatuses:e}=await t.query({approvalStatuses:{resource:"dataApprovals/approvals",params:{wf:a,pe:r,ou:o}}});e.forEach((({ou:e,state:t})=>{l[e]=t||"UNAPPROVABLE"}))}catch(n){o.forEach((e=>{l[e]="FETCH_ERROR"}))}e({periodId:r,workflowId:a,approvalStatusUpdates:l})}))}),10);return({workflowId:e,periodId:t,orgUnitId:o})=>{a.current.push({periodId:t,workflowId:e,orgUnitId:o}),r()}})({updateApprovalStatuses:({workflowId:e,periodId:t,approvalStatusUpdates:r})=>{a((a=>{const o=a.clone();for(const[l,n]of Object.entries(r))o.set({workflowId:e,periodId:t,orgUnitId:l},n);return o}))}});return l.a.createElement(gt.Provider,{value:{approvalStatuses:t,fetchApprovalStatus:r}},e)},Et=()=>{const{approvalStatuses:e,fetchApprovalStatus:t}=Object(o.useContext)(gt);return{getApprovalStatus:({workflowId:t,periodId:a,orgUnitId:r})=>e.get({workflowId:t,periodId:a,orgUnitId:r}),fetchApprovalStatus:t}};var bt=a(528),Dt=a.n(bt);const Nt=({children:e,dataTest:t,prefix:a,placeholder:n,value:s,onClose:i,onOpen:p,disabled:d,open:c,requiredValuesMessage:u,popoverMaxWidth:m})=>{const y=Object(o.useRef)(),v=c?r.t:r.s,f=l.a.createElement("button",{ref:y,className:Dt.a.button,onClick:p,disabled:d,"data-test":`${t}-button`},l.a.createElement("span",{className:Dt.a.prefix},a),l.a.createElement("span",{className:Dt.a.value,"data-test":"value"},s||!d&&n),l.a.createElement(v,{color:d?r.O.grey600:void 0}));return l.a.createElement(l.a.Fragment,null,d?l.a.createElement(r.N,{content:u,placement:"bottom"},(({ref:e,onMouseOver:t,onMouseOut:a})=>l.a.createElement("div",{ref:e,onMouseOver:t,onMouseOut:a,className:Dt.a.tooltipwrap},f))):f,c&&l.a.createElement(r.H,{reference:y,arrow:!1,placement:"bottom-end",onClickOutside:i,maxWidth:m,dataTest:`${t}-popover`},e))};var At=a(529),St=a.n(At);const _t=[{status:"UNAPPROVED_WAITING",displayName:c.a.t("Waiting for approval")},{status:"UNAPPROVED_READY",displayName:c.a.t("Ready for approval")},{status:"APPROVED_HERE",displayName:c.a.t("Approved")},{status:"UNAPPROVABLE",displayName:c.a.t("Cannot be approved")}],kt=()=>l.a.createElement("div",{className:St.a.container},_t.map((({status:e,displayName:t})=>l.a.createElement("div",{key:e,className:St.a.label},l.a.createElement(ue,{approvalStatus:e,showTitle:!1}),t))));var Ot=a(530),Ct=a.n(Ot);const $t=({label:e,orgUnitId:t})=>{const{workflow:a,period:n}=Ie(),{getApprovalStatus:s,fetchApprovalStatus:i}=Et(),p=s({workflowId:a.id,periodId:n.id,orgUnitId:t});return Object(o.useEffect)((()=>{i({workflowId:a.id,periodId:n.id,orgUnitId:t})}),[]),l.a.createElement("div",{className:Ct.a.container},(e=>"LOADING"===e?l.a.createElement("span",{className:Ct.a.loadingIcon}):"FETCH_ERROR"===e?l.a.createElement(r.N,{content:c.a.t("Failed to load approval state")},(({onMouseOver:e,onMouseOut:t,ref:a})=>l.a.createElement("span",{className:Ct.a.iconContainer,onMouseOver:e,onMouseOut:t,ref:a},l.a.createElement(r.w,{color:r.O.yellow500})))):e?l.a.createElement(ue,{approvalStatus:e}):void 0)(p),e)};var Pt=a(531),Ft=a.n(Pt);const Tt="ORG_UNIT",xt=()=>{const{organisationUnits:e}=ve(),{orgUnit:t,selectOrgUnit:a,workflow:o,period:n,openedSelect:s,setOpenedSelect:i}=Ie(),p=s===Tt,d=null===t||void 0===t?void 0:t.displayName,u=null!==o&&void 0!==o&&o.id?c.a.t("Choose a period first"):c.a.t("Choose a workflow and period first"),m=e.map((({id:e})=>e)),y=null!==t&&void 0!==t&&t.path?[t.path]:void 0,v=y||e.map((({path:e})=>e));return l.a.createElement(Nt,{dataTest:"org-unit-context-select",prefix:c.a.t("Organisation Unit"),placeholder:c.a.t("Choose an organisation unit"),value:d,open:p,disabled:!(null!==o&&void 0!==o&&o.id&&null!==n&&void 0!==n&&n.id),onOpen:()=>i(Tt),onClose:()=>i(""),requiredValuesMessage:u,popoverMaxWidth:400},l.a.createElement("div",{className:Ft.a.popoverContainer},l.a.createElement("div",{className:Ft.a.scrollbox},l.a.createElement(r.G,{roots:m,onChange:({displayName:e,id:t,path:r})=>{a({displayName:e,id:t,path:r})},initiallyExpanded:v,selected:y,singleSelection:!0,renderNodeLabel:({label:e,node:t})=>l.a.createElement($t,{label:e,orgUnitId:t.id})})),l.a.createElement(r.n,{margin:"0"}),l.a.createElement(kt,null)))};var Wt=a(532),It=a.n(Wt);const Ut=({periodType:e,year:t})=>{const{workflow:a,period:o,orgUnit:n,selectPeriod:s}=Ie(),i=Q(e,t);return l.a.createElement(r.z,{dense:!0,className:It.a.menu},i.map((e=>l.a.createElement(r.A,{active:e.id===(null===o||void 0===o?void 0:o.id),key:e.id,href:be({wf:null===a||void 0===a?void 0:a.id,ou:null===n||void 0===n?void 0:n.path,pe:e.id}),label:e.displayName,onClick:()=>s(e)}))))};var Rt=a(533),Yt=a.n(Rt);const jt=({maxYear:e,year:t,onYearChange:a})=>l.a.createElement("div",{className:Yt.a.container},l.a.createElement(r.c,{disabled:1970===t,onClick:()=>a(t-1),icon:l.a.createElement(r.p,null)}),l.a.createElement("span",{className:Yt.a.year},t),l.a.createElement(r.c,{disabled:t===e,onClick:()=>a(t+1),icon:l.a.createElement(r.q,null)})),Bt="PERIOD",Lt=e=>e?(e=>{if(!$(e))throw new Error(`Invalid periodType "${e}" supplied to "getMostRecentCompletedYear"`);const t=F();let a=t.getFullYear(),r=K(e,`${t.getFullYear()}-01-01`,t);if(r.length>0)return a;for(;0===r.length;)--a,r=K(e,`${a}-01-01`,`${a}-12-31`);return a})(e):null,Mt=()=>{const{period:e,workflow:t,selectPeriod:a,openedSelect:r,setOpenedSelect:n}=Ie(),[s,i]=Object(o.useState)((()=>Lt(null===t||void 0===t?void 0:t.periodType))),[p,d]=Object(o.useState)((null===e||void 0===e?void 0:e.year)||s),u=r===Bt,m=null===e||void 0===e?void 0:e.displayName;return Object(o.useEffect)((()=>{null!==e&&void 0!==e&&e.year&&d(e.year)}),[null===e||void 0===e?void 0:e.year]),Object(o.useEffect)((()=>{if(null!==t&&void 0!==t&&t.periodType){const a=Lt(null===t||void 0===t?void 0:t.periodType);i(a),null!==e&&void 0!==e&&e.year||d(a)}}),[null===t||void 0===t?void 0:t.periodType]),l.a.createElement(Nt,{dataTest:"period-context-select",prefix:c.a.t("Period"),placeholder:c.a.t("Choose a period"),value:m,open:u,disabled:!(null!==t&&void 0!==t&&t.id),onOpen:()=>n(Bt),onClose:()=>n(""),requiredValuesMessage:c.a.t("Choose a workflow first")},p&&l.a.createElement(l.a.Fragment,null,l.a.createElement(jt,{maxYear:s,year:p,onYearChange:e=>{a(null),d(e)}}),l.a.createElement(Ut,{periodType:null===t||void 0===t?void 0:t.periodType,year:p})))};var Vt=a(534),Ht=a.n(Vt);const zt=({id:e,name:t,periodType:a,active:o,onClick:n})=>{const s=l.a.createElement("div",{className:Ht.a.option},l.a.createElement("span",{className:Ht.a.title},t),l.a.createElement("span",{className:Ht.a.subtitle},a||"UNAVAILABLE"));return l.a.createElement(r.A,{href:be({wf:e}),className:Ht.a.bordered,active:o,onClick:n,label:s})};var Jt=a(535),qt=a.n(Jt);const Gt="WORKFLOW",Qt=()=>{const{dataApprovalWorkflows:e}=ve(),{workflow:t,selectWorkflow:a,openedSelect:o,setOpenedSelect:n}=Ie(),s=o===Gt,i=null===t||void 0===t?void 0:t.displayName;return l.a.createElement(Nt,{dataTest:"workflow-context-select",prefix:c.a.t("Workflow"),placeholder:c.a.t("Choose a workflow"),value:i,open:s,onOpen:()=>n(Gt),onClose:()=>n("")},0===e.length?l.a.createElement("div",{className:qt.a.message},c.a.t("No workflows found. None may exist, or you may not have access to any.")):l.a.createElement(r.z,null,e.map((e=>l.a.createElement(zt,{key:e.id,id:e.id,name:e.displayName,periodType:e.periodType,active:e.id===(null===t||void 0===t?void 0:t.id),onClick:()=>a(e)})))))},Zt=()=>l.a.createElement(l.a.Fragment,null,l.a.createElement(Qt,null),l.a.createElement(Mt,null),l.a.createElement(ht,null,l.a.createElement(xt,null)),l.a.createElement(vt,null));var Kt=a(536),Xt=a.n(Kt);function ea(){return(ea=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}const ta=({children:e,className:t})=>l.a.createElement("div",{className:t},e),aa=e=>l.a.createElement(ta,ea({},e,{className:Xt.a.container})),ra=e=>l.a.createElement(ta,ea({},e,{className:Xt.a.top})),oa=e=>l.a.createElement(ta,ea({},e,{className:Xt.a.content})),la=e=>l.a.createElement(ta,ea({},e,{className:Xt.a.bottom}));var na=a(537);c.a.addResources("en","default",na);c.a,t.default=()=>l.a.createElement(l.a.Fragment,null,l.a.createElement(r.h,{spacers:!0,colors:!0,theme:!0}),l.a.createElement(ye,null,l.a.createElement(fe,null,l.a.createElement(We,null,l.a.createElement(aa,null,l.a.createElement(ra,null,l.a.createElement(Zt,null)),l.a.createElement(Re,null,l.a.createElement(oa,null,l.a.createElement(ut,null)),l.a.createElement(la,null,l.a.createElement(at,null))))))))}}]);
//# sourceMappingURL=app.44622396.chunk.js.map