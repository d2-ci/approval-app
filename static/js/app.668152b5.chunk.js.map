{"version":3,"sources":["D2App/auth/auth-wall.module.css","D2App/top-bar/clear-all-button/clear-all-button.module.css","D2App/top-bar/context-select/context-select.module.css","D2App/top-bar/workflow-select/workflow-select-option.module.css","D2App/top-bar/workflow-select/workflow-select.module.css","D2App/app/layout.module.css","D2App/current-user/current-user-context.js","D2App/current-user/current-user-provider.js","D2App/current-user/use-current-user.js","D2App/auth/auth-wall.js","D2App/auth/use-is-authorized.js","D2App/bottom-bar/bottom-bar.js","D2App/data-workspace/data-workspace.js","D2App/top-bar/selection/selection-context.js","D2App/top-bar/selection/selection-provider.js","D2App/top-bar/selection/use-selection.js","D2App/top-bar/clear-all-button/clear-all-button.js","D2App/top-bar/context-select/context-select.js","D2App/top-bar/org-unit-select/org-unit-select.js","D2App/top-bar/period-select/period-select.js","D2App/top-bar/workflow-select/workflow-select-option.js","D2App/top-bar/workflow-select/workflow-select.js","D2App/top-bar/top-bar.js","D2App/app/layout.js","D2App/app/index.js","D2App/app/app.js"],"names":["module","exports","CurrentUserContext","createContext","query","me","resource","params","fields","dataApprovalWorkflows","paging","CurrentUserProvider","children","data","loading","error","useDataQuery","React","createElement","Layer","CenteredContent","CircularLoader","providerValue","Provider","value","useCurrentUser","useContext","AuthWall","authorities","some","authority","useIsAuthorized","className","classes","wrapper","NoticeBox","title","i18n","t","BottomBar","DataWorkspace","noop","SelectionContext","workflow","setWorkflow","period","setPeriod","orgUnit","setOrgUnit","initialWorkflowValue","workflows","id","find","length","ACTIONS","reducer","state","type","payload","openedSelect","SelectionProvider","setQuery","useQueryParams","wf","StringParam","pe","ou","dispatch","useReducer","displayName","clearAll","setOpenedSelect","fieldName","selectWorkflow","selectPeriod","selectOrgUnit","useEffect","useSelection","ClearAllButton","Button","button","secondary","onClick","ContextSelect","label","onClose","onOpen","disabled","open","tooltipContent","buttonRef","useRef","Icon","IconChevronUp24","IconChevronDown24","ref","prefix","color","colors","grey600","undefined","Fragment","Tooltip","content","placement","onMouseOver","onMouseOut","tooltipwrap","Popover","reference","arrow","onClickOutside","ORG_UNIT","OrgUnitSelect","PERIOD","PeriodSelect","WorkflowSelectOption","name","periodType","active","option","subtitle","MenuItem","bordered","WORKFLOW","WorkflowSelect","selectedWorkflow","message","Menu","map","key","TopBar","_extends","Object","assign","target","i","arguments","source","prototype","hasOwnProperty","call","apply","this","LayoutSection","Layout","props","container","top","bottom","App","QueryParamProvider","CssVariables","spacers","theme"],"mappings":"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","file":"static/js/app.668152b5.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"auth-wall_wrapper__2MmQe\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"clear-all-button_button__mDEHm\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"context-select_button__1y8va\",\"prefix\":\"context-select_prefix__3xDFu\",\"value\":\"context-select_value__oltZj\",\"tooltipwrap\":\"context-select_tooltipwrap__3Fqbe\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bordered\":\"workflow-select-option_bordered__JBAIX\",\"option\":\"workflow-select-option_option__1cqTS\",\"title\":\"workflow-select-option_title__3zrtv\",\"subtitle\":\"workflow-select-option_subtitle__3yrup\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"message\":\"workflow-select_message__1jq5N\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"layout_container__Cp-96\",\"top\":\"layout_top__2gcI9\",\"content\":\"layout_content__10QOH\",\"bottom\":\"layout_bottom__2toTd\"};","import { createContext } from 'react';\nconst CurrentUserContext = /*#__PURE__*/createContext({});\nexport { CurrentUserContext };","import { useDataQuery } from '@dhis2/app-runtime';\nimport { PropTypes } from '@dhis2/prop-types';\nimport { CircularLoader, Layer, CenteredContent } from '@dhis2/ui';\nimport React from 'react';\nimport { CurrentUserContext } from './current-user-context.js';\nconst query = {\n  me: {\n    resource: 'me',\n    params: {\n      fields: ['id', 'authorities', 'programs', 'dataSets', 'userGroups', 'organisationUnits', 'dataViewOrganisationUnits']\n    }\n  },\n  dataApprovalWorkflows: {\n    // This is generic enpoint but will only return\n    // workflows a user is allowed to see\n    resource: 'dataApprovalWorkflows',\n    params: {\n      paging: false,\n      fields: ['id', 'displayName', 'dataApprovalLevels', 'periodType']\n    }\n  }\n};\n\nconst CurrentUserProvider = ({\n  children\n}) => {\n  const {\n    data,\n    loading,\n    error\n  } = useDataQuery(query);\n\n  if (loading) {\n    return /*#__PURE__*/React.createElement(Layer, null, /*#__PURE__*/React.createElement(CenteredContent, null, /*#__PURE__*/React.createElement(CircularLoader, null)));\n  }\n\n  if (error) {\n    /**\n     * The app can't continue if this fails, because it doesn't\n     * have any data, so throw the error and let it be caught by\n     * the error boundary in the app-shell\n     */\n    throw error;\n  }\n\n  const providerValue = { ...data.me,\n    ...data.dataApprovalWorkflows\n  };\n  return /*#__PURE__*/React.createElement(CurrentUserContext.Provider, {\n    value: providerValue\n  }, children);\n};\n\nCurrentUserProvider.propTypes = {\n  children: PropTypes.node.isRequired\n};\nexport { CurrentUserProvider };","import { useContext } from 'react';\nimport { CurrentUserContext } from './current-user-context.js';\nexport const useCurrentUser = () => useContext(CurrentUserContext);","import i18n from '@dhis2/d2-i18n';\nimport { NoticeBox } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport classes from './auth-wall.module.css';\nimport { useIsAuthorized } from './use-is-authorized.js';\n\nconst AuthWall = ({\n  children\n}) => {\n  const isAuthorized = useIsAuthorized();\n\n  if (!isAuthorized) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.wrapper\n    }, /*#__PURE__*/React.createElement(NoticeBox, {\n      error: true,\n      title: i18n.t('Not authorized')\n    }, i18n.t(\"You don't have access to the Data Approval App. Contact a system administrator to request access.\")));\n  }\n\n  return children;\n};\n\nAuthWall.propTypes = {\n  children: PropTypes.node.isRequired\n};\nexport { AuthWall };","import { useCurrentUser } from '../current-user/index.js';\nexport const useIsAuthorized = () => {\n  const {\n    authorities\n  } = useCurrentUser();\n  return authorities.some(authority => authority === 'ALL' || authority === 'M_dhis-web-approval');\n};","import React from 'react';\n\nconst BottomBar = () => /*#__PURE__*/React.createElement(\"pre\", null, \"BottomBar placeholder\");\n\nexport { BottomBar };","import React from 'react';\n\nconst DataWorkspace = () => /*#__PURE__*/React.createElement(\"pre\", null, \"DataWorkspace placeholder\");\n\nexport { DataWorkspace };","import { createContext } from 'react';\n\nconst noop = () => {};\n\nconst SelectionContext = /*#__PURE__*/createContext({\n  workflow: {},\n  setWorkflow: noop,\n  period: {},\n  setPeriod: noop,\n  orgUnit: {},\n  setOrgUnit: noop\n});\nexport { SelectionContext };","import { PropTypes } from '@dhis2/prop-types';\nimport React, { useEffect, useReducer } from 'react';\nimport { useQueryParams, StringParam } from 'use-query-params';\nimport { useCurrentUser } from '../../current-user/index.js';\nimport { SelectionContext } from './selection-context.js'; // TODO: should take a periodId and return a period object\n\nconst parsePeriodId = id => ({\n  id: id,\n  displayName: id\n});\n\nconst initialWorkflowValue = (workflows, id) => {\n  if (id) {\n    /*\n     * Auto select workflow with query param id\n     * default to empty object if `find` returns undefined in case the\n     * workflow with the id from the url is not available to the user\n     */\n    return workflows.find(workflow => workflow.id === id) || {};\n  }\n\n  if (workflows.length === 1) {\n    // auto-select if user only has one workflow\n    return workflows[0];\n  }\n\n  return {};\n};\n\nconst ACTIONS = {\n  SET_OPENED_SELECT: 'SET_OPENED_SELECT',\n  CLEAR_ALL: 'CLEAR_ALL',\n  SELECT_WORKFLOW: 'SELECT_WORKFLOW',\n  SELECT_PERIOD: 'SELECT_PERIOD',\n  SELECT_ORG_UNIT: 'SELECT_ORG_UNIT'\n};\n\nconst reducer = (state, {\n  type,\n  payload\n}) => {\n  switch (type) {\n    case ACTIONS.SET_OPENED_SELECT:\n      return { ...state,\n        openedSelect: payload\n      };\n\n    case ACTIONS.CLEAR_ALL:\n      return {\n        openedSelect: '',\n        workflow: {},\n        period: {},\n        orgUnit: {}\n      };\n\n    case ACTIONS.SELECT_WORKFLOW:\n      return {\n        openedSelect: '',\n        workflow: payload,\n        period: {},\n        orgUnit: {}\n      };\n\n    case ACTIONS.SELECT_PERIOD:\n      return { ...state,\n        openedSelect: '',\n        period: payload,\n        orgUnit: {}\n      };\n\n    case ACTIONS.SELECT_ORG_UNIT:\n      return { ...state,\n        openedSelect: '',\n        orgUnit: payload\n      };\n\n    default:\n      return state;\n  }\n};\n\nconst SelectionProvider = ({\n  children\n}) => {\n  const [query, setQuery] = useQueryParams({\n    wf: StringParam,\n    pe: StringParam,\n    ou: StringParam\n  });\n  const {\n    dataApprovalWorkflows\n  } = useCurrentUser();\n  const [{\n    openedSelect,\n    workflow,\n    period,\n    orgUnit\n  }, dispatch] = useReducer(reducer, {\n    openedSelect: '',\n    workflow: initialWorkflowValue(dataApprovalWorkflows, query.wf),\n    // TODO: the initial value for period should take into account the inital\n    // workflow value, it should be cleared if no valid workflow is found\n    period: query.pe ? parsePeriodId(query.pe) : {},\n    // TODO: same as period, but orgUnit should also be cleared if period is\n    // unset/invalid\n    orgUnit: query.ou ? {\n      id: query.ou\n    } : {}\n  });\n  const providerValue = {\n    workflow,\n    period,\n    orgUnit,\n    openedSelect,\n    clearAll: () => dispatch({\n      type: ACTIONS.CLEAR_ALL,\n      payload: initialWorkflowValue(dataApprovalWorkflows)\n    }),\n    setOpenedSelect: fieldName => dispatch({\n      type: ACTIONS.SET_OPENED_SELECT,\n      payload: fieldName\n    }),\n    selectWorkflow: workflow => dispatch({\n      type: ACTIONS.SELECT_WORKFLOW,\n      payload: workflow\n    }),\n    selectPeriod: period => dispatch({\n      type: ACTIONS.SELECT_PERIOD,\n      payload: period\n    }),\n    selectOrgUnit: orgUnit => dispatch({\n      type: ACTIONS.SELECT_ORG_UNIT,\n      payload: orgUnit\n    })\n  };\n  useEffect(() => {\n    setQuery({\n      wf: workflow.id,\n      pe: period.id,\n      ou: orgUnit.id\n    });\n  }, [workflow, period, orgUnit]);\n  return /*#__PURE__*/React.createElement(SelectionContext.Provider, {\n    value: providerValue\n  }, children);\n};\n\nSelectionProvider.propTypes = {\n  children: PropTypes.node\n};\nexport { SelectionProvider };","import { useContext } from 'react';\nimport { SelectionContext } from './selection-context.js';\nexport const useSelection = () => useContext(SelectionContext);","import i18n from '@dhis2/d2-i18n';\nimport { Button } from '@dhis2/ui';\nimport React from 'react';\nimport { useSelection } from '../selection/index.js';\nimport classes from './clear-all-button.module.css';\n\nconst ClearAllButton = () => {\n  const {\n    clearAll,\n    period,\n    orgUnit\n  } = useSelection();\n  return period.id || orgUnit.id ? /*#__PURE__*/React.createElement(Button, {\n    className: classes.button,\n    secondary: true,\n    onClick: clearAll\n  }, i18n.t('Clear selections')) : null;\n};\n\nexport { ClearAllButton };","import { IconChevronDown24, IconChevronUp24, colors, Popover, Tooltip } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React, { useRef } from 'react';\nimport classes from './context-select.module.css';\n\nconst ContextSelect = ({\n  children,\n  label,\n  value,\n  onClose,\n  onOpen,\n  disabled,\n  open,\n  tooltipContent\n}) => {\n  const buttonRef = useRef();\n  const Icon = open ? IconChevronUp24 : IconChevronDown24;\n  const button = /*#__PURE__*/React.createElement(\"button\", {\n    ref: buttonRef,\n    className: classes.button,\n    onClick: onOpen,\n    disabled: disabled\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: classes.prefix\n  }, label), !disabled && /*#__PURE__*/React.createElement(\"span\", {\n    className: classes.value\n  }, value), /*#__PURE__*/React.createElement(Icon, {\n    color: disabled ? colors.grey600 : undefined\n  }));\n  return /*#__PURE__*/React.createElement(React.Fragment, null, disabled ? /*#__PURE__*/React.createElement(Tooltip, {\n    content: tooltipContent,\n    placement: \"bottom\"\n  }, ({\n    ref,\n    onMouseOver,\n    onMouseOut\n  }) => /*#__PURE__*/React.createElement(\"div\", {\n    ref: ref,\n    onMouseOver: onMouseOver,\n    onMouseOut: onMouseOut,\n    className: classes.tooltipwrap\n  }, button)) : button, open && /*#__PURE__*/React.createElement(Popover, {\n    reference: buttonRef,\n    arrow: false,\n    placement: \"bottom-start\",\n    onClickOutside: onClose\n  }, children));\n};\n\nContextSelect.propTypes = {\n  children: PropTypes.node.isRequired,\n  label: PropTypes.string.isRequired,\n  value: PropTypes.string.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onOpen: PropTypes.func.isRequired,\n  disabled: PropTypes.bool,\n  open: PropTypes.bool,\n  tooltipContent: PropTypes.string\n};\nexport { ContextSelect };","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport { ContextSelect } from '../context-select/index.js';\nimport { useSelection } from '../selection/index.js';\nconst ORG_UNIT = 'ORG_UNIT';\n\nconst OrgUnitSelect = () => {\n  const {\n    orgUnit\n    /*, setOrgUnit */\n    ,\n    workflow,\n    period,\n    openedSelect,\n    setOpenedSelect\n  } = useSelection();\n  const open = openedSelect === ORG_UNIT;\n  const value = orgUnit.displayName || i18n.t('Choose an organisation unit');\n  const tooltipContent = workflow.id ? i18n.t('Choose a period first') : i18n.t('Choose a workflow and period first');\n  return /*#__PURE__*/React.createElement(ContextSelect, {\n    label: i18n.t('Organisation Unit'),\n    value: value,\n    open: open,\n    disabled: !(workflow.id && period.id),\n    onOpen: () => setOpenedSelect(ORG_UNIT),\n    onClose: () => setOpenedSelect(''),\n    tooltipContent: tooltipContent\n  }, /*#__PURE__*/React.createElement(\"pre\", null, \"Org Unit picker placeholder\"));\n};\n\nexport { OrgUnitSelect };","import i18n from '@dhis2/d2-i18n';\nimport React from 'react';\nimport { ContextSelect } from '../context-select/index.js';\nimport { useSelection } from '../selection/index.js';\nconst PERIOD = 'PERIOD';\n\nconst PeriodSelect = () => {\n  const {\n    period,\n    workflow,\n    selectPeriod,\n    openedSelect,\n    setOpenedSelect\n  } = useSelection();\n  const open = openedSelect === PERIOD;\n  const value = period.displayName || i18n.t('Choose a period');\n  return /*#__PURE__*/React.createElement(ContextSelect, {\n    label: i18n.t('Period'),\n    value: value,\n    open: open,\n    disabled: !workflow.id,\n    onOpen: () => setOpenedSelect(PERIOD),\n    onClose: () => setOpenedSelect(''),\n    tooltipContent: i18n.t('Choose a workflow first')\n  }, /*#__PURE__*/React.createElement(\"pre\", null, \"Period picker placeholder \", /*#__PURE__*/React.createElement(\"br\", null), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => selectPeriod({\n      id: '20210404',\n      displayName: '04-04-2020'\n    })\n  }, \"Set period to sth\")));\n};\n\nexport { PeriodSelect };","import { MenuItem } from '@dhis2/ui';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport classes from './workflow-select-option.module.css';\n\nconst WorkflowSelectOption = ({\n  name,\n  periodType,\n  active,\n  onClick\n}) => {\n  const label = /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.option\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: classes.title\n  }, name), /*#__PURE__*/React.createElement(\"span\", {\n    className: classes.subtitle\n  }, periodType || 'UNAVAILABLE'));\n  return /*#__PURE__*/React.createElement(MenuItem, {\n    className: classes.bordered,\n    active: active,\n    onClick: onClick,\n    label: label\n  });\n};\n\nWorkflowSelectOption.propTypes = {\n  name: PropTypes.string.isRequired,\n  active: PropTypes.bool,\n  periodType: PropTypes.string,\n  onClick: PropTypes.func\n};\nexport { WorkflowSelectOption };","import i18n from '@dhis2/d2-i18n';\nimport { Menu } from '@dhis2/ui';\nimport React from 'react';\nimport { useCurrentUser } from '../../current-user/index.js';\nimport { ContextSelect } from '../context-select/index.js';\nimport { useSelection } from '../selection/index.js';\nimport { WorkflowSelectOption } from './workflow-select-option.js';\nimport classes from './workflow-select.module.css';\nconst WORKFLOW = 'WORKFLOW';\n\nconst WorkflowSelect = () => {\n  const {\n    dataApprovalWorkflows\n  } = useCurrentUser();\n  const {\n    workflow: selectedWorkflow,\n    selectWorkflow,\n    openedSelect,\n    setOpenedSelect\n  } = useSelection();\n  const open = openedSelect === WORKFLOW;\n  const value = selectedWorkflow.displayName || i18n.t('Choose a workflow');\n  return /*#__PURE__*/React.createElement(ContextSelect, {\n    label: i18n.t('Workflow'),\n    value: value,\n    open: open,\n    onOpen: () => setOpenedSelect(WORKFLOW),\n    onClose: () => setOpenedSelect('')\n  }, dataApprovalWorkflows.length === 0 ? /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.message\n  }, i18n.t('No workflows found. None may exist, or you may not have access to any.')) : /*#__PURE__*/React.createElement(Menu, null, dataApprovalWorkflows.map(workflow => /*#__PURE__*/React.createElement(WorkflowSelectOption, {\n    key: workflow.id,\n    name: workflow.displayName,\n    periodType: workflow.periodType,\n    active: workflow.id === selectedWorkflow.id,\n    onClick: () => selectWorkflow(workflow)\n  }))));\n};\n\nexport { WorkflowSelect, WORKFLOW };","import React from 'react';\nimport { ClearAllButton } from './clear-all-button/index.js';\nimport { OrgUnitSelect } from './org-unit-select/index.js';\nimport { PeriodSelect } from './period-select/index.js';\nimport { SelectionProvider } from './selection/index.js';\nimport { WorkflowSelect } from './workflow-select/index.js';\n\nconst TopBar = () => /*#__PURE__*/React.createElement(SelectionProvider, null, /*#__PURE__*/React.createElement(WorkflowSelect, null), /*#__PURE__*/React.createElement(PeriodSelect, null), /*#__PURE__*/React.createElement(OrgUnitSelect, null), /*#__PURE__*/React.createElement(ClearAllButton, null));\n\nexport { TopBar };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport classes from './layout.module.css';\n\nconst LayoutSection = ({\n  children,\n  className\n}) => /*#__PURE__*/React.createElement(\"div\", {\n  className: className\n}, children);\n\nLayoutSection.propTypes = {\n  children: PropTypes.node,\n  className: PropTypes.string\n};\n\nconst Container = props => /*#__PURE__*/React.createElement(LayoutSection, _extends({}, props, {\n  className: classes.container\n}));\n\nconst Top = props => /*#__PURE__*/React.createElement(LayoutSection, _extends({}, props, {\n  className: classes.top\n}));\n\nconst Content = props => /*#__PURE__*/React.createElement(LayoutSection, _extends({}, props, {\n  className: classes.content\n}));\n\nconst Bottom = props => /*#__PURE__*/React.createElement(LayoutSection, _extends({}, props, {\n  className: classes.bottom\n}));\n\nexport const Layout = {\n  Container,\n  Top,\n  Content,\n  Bottom\n};","import { App } from './app.js';\nexport default App;","import { CssVariables } from '@dhis2/ui';\nimport React from 'react';\nimport { QueryParamProvider } from 'use-query-params';\nimport { AuthWall } from '../auth/index.js';\nimport { BottomBar } from '../bottom-bar/index.js';\nimport { CurrentUserProvider } from '../current-user/index.js';\nimport { DataWorkspace } from '../data-workspace/index.js';\nimport { TopBar } from '../top-bar/index.js';\nimport { Layout } from './layout.js';\n\nconst App = () => /*#__PURE__*/React.createElement(QueryParamProvider, null, /*#__PURE__*/React.createElement(CssVariables, {\n  spacers: true,\n  colors: true,\n  theme: true\n}), /*#__PURE__*/React.createElement(CurrentUserProvider, null, /*#__PURE__*/React.createElement(AuthWall, null, /*#__PURE__*/React.createElement(Layout.Container, null, /*#__PURE__*/React.createElement(Layout.Top, null, /*#__PURE__*/React.createElement(TopBar, null)), /*#__PURE__*/React.createElement(Layout.Content, null, /*#__PURE__*/React.createElement(DataWorkspace, null)), /*#__PURE__*/React.createElement(Layout.Bottom, null, /*#__PURE__*/React.createElement(BottomBar, null))))));\n\nexport { App };"],"sourceRoot":""}