(this["webpackJsonp@dhis2/app-shell"]=this["webpackJsonp@dhis2/app-shell"]||[]).push([[135],{516:function(e,t,a){e.exports={wrapper:"auth-wall_wrapper__2MmQe"}},517:function(e,t,a){e.exports={button:"clear-all-button_button__mDEHm"}},518:function(e,t,a){e.exports={button:"context-select_button__1y8va",prefix:"context-select_prefix__3xDFu",value:"context-select_value__oltZj"}},519:function(e,t,a){e.exports={bordered:"workflow-select-option_bordered__JBAIX",option:"workflow-select-option_option__1cqTS",title:"workflow-select-option_title__3zrtv",subtitle:"workflow-select-option_subtitle__3yrup"}},520:function(e,t,a){e.exports={message:"workflow-select_message__1jq5N"}},521:function(e,t,a){e.exports={container:"layout_container__Cp-96",top:"layout_top__2gcI9",content:"layout_content__10QOH",bottom:"layout_bottom__2toTd"}},522:function(e,t,a){"use strict";a.r(t);var o=a(6),l=a(0),n=a.n(l),r=a(511),c=a(4),s=a(516),i=a.n(s);const p=Object(l.createContext)({});var d=a(7);const u={me:{resource:"me",params:{fields:["id","authorities","programs","dataSets","userGroups","organisationUnits","dataViewOrganisationUnits"]}}},m={dataApprovalWorkflows:{resource:"users",id:({id:e})=>`${e}/dataApprovalWorkflows`}},E=({children:e})=>{const{data:t,loading:a,error:l,refetch:r,called:c}=Object(d.d)(m,{lazy:!0}),{data:s,loading:i,error:E}=Object(d.d)(u,{onComplete:({me:{id:e}})=>r({id:e})}),w=!c||a||i,f=!w&&(l||E);if(w)return n.a.createElement(o.l,null,n.a.createElement(o.d,null,n.a.createElement(o.e,null)));if(f)throw f;return n.a.createElement(p.Provider,{value:{...s.me,...t.dataApprovalWorkflows}},e)},w=()=>Object(l.useContext)(p),f=({children:e})=>(()=>{const{authorities:e}=w();return e.some((e=>"ALL"===e||"M_dhis-web-approval"===e))})()?e:n.a.createElement("div",{className:i.a.wrapper},n.a.createElement(o.s,{error:!0,title:c.a.t("Not authorized")},c.a.t("You don't have access to the Data Approval App. Contact a system administrator to request access."))),_=()=>n.a.createElement("pre",null,"BottomBar placeholder"),b=()=>n.a.createElement("pre",null,"DataWorkspace placeholder"),v=()=>{},k=Object(l.createContext)({workflow:{},setWorkflow:v,period:{},setPeriod:v,orgUnit:{},setOrgUnit:v}),h=(e,t)=>t?e.find((e=>e.id===t))||{}:1===e.length?e[0]:{},O="SET_OPENED_SELECT",y="CLEAR_ALL",g="SELECT_WORKFLOW",C="SELECT_PERIOD",N="SELECT_ORG_UNIT",S=(e,{type:t,payload:a})=>{switch(t){case O:return{...e,openedSelect:a};case y:return{openedSelect:"",workflow:{},period:{},orgUnit:{}};case g:return{openedSelect:"",workflow:a,period:{},orgUnit:{}};case C:return{...e,openedSelect:"",period:a,orgUnit:{}};case N:return{...e,openedSelect:"",orgUnit:a};default:return e}},U=({children:e})=>{const[t,a]=Object(r.c)({wf:r.b,pe:r.b,ou:r.b}),{dataApprovalWorkflows:o}=w(),[{openedSelect:c,workflow:s,period:i,orgUnit:p},d]=Object(l.useReducer)(S,{openedSelect:"",workflow:h(o,t.wf),period:t.pe?(u=t.pe,{code:u,name:u}):{},orgUnit:t.ou?{id:t.ou}:{}});var u;const m={workflow:s,period:i,orgUnit:p,openedSelect:c,clearAll:()=>d({type:y,payload:h(o)}),setOpenedSelect:e=>d({type:O,payload:e}),selectWorkflow:e=>d({type:g,payload:e}),selectPeriod:e=>d({type:C,payload:e}),selectOrgUnit:e=>d({type:N,payload:e})};return Object(l.useEffect)((()=>{a({wf:s.id,pe:i.code,ou:p.id})}),[s,i,p]),n.a.createElement(k.Provider,{value:m},e)},x=()=>Object(l.useContext)(k);var A=a(517),j=a.n(A);const W=()=>{const{clearAll:e,period:t,orgUnit:a}=x();return t.code||a.id?n.a.createElement(o.c,{className:j.a.button,secondary:!0,onClick:e},c.a.t("Clear selections")):null};var L=a(518),T=a.n(L);const P=({children:e,label:t,value:a,onClose:r,onOpen:c,disabled:s,open:i})=>{const p=Object(l.useRef)(),d=i?o.j:o.i;return n.a.createElement(n.a.Fragment,null,n.a.createElement("button",{ref:p,className:T.a.button,onClick:c,disabled:s},n.a.createElement("span",{className:T.a.prefix},t),n.a.createElement("span",{className:T.a.value},a),n.a.createElement(d,{color:s?o.u.grey600:void 0})),i&&n.a.createElement(o.t,{reference:p,arrow:!1,placement:"bottom-start",onClickOutside:r},e))},R="ORG_UNIT",D=()=>{const{orgUnit:e,workflow:t,period:a,openedSelect:o,setOpenedSelect:l}=x(),r=o===R,s=e.name||c.a.t("Choose an organisation unit");return n.a.createElement(P,{label:c.a.t("Organisation Unit"),value:s,open:r,disabled:!(t.id&&a.code),onOpen:()=>l(R),onClose:()=>l("")},n.a.createElement("pre",null,"Org Unit picker placeholder"))},I="PERIOD",B=()=>{const{period:e,workflow:t,selectPeriod:a,openedSelect:o,setOpenedSelect:l}=x(),r=o===I,s=e.name||c.a.t("Choose a period");return n.a.createElement(P,{label:c.a.t("Period"),value:s,open:r,disabled:!t.id,onOpen:()=>l(I),onClose:()=>l("")},n.a.createElement("pre",null,"Period picker placeholder ",n.a.createElement("br",null),n.a.createElement("button",{onClick:()=>a({code:"20210404",name:"04-04-2020"})},"Set period to sth")))};var F=a(519),q=a.n(F);const z=({name:e,periodType:t,active:a,onClick:l})=>{const r=n.a.createElement("div",{className:q.a.option},n.a.createElement("span",{className:q.a.title},e),n.a.createElement("span",{className:q.a.subtitle},t||"UNAVAILABLE"));return n.a.createElement(o.n,{className:q.a.bordered,active:a,onClick:l,label:r})};var G=a(520),J=a.n(G);const H="WORKFLOW",K=()=>{const{dataApprovalWorkflows:e}=w(),{workflow:t,selectWorkflow:a,openedSelect:l,setOpenedSelect:r}=x(),s=l===H,i=t.name||c.a.t("Choose a workflow");return n.a.createElement(P,{label:c.a.t("Workflow"),value:i,open:s,onOpen:()=>r(H),onClose:()=>r("")},0===e.length?n.a.createElement("div",{className:J.a.message},c.a.t("No workflows found. None may exist or you may not have access to any.")):n.a.createElement(o.m,null,e.map((e=>n.a.createElement(z,{key:e.id,name:e.name,periodType:e.periodType,active:e.id===t.id,onClick:()=>a(e)})))))},M=()=>n.a.createElement(U,null,n.a.createElement(K,null),n.a.createElement(B,null),n.a.createElement(D,null),n.a.createElement(W,null));var Q=a(521),V=a.n(Q);function X(){return(X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e}).apply(this,arguments)}const Y=({children:e,className:t})=>n.a.createElement("div",{className:t},e),Z=e=>n.a.createElement(Y,X({},e,{className:V.a.container})),$=e=>n.a.createElement(Y,X({},e,{className:V.a.top})),ee=e=>n.a.createElement(Y,X({},e,{className:V.a.content})),te=e=>n.a.createElement(Y,X({},e,{className:V.a.bottom}));t.default=()=>n.a.createElement(r.a,null,n.a.createElement(o.g,{spacers:!0,colors:!0,theme:!0}),n.a.createElement(E,null,n.a.createElement(f,null,n.a.createElement(Z,null,n.a.createElement($,null,n.a.createElement(M,null)),n.a.createElement(ee,null,n.a.createElement(b,null)),n.a.createElement(te,null,n.a.createElement(_,null))))))}}]);
//# sourceMappingURL=app.f5820e09.chunk.js.map