(this["webpackJsonp@dhis2/app-shell"]=this["webpackJsonp@dhis2/app-shell"]||[]).push([[135],{515:function(e,t,a){e.exports={wrapper:"auth-wall_wrapper__2MmQe"}},516:function(e,t,a){e.exports={button:"clear-all-button_button__mDEHm"}},517:function(e,t,a){e.exports={button:"context-select_button__1y8va",prefix:"context-select_prefix__3xDFu",value:"context-select_value__oltZj",tooltipwrap:"context-select_tooltipwrap__3Fqbe"}},518:function(e,t,a){e.exports={bordered:"workflow-select-option_bordered__JBAIX",option:"workflow-select-option_option__1cqTS",title:"workflow-select-option_title__3zrtv",subtitle:"workflow-select-option_subtitle__3yrup"}},519:function(e,t,a){e.exports={message:"workflow-select_message__1jq5N"}},520:function(e,t,a){e.exports={container:"layout_container__Cp-96",top:"layout_top__2gcI9",content:"layout_content__10QOH",bottom:"layout_bottom__2toTd"}},521:function(e,t,a){"use strict";a.r(t);var o=a(6),r=a(0),l=a.n(r),n=a(510),c=a(4),s=a(515),i=a.n(s);const p=Object(r.createContext)({});var d=a(7);const u={me:{resource:"me",params:{fields:["id","authorities","programs","dataSets","userGroups","organisationUnits","dataViewOrganisationUnits"]}},dataApprovalWorkflows:{resource:"dataApprovalWorkflows",params:{paging:!1,fields:["id","displayName","dataApprovalLevels","periodType"]}}},m=({children:e})=>{const{data:t,loading:a,error:r}=Object(d.d)(u);if(a)return l.a.createElement(o.l,null,l.a.createElement(o.d,null,l.a.createElement(o.e,null)));if(r)throw r;const n={...t.me,...t.dataApprovalWorkflows};return l.a.createElement(p.Provider,{value:n},e)},E=()=>Object(r.useContext)(p),f=({children:e})=>(()=>{const{authorities:e}=E();return e.some((e=>"ALL"===e||"M_dhis-web-approval"===e))})()?e:l.a.createElement("div",{className:i.a.wrapper},l.a.createElement(o.s,{error:!0,title:c.a.t("Not authorized")},c.a.t("You don't have access to the Data Approval App. Contact a system administrator to request access."))),w=()=>l.a.createElement("pre",null,"BottomBar placeholder"),_=()=>l.a.createElement("pre",null,"DataWorkspace placeholder"),v=()=>{throw new Error("Selection Context has not been initialized")},b=Object(r.createContext)({workflow:{},setWorkflow:v,period:{},setPeriod:v,orgUnit:{},setOrgUnit:v}),h=(e,t)=>t?e.find((e=>e.id===t))||{}:1===e.length?e[0]:{},y="SET_OPENED_SELECT",O="CLEAR_ALL",k="SELECT_WORKFLOW",g="SELECT_PERIOD",N="SELECT_ORG_UNIT",C=(e,{type:t,payload:a})=>{switch(t){case y:return{...e,openedSelect:a};case O:case k:return{openedSelect:"",workflow:a,period:{},orgUnit:{}};case g:return{...e,openedSelect:"",period:a,orgUnit:{}};case N:return{...e,openedSelect:"",orgUnit:a};default:return e}},x=({children:e})=>{const[t,a]=Object(n.c)({wf:n.b,pe:n.b,ou:n.b}),{dataApprovalWorkflows:o}=E(),[{openedSelect:c,workflow:s,period:i,orgUnit:p},d]=Object(r.useReducer)(C,{openedSelect:"",workflow:h(o,t.wf),period:t.pe?(u=t.pe,{code:u,displayName:u}):{},orgUnit:t.ou?{id:t.ou}:{}});var u;const m={workflow:s,period:i,orgUnit:p,openedSelect:c,clearAll:()=>d({type:O,payload:h(o)}),setOpenedSelect:e=>d({type:y,payload:e}),selectWorkflow:e=>d({type:k,payload:e}),selectPeriod:e=>d({type:g,payload:e}),selectOrgUnit:e=>d({type:N,payload:e})};return Object(r.useEffect)((()=>{a({wf:s.id,pe:i.code,ou:p.id})}),[s,i,p]),l.a.createElement(b.Provider,{value:m},e)},S=()=>Object(r.useContext)(b);var U=a(516),A=a.n(U);const j=()=>{const{clearAll:e,period:t,orgUnit:a}=S();return t.code||a.id?l.a.createElement(o.c,{className:A.a.button,secondary:!0,onClick:e},c.a.t("Clear selections")):null};var L=a(517),W=a.n(L);const T=({children:e,prefix:t,value:a,onClose:n,onOpen:c,disabled:s,open:i,requiredValuesMessage:p})=>{const d=Object(r.useRef)(),u=i?o.j:o.i,m=l.a.createElement("button",{ref:d,className:W.a.button,onClick:c,disabled:s},l.a.createElement("span",{className:W.a.prefix},t),!s&&l.a.createElement("span",{className:W.a.value},a),l.a.createElement(u,{color:s?o.v.grey600:void 0}));return l.a.createElement(l.a.Fragment,null,s?l.a.createElement(o.u,{content:p,placement:"bottom"},(({ref:e,onMouseOver:t,onMouseOut:a})=>l.a.createElement("div",{ref:e,onMouseOver:t,onMouseOut:a,className:W.a.tooltipwrap},m))):m,i&&l.a.createElement(o.t,{reference:d,arrow:!1,placement:"bottom-start",onClickOutside:n},e))},P="ORG_UNIT",M=()=>{const{orgUnit:e,workflow:t,period:a,openedSelect:o,setOpenedSelect:r}=S(),n=o===P,s=e.displayName||c.a.t("Choose an organisation unit"),i=t.id?c.a.t("Choose a period first"):c.a.t("Choose a workflow and period first");return l.a.createElement(T,{prefix:c.a.t("Organisation Unit"),value:s,open:n,disabled:!(t.id&&a.code),onOpen:()=>r(P),onClose:()=>r(""),requiredValuesMessage:i},l.a.createElement("pre",null,"Org Unit picker placeholder"))},R="PERIOD",q=()=>{const{period:e,workflow:t,selectPeriod:a,openedSelect:o,setOpenedSelect:r}=S(),n=o===R,s=e.displayName||c.a.t("Choose a period");return l.a.createElement(T,{prefix:c.a.t("Period"),value:s,open:n,disabled:!t.id,onOpen:()=>r(R),onClose:()=>r(""),requiredValuesMessage:c.a.t("Choose a workflow first")},l.a.createElement("pre",null,"Period picker placeholder ",l.a.createElement("br",null),l.a.createElement("button",{onClick:()=>a({code:"20210404",displayName:"04-04-2020"})},"Set period to sth")))};var D=a(518),I=a.n(D);const F=({name:e,periodType:t,active:a,onClick:r})=>{const n=l.a.createElement("div",{className:I.a.option},l.a.createElement("span",{className:I.a.title},e),l.a.createElement("span",{className:I.a.subtitle},t||"UNAVAILABLE"));return l.a.createElement(o.n,{className:I.a.bordered,active:a,onClick:r,label:n})};var V=a(519),B=a.n(V);const z="WORKFLOW",G=()=>{const{dataApprovalWorkflows:e}=E(),{workflow:t,selectWorkflow:a,openedSelect:r,setOpenedSelect:n}=S(),s=r===z,i=t.displayName||c.a.t("Choose a workflow");return l.a.createElement(T,{prefix:c.a.t("Workflow"),value:i,open:s,onOpen:()=>n(z),onClose:()=>n("")},0===e.length?l.a.createElement("div",{className:B.a.message},c.a.t("No workflows found. None may exist, or you may not have access to any.")):l.a.createElement(o.m,null,e.map((e=>l.a.createElement(F,{key:e.id,name:e.displayName,periodType:e.periodType,active:e.id===t.id,onClick:()=>a(e)})))))},J=()=>l.a.createElement(x,null,l.a.createElement(G,null),l.a.createElement(q,null),l.a.createElement(M,null),l.a.createElement(j,null));var H=a(520),K=a.n(H);function Q(){return(Q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e}).apply(this,arguments)}const X=({children:e,className:t})=>l.a.createElement("div",{className:t},e),Y=e=>l.a.createElement(X,Q({},e,{className:K.a.container})),Z=e=>l.a.createElement(X,Q({},e,{className:K.a.top})),$=e=>l.a.createElement(X,Q({},e,{className:K.a.content})),ee=e=>l.a.createElement(X,Q({},e,{className:K.a.bottom}));t.default=()=>l.a.createElement(n.a,null,l.a.createElement(o.g,{spacers:!0,colors:!0,theme:!0}),l.a.createElement(m,null,l.a.createElement(f,null,l.a.createElement(Y,null,l.a.createElement(Z,null,l.a.createElement(J,null)),l.a.createElement($,null,l.a.createElement(_,null)),l.a.createElement(ee,null,l.a.createElement(w,null))))))}}]);
//# sourceMappingURL=app.571ac47c.chunk.js.map